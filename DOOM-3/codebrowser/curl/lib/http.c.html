<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>http.c source code [codebrowser/curl/lib/http.c] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="send_buffer "/>
<link rel="stylesheet" href="../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'codebrowser/curl/lib/http.c'; var root_path = '../../..'; var data_path = '../../../../data';</script>
<script src='../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../..'>codebrowser</a>/<a href='..'>curl</a>/<a href='./'>lib</a>/<a href='http.c.html'>http.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/***************************************************************************</i></td></tr>
<tr><th id="2">2</th><td><i> *                                  _   _ ____  _     </i></td></tr>
<tr><th id="3">3</th><td><i> *  Project                     ___| | | |  _ \| |    </i></td></tr>
<tr><th id="4">4</th><td><i> *                             / __| | | | |_) | |    </i></td></tr>
<tr><th id="5">5</th><td><i> *                            | (__| |_| |  _ &lt;| |___ </i></td></tr>
<tr><th id="6">6</th><td><i> *                             \___|\___/|_| \_\_____|</i></td></tr>
<tr><th id="7">7</th><td><i> *</i></td></tr>
<tr><th id="8">8</th><td><i> * Copyright (C) 1998 - 2004, Daniel Stenberg, &lt;daniel@haxx.se&gt;, et al.</i></td></tr>
<tr><th id="9">9</th><td><i> *</i></td></tr>
<tr><th id="10">10</th><td><i> * This software is licensed as described in the file COPYING, which</i></td></tr>
<tr><th id="11">11</th><td><i> * you should have received as part of this distribution. The terms</i></td></tr>
<tr><th id="12">12</th><td><i> * are also available at <a href="http://curl.haxx.se/docs/copyright.html">http://curl.haxx.se/docs/copyright.html</a>.</i></td></tr>
<tr><th id="13">13</th><td><i> * </i></td></tr>
<tr><th id="14">14</th><td><i> * You may opt to use, copy, modify, merge, publish, distribute and/or sell</i></td></tr>
<tr><th id="15">15</th><td><i> * copies of the Software, and permit persons to whom the Software is</i></td></tr>
<tr><th id="16">16</th><td><i> * furnished to do so, under the terms of the COPYING file.</i></td></tr>
<tr><th id="17">17</th><td><i> *</i></td></tr>
<tr><th id="18">18</th><td><i> * This software is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY</i></td></tr>
<tr><th id="19">19</th><td><i> * KIND, either express or implied.</i></td></tr>
<tr><th id="20">20</th><td><i> *</i></td></tr>
<tr><th id="21">21</th><td><i> * $Id: http.c,v 1.204 2004/03/14 18:15:04 bagder Exp $</i></td></tr>
<tr><th id="22">22</th><td><i> ***************************************************************************/</i></td></tr>
<tr><th id="23">23</th><td></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="setup.h.html">"setup.h"</a></u></td></tr>
<tr><th id="25">25</th><td></td></tr>
<tr><th id="26">26</th><td><u>#<span data-ppcond="26">ifndef</span> <span class="macro" data-ref="_M/CURL_DISABLE_HTTP">CURL_DISABLE_HTTP</span></u></td></tr>
<tr><th id="27">27</th><td><i>/* -- WIN32 approved -- */</i></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../../../include/stdio.h.html">&lt;stdio.h&gt;</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../../../include/string.h.html">&lt;string.h&gt;</a></u></td></tr>
<tr><th id="30">30</th><td><u>#include &lt;stdarg.h&gt;</u></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="../../../include/stdlib.h.html">&lt;stdlib.h&gt;</a></u></td></tr>
<tr><th id="32">32</th><td><u>#include <a href="../../../include/ctype.h.html">&lt;ctype.h&gt;</a></u></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="../../../include/x86_64-linux-gnu/sys/types.h.html">&lt;sys/types.h&gt;</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../../../include/x86_64-linux-gnu/sys/stat.h.html">&lt;sys/stat.h&gt;</a></u></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="../../../include/errno.h.html">&lt;errno.h&gt;</a></u></td></tr>
<tr><th id="37">37</th><td></td></tr>
<tr><th id="38">38</th><td><u>#<span data-ppcond="38">if</span> defined(<span class="macro" data-ref="_M/WIN32">WIN32</span>) &amp;&amp; !defined(<span class="macro" data-ref="_M/__GNUC__">__GNUC__</span>) || defined(<span class="macro" data-ref="_M/__MINGW32__">__MINGW32__</span>)</u></td></tr>
<tr><th id="39">39</th><td><u>#include &lt;time.h&gt;</u></td></tr>
<tr><th id="40">40</th><td><u>#include &lt;io.h&gt;</u></td></tr>
<tr><th id="41">41</th><td><u>#<span data-ppcond="38">else</span></u></td></tr>
<tr><th id="42">42</th><td><u>#<span data-ppcond="42">ifdef</span> <a class="macro" href="config.h.html#347" data-ref="_M/HAVE_SYS_SOCKET_H">HAVE_SYS_SOCKET_H</a></u></td></tr>
<tr><th id="43">43</th><td><u>#include <a href="../../../include/x86_64-linux-gnu/sys/socket.h.html">&lt;sys/socket.h&gt;</a></u></td></tr>
<tr><th id="44">44</th><td><u>#<span data-ppcond="42">endif</span></u></td></tr>
<tr><th id="45">45</th><td><u>#<span data-ppcond="45">ifdef</span> <a class="macro" href="config.h.html#206" data-ref="_M/HAVE_NETINET_IN_H">HAVE_NETINET_IN_H</a></u></td></tr>
<tr><th id="46">46</th><td><u>#include <a href="../../../include/netinet/in.h.html">&lt;netinet/in.h&gt;</a></u></td></tr>
<tr><th id="47">47</th><td><u>#<span data-ppcond="45">endif</span></u></td></tr>
<tr><th id="48">48</th><td><u>#include <a href="../../../include/x86_64-linux-gnu/sys/time.h.html">&lt;sys/time.h&gt;</a></u></td></tr>
<tr><th id="49">49</th><td></td></tr>
<tr><th id="50">50</th><td><u>#<span data-ppcond="50">ifdef</span> <a class="macro" href="config.h.html#377" data-ref="_M/HAVE_TIME_H">HAVE_TIME_H</a></u></td></tr>
<tr><th id="51">51</th><td><u>#<span data-ppcond="51">ifdef</span> <a class="macro" href="config.h.html#449" data-ref="_M/TIME_WITH_SYS_TIME">TIME_WITH_SYS_TIME</a></u></td></tr>
<tr><th id="52">52</th><td><u>#include <a href="../../../include/time.h.html">&lt;time.h&gt;</a></u></td></tr>
<tr><th id="53">53</th><td><u>#<span data-ppcond="51">endif</span></u></td></tr>
<tr><th id="54">54</th><td><u>#<span data-ppcond="50">endif</span></u></td></tr>
<tr><th id="55">55</th><td></td></tr>
<tr><th id="56">56</th><td><u>#<span data-ppcond="56">ifdef</span> <a class="macro" href="config.h.html#383" data-ref="_M/HAVE_UNISTD_H">HAVE_UNISTD_H</a></u></td></tr>
<tr><th id="57">57</th><td><u>#include <a href="../../../include/unistd.h.html">&lt;unistd.h&gt;</a></u></td></tr>
<tr><th id="58">58</th><td><u>#<span data-ppcond="56">endif</span></u></td></tr>
<tr><th id="59">59</th><td><u>#include <a href="../../../include/netdb.h.html">&lt;netdb.h&gt;</a></u></td></tr>
<tr><th id="60">60</th><td><u>#<span data-ppcond="60">ifdef</span> <a class="macro" href="config.h.html#38" data-ref="_M/HAVE_ARPA_INET_H">HAVE_ARPA_INET_H</a></u></td></tr>
<tr><th id="61">61</th><td><u>#include <a href="../../../include/arpa/inet.h.html">&lt;arpa/inet.h&gt;</a></u></td></tr>
<tr><th id="62">62</th><td><u>#<span data-ppcond="60">endif</span></u></td></tr>
<tr><th id="63">63</th><td><u>#<span data-ppcond="63">ifdef</span> <a class="macro" href="config.h.html#209" data-ref="_M/HAVE_NET_IF_H">HAVE_NET_IF_H</a></u></td></tr>
<tr><th id="64">64</th><td><u>#include <a href="../../../include/net/if.h.html">&lt;net/if.h&gt;</a></u></td></tr>
<tr><th id="65">65</th><td><u>#<span data-ppcond="63">endif</span></u></td></tr>
<tr><th id="66">66</th><td><u>#include <a href="../../../include/x86_64-linux-gnu/sys/ioctl.h.html">&lt;sys/ioctl.h&gt;</a></u></td></tr>
<tr><th id="67">67</th><td><u>#include <a href="../../../include/signal.h.html">&lt;signal.h&gt;</a></u></td></tr>
<tr><th id="68">68</th><td></td></tr>
<tr><th id="69">69</th><td><u>#<span data-ppcond="69">ifdef</span> <a class="macro" href="config.h.html#338" data-ref="_M/HAVE_SYS_PARAM_H">HAVE_SYS_PARAM_H</a></u></td></tr>
<tr><th id="70">70</th><td><u>#include <a href="../../../include/x86_64-linux-gnu/sys/param.h.html">&lt;sys/param.h&gt;</a></u></td></tr>
<tr><th id="71">71</th><td><u>#<span data-ppcond="69">endif</span></u></td></tr>
<tr><th id="72">72</th><td></td></tr>
<tr><th id="73">73</th><td><u>#<span data-ppcond="73">ifdef</span> <a class="macro" href="config.h.html#344" data-ref="_M/HAVE_SYS_SELECT_H">HAVE_SYS_SELECT_H</a></u></td></tr>
<tr><th id="74">74</th><td><u>#include <a href="../../../include/x86_64-linux-gnu/sys/select.h.html">&lt;sys/select.h&gt;</a></u></td></tr>
<tr><th id="75">75</th><td><u>#<span data-ppcond="73">endif</span></u></td></tr>
<tr><th id="76">76</th><td></td></tr>
<tr><th id="77">77</th><td></td></tr>
<tr><th id="78">78</th><td><u>#<span data-ppcond="38">endif</span></u></td></tr>
<tr><th id="79">79</th><td></td></tr>
<tr><th id="80">80</th><td><u>#include <a href="urldata.h.html">"urldata.h"</a></u></td></tr>
<tr><th id="81">81</th><td><u>#include <a href="../include/curl/curl.h.html">&lt;curl/curl.h&gt;</a></u></td></tr>
<tr><th id="82">82</th><td><u>#include <a href="transfer.h.html">"transfer.h"</a></u></td></tr>
<tr><th id="83">83</th><td><u>#include <a href="sendf.h.html">"sendf.h"</a></u></td></tr>
<tr><th id="84">84</th><td><u>#include <a href="formdata.h.html">"formdata.h"</a></u></td></tr>
<tr><th id="85">85</th><td><u>#include <a href="progress.h.html">"progress.h"</a></u></td></tr>
<tr><th id="86">86</th><td><u>#include <a href="base64.h.html">"base64.h"</a></u></td></tr>
<tr><th id="87">87</th><td><u>#include <a href="cookie.h.html">"cookie.h"</a></u></td></tr>
<tr><th id="88">88</th><td><u>#include <a href="strequal.h.html">"strequal.h"</a></u></td></tr>
<tr><th id="89">89</th><td><u>#include <a href="ssluse.h.html">"ssluse.h"</a></u></td></tr>
<tr><th id="90">90</th><td><u>#include <a href="http_digest.h.html">"http_digest.h"</a></u></td></tr>
<tr><th id="91">91</th><td><u>#include <a href="http_ntlm.h.html">"http_ntlm.h"</a></u></td></tr>
<tr><th id="92">92</th><td><u>#include <a href="http_negotiate.h.html">"http_negotiate.h"</a></u></td></tr>
<tr><th id="93">93</th><td><u>#include <a href="url.h.html">"url.h"</a></u></td></tr>
<tr><th id="94">94</th><td><u>#include <a href="share.h.html">"share.h"</a></u></td></tr>
<tr><th id="95">95</th><td><u>#include <a href="http.h.html">"http.h"</a></u></td></tr>
<tr><th id="96">96</th><td></td></tr>
<tr><th id="97">97</th><td><u>#define <dfn class="macro" id="_M/_MPRINTF_REPLACE" data-ref="_M/_MPRINTF_REPLACE">_MPRINTF_REPLACE</dfn> /* use our functions only */</u></td></tr>
<tr><th id="98">98</th><td><u>#include <a href="../include/curl/mprintf.h.html">&lt;curl/mprintf.h&gt;</a></u></td></tr>
<tr><th id="99">99</th><td></td></tr>
<tr><th id="100">100</th><td><i>/* The last #include file should be: */</i></td></tr>
<tr><th id="101">101</th><td><u>#<span data-ppcond="101">ifdef</span> <span class="macro" data-ref="_M/CURLDEBUG">CURLDEBUG</span></u></td></tr>
<tr><th id="102">102</th><td><u>#include <a href="memdebug.h.html">"memdebug.h"</a></u></td></tr>
<tr><th id="103">103</th><td><u>#<span data-ppcond="101">endif</span></u></td></tr>
<tr><th id="104">104</th><td></td></tr>
<tr><th id="105">105</th><td><em>static</em> <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <a class="tu decl" href="#Curl_output_basic_proxy" title='Curl_output_basic_proxy' data-type='CURLcode Curl_output_basic_proxy(struct connectdata * conn)' data-ref="Curl_output_basic_proxy">Curl_output_basic_proxy</a>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col4 decl" id="14conn" title='conn' data-type='struct connectdata *' data-ref="14conn">conn</dfn>);</td></tr>
<tr><th id="106">106</th><td></td></tr>
<tr><th id="107">107</th><td><i  data-doc="checkheaders">/*</i></td></tr>
<tr><th id="108">108</th><td><i  data-doc="checkheaders"> * This function checks the linked list of custom HTTP headers for a particular</i></td></tr>
<tr><th id="109">109</th><td><i  data-doc="checkheaders"> * header (prefix).</i></td></tr>
<tr><th id="110">110</th><td><i  data-doc="checkheaders"> */</i></td></tr>
<tr><th id="111">111</th><td><em>static</em> <em>char</em> *<dfn class="tu decl def" id="checkheaders" title='checkheaders' data-type='char * checkheaders(struct SessionHandle * data, const char * thisheader)' data-ref="checkheaders">checkheaders</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col5 decl" id="15data" title='data' data-type='struct SessionHandle *' data-ref="15data">data</dfn>, <em>const</em> <em>char</em> *<dfn class="local col6 decl" id="16thisheader" title='thisheader' data-type='const char *' data-ref="16thisheader">thisheader</dfn>)</td></tr>
<tr><th id="112">112</th><td>{</td></tr>
<tr><th id="113">113</th><td>  <b>struct</b> <a class="type" href="../include/curl/curl.h.html#curl_slist" title='curl_slist' data-ref="curl_slist">curl_slist</a> *<dfn class="local col7 decl" id="17head" title='head' data-type='struct curl_slist *' data-ref="17head">head</dfn>;</td></tr>
<tr><th id="114">114</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col8 decl" id="18thislen" title='thislen' data-type='size_t' data-ref="18thislen">thislen</dfn> = <a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col6 ref" href="#16thisheader" title='thisheader' data-ref="16thisheader">thisheader</a>);</td></tr>
<tr><th id="115">115</th><td></td></tr>
<tr><th id="116">116</th><td>  <b>for</b>(<a class="local col7 ref" href="#17head" title='head' data-ref="17head">head</a> = <a class="local col5 ref" href="#15data" title='data' data-ref="15data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::headers" title='UserDefined::headers' data-ref="UserDefined::headers">headers</a>; <a class="local col7 ref" href="#17head" title='head' data-ref="17head">head</a>; <a class="local col7 ref" href="#17head" title='head' data-ref="17head">head</a>=<a class="local col7 ref" href="#17head" title='head' data-ref="17head">head</a>-&gt;<a class="ref" href="../include/curl/curl.h.html#curl_slist::next" title='curl_slist::next' data-ref="curl_slist::next">next</a>) {</td></tr>
<tr><th id="117">117</th><td>    <b>if</b>(<a class="macro" href="strequal.h.html#33" title="curl_strnequal(head-&gt;data,thisheader,thislen)" data-ref="_M/strnequal">strnequal</a>(<a class="local col7 ref" href="#17head" title='head' data-ref="17head">head</a>-&gt;<a class="ref" href="../include/curl/curl.h.html#curl_slist::data" title='curl_slist::data' data-ref="curl_slist::data">data</a>, <a class="local col6 ref" href="#16thisheader" title='thisheader' data-ref="16thisheader">thisheader</a>, <a class="local col8 ref" href="#18thislen" title='thislen' data-ref="18thislen">thislen</a>))</td></tr>
<tr><th id="118">118</th><td>      <b>return</b> <a class="local col7 ref" href="#17head" title='head' data-ref="17head">head</a>-&gt;<a class="ref" href="../include/curl/curl.h.html#curl_slist::data" title='curl_slist::data' data-ref="curl_slist::data">data</a>;</td></tr>
<tr><th id="119">119</th><td>  }</td></tr>
<tr><th id="120">120</th><td>  <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="121">121</th><td>}</td></tr>
<tr><th id="122">122</th><td></td></tr>
<tr><th id="123">123</th><td><em>static</em> <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="tu decl def" id="Curl_output_basic" title='Curl_output_basic' data-type='CURLcode Curl_output_basic(struct connectdata * conn)' data-ref="Curl_output_basic">Curl_output_basic</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col9 decl" id="19conn" title='conn' data-type='struct connectdata *' data-ref="19conn">conn</dfn>)</td></tr>
<tr><th id="124">124</th><td>{</td></tr>
<tr><th id="125">125</th><td>  <em>char</em> *<dfn class="local col0 decl" id="20authorization" title='authorization' data-type='char *' data-ref="20authorization">authorization</dfn>;</td></tr>
<tr><th id="126">126</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col1 decl" id="21data" title='data' data-type='struct SessionHandle *' data-ref="21data">data</dfn>=<a class="local col9 ref" href="#19conn" title='conn' data-ref="19conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="127">127</th><td></td></tr>
<tr><th id="128">128</th><td>  <a class="macro" href="../include/curl/mprintf.h.html#44" title="curl_msprintf" data-ref="_M/sprintf">sprintf</a>(<a class="local col1 ref" href="#21data" title='data' data-ref="21data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>, <q>"%s:%s"</q>, <a class="local col9 ref" href="#19conn" title='conn' data-ref="19conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::user" title='connectdata::user' data-ref="connectdata::user">user</a>, <a class="local col9 ref" href="#19conn" title='conn' data-ref="19conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::passwd" title='connectdata::passwd' data-ref="connectdata::passwd">passwd</a>);</td></tr>
<tr><th id="129">129</th><td>  <b>if</b>(<a class="ref" href="base64.h.html#Curl_base64_encode" title='Curl_base64_encode' data-ref="Curl_base64_encode">Curl_base64_encode</a>(<a class="local col1 ref" href="#21data" title='data' data-ref="21data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>, <a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col1 ref" href="#21data" title='data' data-ref="21data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>),</td></tr>
<tr><th id="130">130</th><td>                        &amp;<a class="local col0 ref" href="#20authorization" title='authorization' data-ref="20authorization">authorization</a>) &gt; <var>0</var>) {</td></tr>
<tr><th id="131">131</th><td>    <b>if</b>(<a class="local col9 ref" href="#19conn" title='conn' data-ref="19conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::userpwd" title='dynamically_allocated_data::userpwd' data-ref="dynamically_allocated_data::userpwd">userpwd</a>)</td></tr>
<tr><th id="132">132</th><td>      <a class="macro" href="memdebug.h.html#78" title="curl_dofree(conn-&gt;allocptr.userpwd, 132, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col9 ref" href="#19conn" title='conn' data-ref="19conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::userpwd" title='dynamically_allocated_data::userpwd' data-ref="dynamically_allocated_data::userpwd">userpwd</a>);</td></tr>
<tr><th id="133">133</th><td>    <a class="local col9 ref" href="#19conn" title='conn' data-ref="19conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::userpwd" title='dynamically_allocated_data::userpwd' data-ref="dynamically_allocated_data::userpwd">userpwd</a> = <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>( <q>"Authorization: Basic %s\015\012"</q>,</td></tr>
<tr><th id="134">134</th><td>                                      <a class="local col0 ref" href="#20authorization" title='authorization' data-ref="20authorization">authorization</a>);</td></tr>
<tr><th id="135">135</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(authorization, 135, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col0 ref" href="#20authorization" title='authorization' data-ref="20authorization">authorization</a>);</td></tr>
<tr><th id="136">136</th><td>  }</td></tr>
<tr><th id="137">137</th><td>  <b>else</b></td></tr>
<tr><th id="138">138</th><td>    <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="139">139</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="140">140</th><td>}</td></tr>
<tr><th id="141">141</th><td></td></tr>
<tr><th id="142">142</th><td><em>static</em> <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="tu decl def" id="Curl_output_basic_proxy" title='Curl_output_basic_proxy' data-type='CURLcode Curl_output_basic_proxy(struct connectdata * conn)' data-ref="Curl_output_basic_proxy">Curl_output_basic_proxy</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col2 decl" id="22conn" title='conn' data-type='struct connectdata *' data-ref="22conn">conn</dfn>)</td></tr>
<tr><th id="143">143</th><td>{</td></tr>
<tr><th id="144">144</th><td>  <em>char</em> *<dfn class="local col3 decl" id="23authorization" title='authorization' data-type='char *' data-ref="23authorization">authorization</dfn>;</td></tr>
<tr><th id="145">145</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col4 decl" id="24data" title='data' data-type='struct SessionHandle *' data-ref="24data">data</dfn>=<a class="local col2 ref" href="#22conn" title='conn' data-ref="22conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="146">146</th><td></td></tr>
<tr><th id="147">147</th><td>  <a class="macro" href="../include/curl/mprintf.h.html#44" title="curl_msprintf" data-ref="_M/sprintf">sprintf</a>(<a class="local col4 ref" href="#24data" title='data' data-ref="24data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>, <q>"%s:%s"</q>,</td></tr>
<tr><th id="148">148</th><td>          <a class="local col2 ref" href="#22conn" title='conn' data-ref="22conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proxyuser" title='connectdata::proxyuser' data-ref="connectdata::proxyuser">proxyuser</a>, <a class="local col2 ref" href="#22conn" title='conn' data-ref="22conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proxypasswd" title='connectdata::proxypasswd' data-ref="connectdata::proxypasswd">proxypasswd</a>);</td></tr>
<tr><th id="149">149</th><td>  <b>if</b>(<a class="ref" href="base64.h.html#Curl_base64_encode" title='Curl_base64_encode' data-ref="Curl_base64_encode">Curl_base64_encode</a>(<a class="local col4 ref" href="#24data" title='data' data-ref="24data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>, <a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col4 ref" href="#24data" title='data' data-ref="24data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>),</td></tr>
<tr><th id="150">150</th><td>                        &amp;<a class="local col3 ref" href="#23authorization" title='authorization' data-ref="23authorization">authorization</a>) &gt; <var>0</var>) {</td></tr>
<tr><th id="151">151</th><td>    <a class="ref" href="url.h.html#Curl_safefree" title='Curl_safefree' data-ref="Curl_safefree">Curl_safefree</a>(<a class="local col2 ref" href="#22conn" title='conn' data-ref="22conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::proxyuserpwd" title='dynamically_allocated_data::proxyuserpwd' data-ref="dynamically_allocated_data::proxyuserpwd">proxyuserpwd</a>);</td></tr>
<tr><th id="152">152</th><td>    <a class="local col2 ref" href="#22conn" title='conn' data-ref="22conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::proxyuserpwd" title='dynamically_allocated_data::proxyuserpwd' data-ref="dynamically_allocated_data::proxyuserpwd">proxyuserpwd</a> =</td></tr>
<tr><th id="153">153</th><td>      <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Proxy-authorization: Basic %s\015\012"</q>, <a class="local col3 ref" href="#23authorization" title='authorization' data-ref="23authorization">authorization</a>);</td></tr>
<tr><th id="154">154</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(authorization, 154, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col3 ref" href="#23authorization" title='authorization' data-ref="23authorization">authorization</a>);</td></tr>
<tr><th id="155">155</th><td>  }</td></tr>
<tr><th id="156">156</th><td>  <b>else</b></td></tr>
<tr><th id="157">157</th><td>    <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="158">158</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="159">159</th><td>}</td></tr>
<tr><th id="160">160</th><td></td></tr>
<tr><th id="161">161</th><td><i>/*</i></td></tr>
<tr><th id="162">162</th><td><i> * Curl_http_auth_act() checks what authentication methods that are available</i></td></tr>
<tr><th id="163">163</th><td><i> * and decides which one (if any) to use. It will set 'newurl' if an auth</i></td></tr>
<tr><th id="164">164</th><td><i> * metod was picked.</i></td></tr>
<tr><th id="165">165</th><td><i> */</i></td></tr>
<tr><th id="166">166</th><td></td></tr>
<tr><th id="167">167</th><td><em>void</em> <dfn class="decl def" id="Curl_http_auth_act" title='Curl_http_auth_act' data-ref="Curl_http_auth_act">Curl_http_auth_act</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col5 decl" id="25conn" title='conn' data-type='struct connectdata *' data-ref="25conn">conn</dfn>)</td></tr>
<tr><th id="168">168</th><td>{</td></tr>
<tr><th id="169">169</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col6 decl" id="26data" title='data' data-type='struct SessionHandle *' data-ref="26data">data</dfn> = <a class="local col5 ref" href="#25conn" title='conn' data-ref="25conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="170">170</th><td></td></tr>
<tr><th id="171">171</th><td>  <b>if</b>(<a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a>) {</td></tr>
<tr><th id="172">172</th><td>    <i>/* The order of these checks is highly relevant, as this will be the order</i></td></tr>
<tr><th id="173">173</th><td><i>       of preference in case of the existance of multiple accepted types. */</i></td></tr>
<tr><th id="174">174</th><td>    <b>if</b>(<a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> &amp; <a class="macro" href="../include/curl/curl.h.html#298" title="(1&lt;&lt;2)" data-ref="_M/CURLAUTH_GSSNEGOTIATE">CURLAUTH_GSSNEGOTIATE</a>)</td></tr>
<tr><th id="175">175</th><td>      <a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> = <a class="macro" href="../include/curl/curl.h.html#298" title="(1&lt;&lt;2)" data-ref="_M/CURLAUTH_GSSNEGOTIATE">CURLAUTH_GSSNEGOTIATE</a>;</td></tr>
<tr><th id="176">176</th><td>    <b>else</b> <b>if</b>(<a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> &amp; <a class="macro" href="../include/curl/curl.h.html#297" title="(1&lt;&lt;1)" data-ref="_M/CURLAUTH_DIGEST">CURLAUTH_DIGEST</a>)</td></tr>
<tr><th id="177">177</th><td>      <a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> = <a class="macro" href="../include/curl/curl.h.html#297" title="(1&lt;&lt;1)" data-ref="_M/CURLAUTH_DIGEST">CURLAUTH_DIGEST</a>;</td></tr>
<tr><th id="178">178</th><td>    <b>else</b> <b>if</b>(<a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> &amp; <a class="macro" href="../include/curl/curl.h.html#299" title="(1&lt;&lt;3)" data-ref="_M/CURLAUTH_NTLM">CURLAUTH_NTLM</a>)</td></tr>
<tr><th id="179">179</th><td>      <a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> = <a class="macro" href="../include/curl/curl.h.html#299" title="(1&lt;&lt;3)" data-ref="_M/CURLAUTH_NTLM">CURLAUTH_NTLM</a>;</td></tr>
<tr><th id="180">180</th><td>    <b>else</b> <b>if</b>(<a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> &amp; <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>)</td></tr>
<tr><th id="181">181</th><td>      <a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> = <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>;</td></tr>
<tr><th id="182">182</th><td>    <b>else</b></td></tr>
<tr><th id="183">183</th><td>      <a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> = <a class="macro" href="../include/curl/curl.h.html#295" title="0" data-ref="_M/CURLAUTH_NONE">CURLAUTH_NONE</a>; <i>/* clear it */</i></td></tr>
<tr><th id="184">184</th><td></td></tr>
<tr><th id="185">185</th><td>    <b>if</b>(<a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a>)</td></tr>
<tr><th id="186">186</th><td>      <a class="local col5 ref" href="#25conn" title='conn' data-ref="25conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::newurl" title='connectdata::newurl' data-ref="connectdata::newurl">newurl</a> = <a class="macro" href="memdebug.h.html#74" title="curl_dostrdup(data-&gt;change.url, 186, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/strdup">strdup</a>(<a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::change" title='SessionHandle::change' data-ref="SessionHandle::change">change</a>.<a class="ref" href="urldata.h.html#DynamicStatic::url" title='DynamicStatic::url' data-ref="DynamicStatic::url">url</a>); <i>/* clone URL */</i></td></tr>
<tr><th id="187">187</th><td>    <a class="local col6 ref" href="#26data" title='data' data-ref="26data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> = <a class="macro" href="../include/curl/curl.h.html#295" title="0" data-ref="_M/CURLAUTH_NONE">CURLAUTH_NONE</a>; <i>/* clear it here */</i></td></tr>
<tr><th id="188">188</th><td>  }</td></tr>
<tr><th id="189">189</th><td>}</td></tr>
<tr><th id="190">190</th><td></td></tr>
<tr><th id="191">191</th><td><i  data-doc="http_auth_headers">/*</i></td></tr>
<tr><th id="192">192</th><td><i  data-doc="http_auth_headers"> * Setup the authentication headers for the host/proxy and the correct</i></td></tr>
<tr><th id="193">193</th><td><i  data-doc="http_auth_headers"> * authentication method.</i></td></tr>
<tr><th id="194">194</th><td><i  data-doc="http_auth_headers"> */</i></td></tr>
<tr><th id="195">195</th><td></td></tr>
<tr><th id="196">196</th><td><em>static</em> <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="tu decl def" id="http_auth_headers" title='http_auth_headers' data-type='CURLcode http_auth_headers(struct connectdata * conn, char * request, char * path, bool * ready)' data-ref="http_auth_headers">http_auth_headers</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col7 decl" id="27conn" title='conn' data-type='struct connectdata *' data-ref="27conn">conn</dfn>,</td></tr>
<tr><th id="197">197</th><td>                                  <em>char</em> *<dfn class="local col8 decl" id="28request" title='request' data-type='char *' data-ref="28request">request</dfn>,</td></tr>
<tr><th id="198">198</th><td>                                  <em>char</em> *<dfn class="local col9 decl" id="29path" title='path' data-type='char *' data-ref="29path">path</dfn>,</td></tr>
<tr><th id="199">199</th><td>                                  <a class="typedef" href="setup.h.html#bool" title='bool' data-type='unsigned char' data-ref="bool">bool</a> *<dfn class="local col0 decl" id="30ready" title='ready' data-type='bool *' data-ref="30ready">ready</dfn>) <i>/* set TRUE when the auth phase</i></td></tr>
<tr><th id="200">200</th><td><i>                                           is done and ready to do the *actual*</i></td></tr>
<tr><th id="201">201</th><td><i>                                           request */</i></td></tr>
<tr><th id="202">202</th><td>{</td></tr>
<tr><th id="203">203</th><td>  <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="local col1 decl" id="31result" title='result' data-type='CURLcode' data-ref="31result">result</dfn> = <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="204">204</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col2 decl" id="32data" title='data' data-type='struct SessionHandle *' data-ref="32data">data</dfn> = <a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="205">205</th><td>  <em>char</em> *<dfn class="local col3 decl" id="33auth" title='auth' data-type='char *' data-ref="33auth">auth</dfn>=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="206">206</th><td></td></tr>
<tr><th id="207">207</th><td>  *<a class="local col0 ref" href="#30ready" title='ready' data-ref="30ready">ready</a> = <a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>; <i>/* default is no */</i></td></tr>
<tr><th id="208">208</th><td></td></tr>
<tr><th id="209">209</th><td>  <b>if</b>(!<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authstage" title='UrlState::authstage' data-ref="UrlState::authstage">authstage</a>) {</td></tr>
<tr><th id="210">210</th><td>    <b>if</b>(<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::httpproxy" title='ConnectBits::httpproxy' data-ref="ConnectBits::httpproxy">httpproxy</a> &amp;&amp; <a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::proxy_user_passwd" title='ConnectBits::proxy_user_passwd' data-ref="ConnectBits::proxy_user_passwd">proxy_user_passwd</a>)</td></tr>
<tr><th id="211">211</th><td>      <a class="ref" href="#Curl_http_auth_stage" title='Curl_http_auth_stage' data-ref="Curl_http_auth_stage">Curl_http_auth_stage</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>, <var>407</var>);</td></tr>
<tr><th id="212">212</th><td>    <b>else</b> <b>if</b>(<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::user_passwd" title='ConnectBits::user_passwd' data-ref="ConnectBits::user_passwd">user_passwd</a>)</td></tr>
<tr><th id="213">213</th><td>      <a class="ref" href="#Curl_http_auth_stage" title='Curl_http_auth_stage' data-ref="Curl_http_auth_stage">Curl_http_auth_stage</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>, <var>401</var>);</td></tr>
<tr><th id="214">214</th><td>    <b>else</b> {</td></tr>
<tr><th id="215">215</th><td>      *<a class="local col0 ref" href="#30ready" title='ready' data-ref="30ready">ready</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="216">216</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>; <i>/* no authentication with no user or password */</i></td></tr>
<tr><th id="217">217</th><td>    }</td></tr>
<tr><th id="218">218</th><td>  }</td></tr>
<tr><th id="219">219</th><td></td></tr>
<tr><th id="220">220</th><td>  <i>/* To prevent the user+password to get sent to other than the original</i></td></tr>
<tr><th id="221">221</th><td><i>     host due to a location-follow, we do some weirdo checks here */</i></td></tr>
<tr><th id="222">222</th><td>  <b>if</b>(!<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::this_is_a_follow" title='UrlState::this_is_a_follow' data-ref="UrlState::this_is_a_follow">this_is_a_follow</a> ||</td></tr>
<tr><th id="223">223</th><td>     !<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::auth_host" title='UrlState::auth_host' data-ref="UrlState::auth_host">auth_host</a> ||</td></tr>
<tr><th id="224">224</th><td>     <a class="ref" href="../include/curl/curl.h.html#curl_strequal" title='curl_strequal' data-ref="curl_strequal">curl_strequal</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::auth_host" title='UrlState::auth_host' data-ref="UrlState::auth_host">auth_host</a>, <a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::hostname" title='connectdata::hostname' data-ref="connectdata::hostname">hostname</a>) ||</td></tr>
<tr><th id="225">225</th><td>     <a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::http_disable_hostname_check_before_authentication" title='UserDefined::http_disable_hostname_check_before_authentication' data-ref="UserDefined::http_disable_hostname_check_before_authentication">http_disable_hostname_check_before_authentication</a>) {</td></tr>
<tr><th id="226">226</th><td></td></tr>
<tr><th id="227">227</th><td>  <i>/* Send proxy authentication header if needed */</i></td></tr>
<tr><th id="228">228</th><td>    <b>if</b> (<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authstage" title='UrlState::authstage' data-ref="UrlState::authstage">authstage</a> == <var>407</var>) {</td></tr>
<tr><th id="229">229</th><td><u>#<span data-ppcond="229">ifdef</span> <span class="macro" data-ref="_M/USE_SSLEAY">USE_SSLEAY</span></u></td></tr>
<tr><th id="230">230</th><td>      <b>if</b>(data-&gt;state.authwant == CURLAUTH_NTLM) {</td></tr>
<tr><th id="231">231</th><td>        auth=(<em>char</em> *)<q>"NTLM"</q>;</td></tr>
<tr><th id="232">232</th><td>        result = Curl_output_ntlm(conn, TRUE, ready);</td></tr>
<tr><th id="233">233</th><td>        <b>if</b>(result)</td></tr>
<tr><th id="234">234</th><td>          <b>return</b> result;</td></tr>
<tr><th id="235">235</th><td>      }</td></tr>
<tr><th id="236">236</th><td>      <b>else</b></td></tr>
<tr><th id="237">237</th><td><u>#<span data-ppcond="229">endif</span></u></td></tr>
<tr><th id="238">238</th><td>      <b>if</b>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> == <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>) {</td></tr>
<tr><th id="239">239</th><td>        <i>/* Basic */</i></td></tr>
<tr><th id="240">240</th><td>        <b>if</b>(<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::proxy_user_passwd" title='ConnectBits::proxy_user_passwd' data-ref="ConnectBits::proxy_user_passwd">proxy_user_passwd</a> &amp;&amp;</td></tr>
<tr><th id="241">241</th><td>           !<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>, <q>"Proxy-authorization:"</q>)) {</td></tr>
<tr><th id="242">242</th><td>          <a class="local col3 ref" href="#33auth" title='auth' data-ref="33auth">auth</a>=(<em>char</em> *)<q>"Basic"</q>;</td></tr>
<tr><th id="243">243</th><td>          <a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a> = <a class="tu ref" href="#Curl_output_basic_proxy" title='Curl_output_basic_proxy' data-use='c' data-ref="Curl_output_basic_proxy">Curl_output_basic_proxy</a>(<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>);</td></tr>
<tr><th id="244">244</th><td>          <b>if</b>(<a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a>)</td></tr>
<tr><th id="245">245</th><td>            <b>return</b> <a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a>;</td></tr>
<tr><th id="246">246</th><td>        }</td></tr>
<tr><th id="247">247</th><td>        *<a class="local col0 ref" href="#30ready" title='ready' data-ref="30ready">ready</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="248">248</th><td>        <i>/* Switch to web authentication after proxy authentication is done */</i></td></tr>
<tr><th id="249">249</th><td>        <a class="ref" href="#Curl_http_auth_stage" title='Curl_http_auth_stage' data-ref="Curl_http_auth_stage">Curl_http_auth_stage</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>, <var>401</var>);</td></tr>
<tr><th id="250">250</th><td>      }</td></tr>
<tr><th id="251">251</th><td>      <a class="macro" href="sendf.h.html#31" title="Curl_infof" data-ref="_M/infof">infof</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>, <q>"Proxy auth using %s with user '%s'\n"</q>,</td></tr>
<tr><th id="252">252</th><td>            <a class="local col3 ref" href="#33auth" title='auth' data-ref="33auth">auth</a>, <a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proxyuser" title='connectdata::proxyuser' data-ref="connectdata::proxyuser">proxyuser</a>?<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proxyuser" title='connectdata::proxyuser' data-ref="connectdata::proxyuser">proxyuser</a>:<q>""</q>);</td></tr>
<tr><th id="253">253</th><td>    }</td></tr>
<tr><th id="254">254</th><td>    <i>/* Send web authentication header if needed */</i></td></tr>
<tr><th id="255">255</th><td>    <b>if</b> (<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authstage" title='UrlState::authstage' data-ref="UrlState::authstage">authstage</a> == <var>401</var>) {</td></tr>
<tr><th id="256">256</th><td>      <a class="local col3 ref" href="#33auth" title='auth' data-ref="33auth">auth</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="257">257</th><td><u>#<span data-ppcond="257">ifdef</span> <span class="macro" data-ref="_M/HAVE_GSSAPI">HAVE_GSSAPI</span></u></td></tr>
<tr><th id="258">258</th><td>      <b>if</b>((data-&gt;state.authwant == CURLAUTH_GSSNEGOTIATE) &amp;&amp;</td></tr>
<tr><th id="259">259</th><td>         data-&gt;state.negotiate.context &amp;&amp; </td></tr>
<tr><th id="260">260</th><td>         !GSS_ERROR(data-&gt;state.negotiate.status)) {</td></tr>
<tr><th id="261">261</th><td>        auth=(<em>char</em> *)<q>"GSS-Negotiate"</q>;</td></tr>
<tr><th id="262">262</th><td>        result = Curl_output_negotiate(conn);</td></tr>
<tr><th id="263">263</th><td>        <b>if</b> (result)</td></tr>
<tr><th id="264">264</th><td>          <b>return</b> result;</td></tr>
<tr><th id="265">265</th><td>        *ready = TRUE;</td></tr>
<tr><th id="266">266</th><td>      }</td></tr>
<tr><th id="267">267</th><td>      <b>else</b></td></tr>
<tr><th id="268">268</th><td><u>#<span data-ppcond="257">endif</span></u></td></tr>
<tr><th id="269">269</th><td><u>#<span data-ppcond="269">ifdef</span> <span class="macro" data-ref="_M/USE_SSLEAY">USE_SSLEAY</span></u></td></tr>
<tr><th id="270">270</th><td>      <b>if</b>(data-&gt;state.authwant == CURLAUTH_NTLM) {</td></tr>
<tr><th id="271">271</th><td>        auth=(<em>char</em> *)<q>"NTLM"</q>;</td></tr>
<tr><th id="272">272</th><td>        result = Curl_output_ntlm(conn, FALSE, ready);</td></tr>
<tr><th id="273">273</th><td>        <b>if</b>(result)</td></tr>
<tr><th id="274">274</th><td>          <b>return</b> result;</td></tr>
<tr><th id="275">275</th><td>      }</td></tr>
<tr><th id="276">276</th><td>      <b>else</b></td></tr>
<tr><th id="277">277</th><td><u>#<span data-ppcond="269">endif</span></u></td></tr>
<tr><th id="278">278</th><td>      {</td></tr>
<tr><th id="279">279</th><td>        <b>if</b>((<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> == <a class="macro" href="../include/curl/curl.h.html#297" title="(1&lt;&lt;1)" data-ref="_M/CURLAUTH_DIGEST">CURLAUTH_DIGEST</a>) &amp;&amp;</td></tr>
<tr><th id="280">280</th><td>           <a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::digest" title='UrlState::digest' data-ref="UrlState::digest">digest</a>.<a class="ref" href="urldata.h.html#digestdata::nonce" title='digestdata::nonce' data-ref="digestdata::nonce">nonce</a>) {</td></tr>
<tr><th id="281">281</th><td>          <a class="local col3 ref" href="#33auth" title='auth' data-ref="33auth">auth</a>=(<em>char</em> *)<q>"Digest"</q>;</td></tr>
<tr><th id="282">282</th><td>          <a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a> = <a class="ref" href="http_digest.h.html#Curl_output_digest" title='Curl_output_digest' data-ref="Curl_output_digest">Curl_output_digest</a>(<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>,</td></tr>
<tr><th id="283">283</th><td>                                      (<em>unsigned</em> <em>char</em> *)<a class="local col8 ref" href="#28request" title='request' data-ref="28request">request</a>,</td></tr>
<tr><th id="284">284</th><td>                                      (<em>unsigned</em> <em>char</em> *)<a class="local col9 ref" href="#29path" title='path' data-ref="29path">path</a>);</td></tr>
<tr><th id="285">285</th><td>          <b>if</b>(<a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a>)</td></tr>
<tr><th id="286">286</th><td>            <b>return</b> <a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a>;</td></tr>
<tr><th id="287">287</th><td>          *<a class="local col0 ref" href="#30ready" title='ready' data-ref="30ready">ready</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="288">288</th><td>        }</td></tr>
<tr><th id="289">289</th><td>        <b>else</b> <b>if</b>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> == <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>) {<i>/* Basic */</i></td></tr>
<tr><th id="290">290</th><td>          <b>if</b>(<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::user_passwd" title='ConnectBits::user_passwd' data-ref="ConnectBits::user_passwd">user_passwd</a> &amp;&amp;</td></tr>
<tr><th id="291">291</th><td>             !<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>, <q>"Authorization:"</q>)) {</td></tr>
<tr><th id="292">292</th><td>            <a class="local col3 ref" href="#33auth" title='auth' data-ref="33auth">auth</a>=(<em>char</em> *)<q>"Basic"</q>;</td></tr>
<tr><th id="293">293</th><td>            <a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a> = <a class="tu ref" href="#Curl_output_basic" title='Curl_output_basic' data-use='c' data-ref="Curl_output_basic">Curl_output_basic</a>(<a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>);</td></tr>
<tr><th id="294">294</th><td>            <b>if</b>(<a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a>)</td></tr>
<tr><th id="295">295</th><td>              <b>return</b> <a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a>;</td></tr>
<tr><th id="296">296</th><td>          }</td></tr>
<tr><th id="297">297</th><td>          <i>/* basic is always ready */</i></td></tr>
<tr><th id="298">298</th><td>          *<a class="local col0 ref" href="#30ready" title='ready' data-ref="30ready">ready</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="299">299</th><td>        }</td></tr>
<tr><th id="300">300</th><td>      }</td></tr>
<tr><th id="301">301</th><td>      <b>if</b>(<a class="local col3 ref" href="#33auth" title='auth' data-ref="33auth">auth</a>)</td></tr>
<tr><th id="302">302</th><td>        <a class="macro" href="sendf.h.html#31" title="Curl_infof" data-ref="_M/infof">infof</a>(<a class="local col2 ref" href="#32data" title='data' data-ref="32data">data</a>, <q>"Server auth using %s with user '%s'\n"</q>,</td></tr>
<tr><th id="303">303</th><td>              <a class="local col3 ref" href="#33auth" title='auth' data-ref="33auth">auth</a>, <a class="local col7 ref" href="#27conn" title='conn' data-ref="27conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::user" title='connectdata::user' data-ref="connectdata::user">user</a>);</td></tr>
<tr><th id="304">304</th><td>    }</td></tr>
<tr><th id="305">305</th><td>  }</td></tr>
<tr><th id="306">306</th><td>  <b>else</b></td></tr>
<tr><th id="307">307</th><td>    *<a class="local col0 ref" href="#30ready" title='ready' data-ref="30ready">ready</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="308">308</th><td></td></tr>
<tr><th id="309">309</th><td>  <b>return</b> <a class="local col1 ref" href="#31result" title='result' data-ref="31result">result</a>;</td></tr>
<tr><th id="310">310</th><td>}</td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td></td></tr>
<tr><th id="313">313</th><td><i>/*</i></td></tr>
<tr><th id="314">314</th><td><i> * Curl_http_auth() deals with Proxy-Authenticate: and WWW-Authenticate:</i></td></tr>
<tr><th id="315">315</th><td><i> * headers. They are dealt with both in the transfer.c main loop and in the</i></td></tr>
<tr><th id="316">316</th><td><i> * proxy CONNECT loop.</i></td></tr>
<tr><th id="317">317</th><td><i> */</i></td></tr>
<tr><th id="318">318</th><td></td></tr>
<tr><th id="319">319</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="decl def" id="Curl_http_auth" title='Curl_http_auth' data-ref="Curl_http_auth">Curl_http_auth</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col4 decl" id="34conn" title='conn' data-type='struct connectdata *' data-ref="34conn">conn</dfn>,</td></tr>
<tr><th id="320">320</th><td>                        <em>int</em> <dfn class="local col5 decl" id="35httpcode" title='httpcode' data-type='int' data-ref="35httpcode">httpcode</dfn>,</td></tr>
<tr><th id="321">321</th><td>                        <em>char</em> *<dfn class="local col6 decl" id="36header" title='header' data-type='char *' data-ref="36header">header</dfn>) <i>/* pointing to the first non-space */</i></td></tr>
<tr><th id="322">322</th><td>{</td></tr>
<tr><th id="323">323</th><td>  <i>/*</i></td></tr>
<tr><th id="324">324</th><td><i>   * This resource requires authentication</i></td></tr>
<tr><th id="325">325</th><td><i>   */</i></td></tr>
<tr><th id="326">326</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col7 decl" id="37data" title='data' data-type='struct SessionHandle *' data-ref="37data">data</dfn> = <a class="local col4 ref" href="#34conn" title='conn' data-ref="34conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="327">327</th><td></td></tr>
<tr><th id="328">328</th><td>  <em>long</em> *<dfn class="local col8 decl" id="38availp" title='availp' data-type='long *' data-ref="38availp">availp</dfn>;</td></tr>
<tr><th id="329">329</th><td>  <em>char</em> *<dfn class="local col9 decl" id="39start" title='start' data-type='char *' data-ref="39start">start</dfn>;</td></tr>
<tr><th id="330">330</th><td></td></tr>
<tr><th id="331">331</th><td>  <b>if</b> (<a class="local col5 ref" href="#35httpcode" title='httpcode' data-ref="35httpcode">httpcode</a> == <var>407</var>) {</td></tr>
<tr><th id="332">332</th><td>    <a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a> = <a class="local col6 ref" href="#36header" title='header' data-ref="36header">header</a>+<a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<q>"Proxy-authenticate:"</q>);</td></tr>
<tr><th id="333">333</th><td>    <a class="local col8 ref" href="#38availp" title='availp' data-ref="38availp">availp</a> = &amp;<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::info" title='SessionHandle::info' data-ref="SessionHandle::info">info</a>.<a class="ref" href="urldata.h.html#PureInfo::proxyauthavail" title='PureInfo::proxyauthavail' data-ref="PureInfo::proxyauthavail">proxyauthavail</a>;</td></tr>
<tr><th id="334">334</th><td>  }</td></tr>
<tr><th id="335">335</th><td>  <b>else</b> {</td></tr>
<tr><th id="336">336</th><td>    <a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a> = <a class="local col6 ref" href="#36header" title='header' data-ref="36header">header</a>+<a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<q>"WWW-Authenticate:"</q>);</td></tr>
<tr><th id="337">337</th><td>    <a class="local col8 ref" href="#38availp" title='availp' data-ref="38availp">availp</a> = &amp;<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::info" title='SessionHandle::info' data-ref="SessionHandle::info">info</a>.<a class="ref" href="urldata.h.html#PureInfo::httpauthavail" title='PureInfo::httpauthavail' data-ref="PureInfo::httpauthavail">httpauthavail</a>;</td></tr>
<tr><th id="338">338</th><td>  }</td></tr>
<tr><th id="339">339</th><td>  <i>/*</i></td></tr>
<tr><th id="340">340</th><td><i>   * Switch from proxy to web authentication and back if needed</i></td></tr>
<tr><th id="341">341</th><td><i>   */</i></td></tr>
<tr><th id="342">342</th><td>  <b>if</b> (<a class="local col5 ref" href="#35httpcode" title='httpcode' data-ref="35httpcode">httpcode</a> == <var>407</var> &amp;&amp; <a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authstage" title='UrlState::authstage' data-ref="UrlState::authstage">authstage</a> != <var>407</var>)</td></tr>
<tr><th id="343">343</th><td>    <a class="ref" href="#Curl_http_auth_stage" title='Curl_http_auth_stage' data-ref="Curl_http_auth_stage">Curl_http_auth_stage</a>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>, <var>407</var>);</td></tr>
<tr><th id="344">344</th><td>              </td></tr>
<tr><th id="345">345</th><td>  <b>else</b> <b>if</b> (<a class="local col5 ref" href="#35httpcode" title='httpcode' data-ref="35httpcode">httpcode</a> == <var>401</var> &amp;&amp; <a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authstage" title='UrlState::authstage' data-ref="UrlState::authstage">authstage</a> != <var>401</var>)</td></tr>
<tr><th id="346">346</th><td>    <a class="ref" href="#Curl_http_auth_stage" title='Curl_http_auth_stage' data-ref="Curl_http_auth_stage">Curl_http_auth_stage</a>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>, <var>401</var>);</td></tr>
<tr><th id="347">347</th><td></td></tr>
<tr><th id="348">348</th><td>  <i>/* pass all white spaces */</i></td></tr>
<tr><th id="349">349</th><td>  <b>while</b>(*<a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a> &amp;&amp; <a class="macro" href="../../../include/ctype.h.html#205" title="((*__ctype_b_loc ())[(int) (((int)*start))] &amp; (unsigned short int) _ISspace)" data-ref="_M/isspace">isspace</a>((<em>int</em>)*<a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a>))</td></tr>
<tr><th id="350">350</th><td>    <a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a>++;</td></tr>
<tr><th id="351">351</th><td></td></tr>
<tr><th id="352">352</th><td>  <i>/*</i></td></tr>
<tr><th id="353">353</th><td><i>   * Here we check if we want the specific single authentiction (using ==) and</i></td></tr>
<tr><th id="354">354</th><td><i>   * if we do, we initiate usage of it.</i></td></tr>
<tr><th id="355">355</th><td><i>   *</i></td></tr>
<tr><th id="356">356</th><td><i>   * If the provided authentication is wanted as one out of several accepted</i></td></tr>
<tr><th id="357">357</th><td><i>   * types (using &amp;), we OR this authenticaion type to the authavail</i></td></tr>
<tr><th id="358">358</th><td><i>   * variable.</i></td></tr>
<tr><th id="359">359</th><td><i>   */</i></td></tr>
<tr><th id="360">360</th><td>  </td></tr>
<tr><th id="361">361</th><td><u>#<span data-ppcond="361">ifdef</span> <span class="macro" data-ref="_M/HAVE_GSSAPI">HAVE_GSSAPI</span></u></td></tr>
<tr><th id="362">362</th><td>  <b>if</b> (checkprefix(<q>"GSS-Negotiate"</q>, start) ||</td></tr>
<tr><th id="363">363</th><td>      checkprefix(<q>"Negotiate"</q>, start)) {</td></tr>
<tr><th id="364">364</th><td>    *availp |= CURLAUTH_GSSNEGOTIATE;</td></tr>
<tr><th id="365">365</th><td>    <b>if</b>(data-&gt;state.authwant == CURLAUTH_GSSNEGOTIATE) {</td></tr>
<tr><th id="366">366</th><td>      <i>/* if exactly this is wanted, go */</i></td></tr>
<tr><th id="367">367</th><td>      <em>int</em> neg = Curl_input_negotiate(conn, start);</td></tr>
<tr><th id="368">368</th><td>      <b>if</b> (neg == <var>0</var>)</td></tr>
<tr><th id="369">369</th><td>        conn-&gt;newurl = strdup(data-&gt;change.url);</td></tr>
<tr><th id="370">370</th><td>    }</td></tr>
<tr><th id="371">371</th><td>    <b>else</b></td></tr>
<tr><th id="372">372</th><td>      <b>if</b>(data-&gt;state.authwant &amp; CURLAUTH_GSSNEGOTIATE)</td></tr>
<tr><th id="373">373</th><td>        data-&gt;state.authavail |= CURLAUTH_GSSNEGOTIATE;</td></tr>
<tr><th id="374">374</th><td>  }</td></tr>
<tr><th id="375">375</th><td>  <b>else</b></td></tr>
<tr><th id="376">376</th><td><u>#<span data-ppcond="361">endif</span></u></td></tr>
<tr><th id="377">377</th><td><u>#<span data-ppcond="377">ifdef</span> <span class="macro" data-ref="_M/USE_SSLEAY">USE_SSLEAY</span></u></td></tr>
<tr><th id="378">378</th><td>    <i>/* NTLM support requires the SSL crypto libs */</i></td></tr>
<tr><th id="379">379</th><td>    <b>if</b>(checkprefix(<q>"NTLM"</q>, start)) {</td></tr>
<tr><th id="380">380</th><td>      *availp |= CURLAUTH_NTLM;</td></tr>
<tr><th id="381">381</th><td>      <b>if</b>(data-&gt;state.authwant == CURLAUTH_NTLM) {</td></tr>
<tr><th id="382">382</th><td>        <i>/* NTLM authentication is activated */</i></td></tr>
<tr><th id="383">383</th><td>        CURLntlm ntlm =</td></tr>
<tr><th id="384">384</th><td>          Curl_input_ntlm(conn, (bool)(httpcode == <var>407</var>), start);</td></tr>
<tr><th id="385">385</th><td>                  </td></tr>
<tr><th id="386">386</th><td>        <b>if</b>(CURLNTLM_BAD != ntlm)</td></tr>
<tr><th id="387">387</th><td>          conn-&gt;newurl = strdup(data-&gt;change.url); <i>/* clone string */</i></td></tr>
<tr><th id="388">388</th><td>        <b>else</b></td></tr>
<tr><th id="389">389</th><td>          infof(data, <q>"Authentication problem. Ignoring this.\n"</q>);</td></tr>
<tr><th id="390">390</th><td>      }</td></tr>
<tr><th id="391">391</th><td>      <b>else</b></td></tr>
<tr><th id="392">392</th><td>        <b>if</b>(data-&gt;state.authwant &amp; CURLAUTH_NTLM)</td></tr>
<tr><th id="393">393</th><td>          data-&gt;state.authavail |= CURLAUTH_NTLM;</td></tr>
<tr><th id="394">394</th><td>    }</td></tr>
<tr><th id="395">395</th><td>    <b>else</b></td></tr>
<tr><th id="396">396</th><td><u>#<span data-ppcond="377">endif</span></u></td></tr>
<tr><th id="397">397</th><td>      <b>if</b>(<a class="macro" href="strequal.h.html#37" title="curl_strnequal(&quot;Digest&quot;,start,strlen(&quot;Digest&quot;))" data-ref="_M/checkprefix">checkprefix</a>(<q>"Digest"</q>, <a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a>)) {</td></tr>
<tr><th id="398">398</th><td>        *<a class="local col8 ref" href="#38availp" title='availp' data-ref="38availp">availp</a> |= <a class="macro" href="../include/curl/curl.h.html#297" title="(1&lt;&lt;1)" data-ref="_M/CURLAUTH_DIGEST">CURLAUTH_DIGEST</a>;</td></tr>
<tr><th id="399">399</th><td>        <b>if</b>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> == <a class="macro" href="../include/curl/curl.h.html#297" title="(1&lt;&lt;1)" data-ref="_M/CURLAUTH_DIGEST">CURLAUTH_DIGEST</a>) {</td></tr>
<tr><th id="400">400</th><td>          <i>/* Digest authentication is activated */</i></td></tr>
<tr><th id="401">401</th><td>          <a class="typedef" href="http_digest.h.html#CURLdigest" title='CURLdigest' data-type='enum CURLdigest' data-ref="CURLdigest">CURLdigest</a> <dfn class="local col0 decl" id="40dig" title='dig' data-type='CURLdigest' data-ref="40dig">dig</dfn> = <a class="enum" href="http_digest.h.html#CURLDIGEST_BAD" title='CURLDIGEST_BAD' data-ref="CURLDIGEST_BAD">CURLDIGEST_BAD</a>;</td></tr>
<tr><th id="402">402</th><td></td></tr>
<tr><th id="403">403</th><td>          <b>if</b>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::digest" title='UrlState::digest' data-ref="UrlState::digest">digest</a>.<a class="ref" href="urldata.h.html#digestdata::nonce" title='digestdata::nonce' data-ref="digestdata::nonce">nonce</a>)</td></tr>
<tr><th id="404">404</th><td>            <a class="macro" href="sendf.h.html#31" title="Curl_infof" data-ref="_M/infof">infof</a>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>, <q>"Authentication problem. Ignoring this.\n"</q>);</td></tr>
<tr><th id="405">405</th><td>          <b>else</b></td></tr>
<tr><th id="406">406</th><td>            <a class="local col0 ref" href="#40dig" title='dig' data-ref="40dig">dig</a> = <a class="ref" href="http_digest.h.html#Curl_input_digest" title='Curl_input_digest' data-ref="Curl_input_digest">Curl_input_digest</a>(<a class="local col4 ref" href="#34conn" title='conn' data-ref="34conn">conn</a>, <a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a>);</td></tr>
<tr><th id="407">407</th><td>          </td></tr>
<tr><th id="408">408</th><td>          <b>if</b>(<a class="enum" href="http_digest.h.html#CURLDIGEST_FINE" title='CURLDIGEST_FINE' data-ref="CURLDIGEST_FINE">CURLDIGEST_FINE</a> == <a class="local col0 ref" href="#40dig" title='dig' data-ref="40dig">dig</a>)</td></tr>
<tr><th id="409">409</th><td>            <i>/* We act on it. Store our new url, which happens to be</i></td></tr>
<tr><th id="410">410</th><td><i>               the same one we already use! */</i></td></tr>
<tr><th id="411">411</th><td>            <a class="local col4 ref" href="#34conn" title='conn' data-ref="34conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::newurl" title='connectdata::newurl' data-ref="connectdata::newurl">newurl</a> = <a class="macro" href="memdebug.h.html#74" title="curl_dostrdup(data-&gt;change.url, 411, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/strdup">strdup</a>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::change" title='SessionHandle::change' data-ref="SessionHandle::change">change</a>.<a class="ref" href="urldata.h.html#DynamicStatic::url" title='DynamicStatic::url' data-ref="DynamicStatic::url">url</a>); <i>/* clone string */</i></td></tr>
<tr><th id="412">412</th><td>        }</td></tr>
<tr><th id="413">413</th><td>        <b>else</b></td></tr>
<tr><th id="414">414</th><td>          <b>if</b>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> &amp; <a class="macro" href="../include/curl/curl.h.html#297" title="(1&lt;&lt;1)" data-ref="_M/CURLAUTH_DIGEST">CURLAUTH_DIGEST</a>) {</td></tr>
<tr><th id="415">415</th><td>            <i>/* We don't know if Digest is what we're gonna use, but we</i></td></tr>
<tr><th id="416">416</th><td><i>               call this function anyway to store the digest data that</i></td></tr>
<tr><th id="417">417</th><td><i>               is provided on this line, to skip the extra round-trip</i></td></tr>
<tr><th id="418">418</th><td><i>               we need to do otherwise. We must sure to free this</i></td></tr>
<tr><th id="419">419</th><td><i>               data! */</i></td></tr>
<tr><th id="420">420</th><td>            <a class="ref" href="http_digest.h.html#Curl_input_digest" title='Curl_input_digest' data-ref="Curl_input_digest">Curl_input_digest</a>(<a class="local col4 ref" href="#34conn" title='conn' data-ref="34conn">conn</a>, <a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a>);</td></tr>
<tr><th id="421">421</th><td>            <a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> |= <a class="macro" href="../include/curl/curl.h.html#297" title="(1&lt;&lt;1)" data-ref="_M/CURLAUTH_DIGEST">CURLAUTH_DIGEST</a>;</td></tr>
<tr><th id="422">422</th><td>          }</td></tr>
<tr><th id="423">423</th><td>      }</td></tr>
<tr><th id="424">424</th><td>      <b>else</b> <b>if</b>(<a class="macro" href="strequal.h.html#37" title="curl_strnequal(&quot;Basic&quot;,start,strlen(&quot;Basic&quot;))" data-ref="_M/checkprefix">checkprefix</a>(<q>"Basic"</q>, <a class="local col9 ref" href="#39start" title='start' data-ref="39start">start</a>)) {</td></tr>
<tr><th id="425">425</th><td>        *<a class="local col8 ref" href="#38availp" title='availp' data-ref="38availp">availp</a> |= <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>;</td></tr>
<tr><th id="426">426</th><td>        <b>if</b>((<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> == <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>) &amp;&amp;</td></tr>
<tr><th id="427">427</th><td>           (<a class="local col5 ref" href="#35httpcode" title='httpcode' data-ref="35httpcode">httpcode</a> == <a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authstage" title='UrlState::authstage' data-ref="UrlState::authstage">authstage</a>)) {</td></tr>
<tr><th id="428">428</th><td>          <i>/* We asked for Basic authentication but got a 40X back</i></td></tr>
<tr><th id="429">429</th><td><i>             anyway, which basicly means our name+password isn't</i></td></tr>
<tr><th id="430">430</th><td><i>             valid. */</i></td></tr>
<tr><th id="431">431</th><td>          <a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> = <a class="macro" href="../include/curl/curl.h.html#295" title="0" data-ref="_M/CURLAUTH_NONE">CURLAUTH_NONE</a>;</td></tr>
<tr><th id="432">432</th><td>          <a class="macro" href="sendf.h.html#31" title="Curl_infof" data-ref="_M/infof">infof</a>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>, <q>"Authentication problem. Ignoring this.\n"</q>);</td></tr>
<tr><th id="433">433</th><td>        }</td></tr>
<tr><th id="434">434</th><td>        <b>else</b> <b>if</b>(<a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> &amp; <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>) {</td></tr>
<tr><th id="435">435</th><td>          <a class="local col7 ref" href="#37data" title='data' data-ref="37data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> |= <a class="macro" href="../include/curl/curl.h.html#296" title="(1&lt;&lt;0)" data-ref="_M/CURLAUTH_BASIC">CURLAUTH_BASIC</a>;</td></tr>
<tr><th id="436">436</th><td>        }</td></tr>
<tr><th id="437">437</th><td>      }</td></tr>
<tr><th id="438">438</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="439">439</th><td>}</td></tr>
<tr><th id="440">440</th><td></td></tr>
<tr><th id="441">441</th><td></td></tr>
<tr><th id="442">442</th><td><i  data-doc="readmoredata">/* fread() emulation to provide POST and/or request data */</i></td></tr>
<tr><th id="443">443</th><td><em>static</em> <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="tu decl def" id="readmoredata" title='readmoredata' data-type='size_t readmoredata(char * buffer, size_t size, size_t nitems, void * userp)' data-ref="readmoredata">readmoredata</dfn>(<em>char</em> *<dfn class="local col1 decl" id="41buffer" title='buffer' data-type='char *' data-ref="41buffer">buffer</dfn>,</td></tr>
<tr><th id="444">444</th><td>                           <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col2 decl" id="42size" title='size' data-type='size_t' data-ref="42size">size</dfn>,</td></tr>
<tr><th id="445">445</th><td>                           <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col3 decl" id="43nitems" title='nitems' data-type='size_t' data-ref="43nitems">nitems</dfn>,</td></tr>
<tr><th id="446">446</th><td>                           <em>void</em> *<dfn class="local col4 decl" id="44userp" title='userp' data-type='void *' data-ref="44userp">userp</dfn>)</td></tr>
<tr><th id="447">447</th><td>{</td></tr>
<tr><th id="448">448</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col5 decl" id="45conn" title='conn' data-type='struct connectdata *' data-ref="45conn">conn</dfn> = (<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *)<a class="local col4 ref" href="#44userp" title='userp' data-ref="44userp">userp</a>;</td></tr>
<tr><th id="449">449</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#HTTP" title='HTTP' data-ref="HTTP">HTTP</a> *<dfn class="local col6 decl" id="46http" title='http' data-type='struct HTTP *' data-ref="46http">http</dfn> = <a class="local col5 ref" href="#45conn" title='conn' data-ref="45conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proto" title='connectdata::proto' data-ref="connectdata::proto">proto</a>.<a class="ref" href="urldata.h.html#connectdata::(anonymous)::http" title='connectdata::(anonymous union)::http' data-ref="connectdata::(anonymous)::http">http</a>;</td></tr>
<tr><th id="450">450</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col7 decl" id="47fullsize" title='fullsize' data-type='size_t' data-ref="47fullsize">fullsize</dfn> = <a class="local col2 ref" href="#42size" title='size' data-ref="42size">size</a> * <a class="local col3 ref" href="#43nitems" title='nitems' data-ref="43nitems">nitems</a>;</td></tr>
<tr><th id="451">451</th><td></td></tr>
<tr><th id="452">452</th><td>  <b>if</b>(<var>0</var> == <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>)</td></tr>
<tr><th id="453">453</th><td>    <i>/* nothing to return */</i></td></tr>
<tr><th id="454">454</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="455">455</th><td>  </td></tr>
<tr><th id="456">456</th><td>  <i>/* make sure that a HTTP request is never sent away chunked! */</i></td></tr>
<tr><th id="457">457</th><td>  <a class="local col5 ref" href="#45conn" title='conn' data-ref="45conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::forbidchunk" title='ConnectBits::forbidchunk' data-ref="ConnectBits::forbidchunk">forbidchunk</a>= (<a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sending" title='HTTP::sending' data-ref="HTTP::sending">sending</a> == <a class="enum" href="urldata.h.html#HTTP::HTTPSEND_REQUEST" title='HTTP::HTTPSEND_REQUEST' data-ref="HTTP::HTTPSEND_REQUEST">HTTPSEND_REQUEST</a>)?<a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>:<a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>;</td></tr>
<tr><th id="458">458</th><td></td></tr>
<tr><th id="459">459</th><td>  <b>if</b>(<a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a> &lt;= (<a class="typedef" href="../include/curl/curl.h.html#curl_off_t" title='curl_off_t' data-type='off_t' data-ref="curl_off_t">curl_off_t</a>)<a class="local col7 ref" href="#47fullsize" title='fullsize' data-ref="47fullsize">fullsize</a>) {</td></tr>
<tr><th id="460">460</th><td>    <a class="ref" href="../../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col1 ref" href="#41buffer" title='buffer' data-ref="41buffer">buffer</a>, <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>, (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span>)<a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>);</td></tr>
<tr><th id="461">461</th><td>    <a class="local col7 ref" href="#47fullsize" title='fullsize' data-ref="47fullsize">fullsize</a> = (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span>)<a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>;</td></tr>
<tr><th id="462">462</th><td></td></tr>
<tr><th id="463">463</th><td>    <b>if</b>(<a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::postsize" title='back::postsize' data-ref="back::postsize">postsize</a>) {</td></tr>
<tr><th id="464">464</th><td>      <i>/* move backup data into focus and continue on that */</i></td></tr>
<tr><th id="465">465</th><td>      <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a> = <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::postdata" title='back::postdata' data-ref="back::postdata">postdata</a>;</td></tr>
<tr><th id="466">466</th><td>      <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a> = <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::postsize" title='back::postsize' data-ref="back::postsize">postsize</a>;</td></tr>
<tr><th id="467">467</th><td>      <a class="local col5 ref" href="#45conn" title='conn' data-ref="45conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread" title='connectdata::fread' data-ref="connectdata::fread">fread</a> =    <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::fread" title='back::fread' data-ref="back::fread">fread</a>;</td></tr>
<tr><th id="468">468</th><td>      <a class="local col5 ref" href="#45conn" title='conn' data-ref="45conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread_in" title='connectdata::fread_in' data-ref="connectdata::fread_in">fread_in</a> = <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::fread_in" title='back::fread_in' data-ref="back::fread_in">fread_in</a>;</td></tr>
<tr><th id="469">469</th><td></td></tr>
<tr><th id="470">470</th><td>      <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sending" title='HTTP::sending' data-ref="HTTP::sending">sending</a>++; <i>/* move one step up */</i></td></tr>
<tr><th id="471">471</th><td></td></tr>
<tr><th id="472">472</th><td>      <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::postsize" title='back::postsize' data-ref="back::postsize">postsize</a>=<var>0</var>;</td></tr>
<tr><th id="473">473</th><td>    }</td></tr>
<tr><th id="474">474</th><td>    <b>else</b></td></tr>
<tr><th id="475">475</th><td>      <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a> = <var>0</var>;</td></tr>
<tr><th id="476">476</th><td></td></tr>
<tr><th id="477">477</th><td>    <b>return</b> <a class="local col7 ref" href="#47fullsize" title='fullsize' data-ref="47fullsize">fullsize</a>;</td></tr>
<tr><th id="478">478</th><td>  }</td></tr>
<tr><th id="479">479</th><td></td></tr>
<tr><th id="480">480</th><td>  <a class="ref" href="../../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col1 ref" href="#41buffer" title='buffer' data-ref="41buffer">buffer</a>, <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>, <a class="local col7 ref" href="#47fullsize" title='fullsize' data-ref="47fullsize">fullsize</a>);</td></tr>
<tr><th id="481">481</th><td>  <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a> += <a class="local col7 ref" href="#47fullsize" title='fullsize' data-ref="47fullsize">fullsize</a>;</td></tr>
<tr><th id="482">482</th><td>  <a class="local col6 ref" href="#46http" title='http' data-ref="46http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a> -= <a class="local col7 ref" href="#47fullsize" title='fullsize' data-ref="47fullsize">fullsize</a>;</td></tr>
<tr><th id="483">483</th><td></td></tr>
<tr><th id="484">484</th><td>  <b>return</b> <a class="local col7 ref" href="#47fullsize" title='fullsize' data-ref="47fullsize">fullsize</a>;</td></tr>
<tr><th id="485">485</th><td>}</td></tr>
<tr><th id="486">486</th><td></td></tr>
<tr><th id="487">487</th><td><i>/* ------------------------------------------------------------------------- */</i></td></tr>
<tr><th id="488">488</th><td><i>/*</i></td></tr>
<tr><th id="489">489</th><td><i> * The add_buffer series of functions are used to build one large memory chunk</i></td></tr>
<tr><th id="490">490</th><td><i> * from repeated function invokes. Used so that the entire HTTP request can</i></td></tr>
<tr><th id="491">491</th><td><i> * be sent in one go.</i></td></tr>
<tr><th id="492">492</th><td><i> */</i></td></tr>
<tr><th id="493">493</th><td></td></tr>
<tr><th id="494">494</th><td><b>struct</b> <dfn class="type def" id="send_buffer" title='send_buffer' data-ref="send_buffer">send_buffer</dfn> {</td></tr>
<tr><th id="495">495</th><td>  <em>char</em> *<dfn class="tu decl" id="send_buffer::buffer" title='send_buffer::buffer' data-type='char *' data-ref="send_buffer::buffer">buffer</dfn>;</td></tr>
<tr><th id="496">496</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="tu decl" id="send_buffer::size_max" title='send_buffer::size_max' data-type='size_t' data-ref="send_buffer::size_max">size_max</dfn>;</td></tr>
<tr><th id="497">497</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="tu decl" id="send_buffer::size_used" title='send_buffer::size_used' data-type='size_t' data-ref="send_buffer::size_used">size_used</dfn>;</td></tr>
<tr><th id="498">498</th><td>};</td></tr>
<tr><th id="499">499</th><td><b>typedef</b> <b>struct</b> <a class="type" href="#send_buffer" title='send_buffer' data-ref="send_buffer">send_buffer</a> <dfn class="typedef" id="send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</dfn>;</td></tr>
<tr><th id="500">500</th><td></td></tr>
<tr><th id="501">501</th><td><em>static</em> <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a></td></tr>
<tr><th id="502">502</th><td> <a class="tu decl" href="#add_buffer" title='add_buffer' data-type='CURLcode add_buffer(send_buffer * in, const void * inptr, size_t size)' data-ref="add_buffer">add_buffer</a>(<a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="local col8 decl" id="48in" title='in' data-type='send_buffer *' data-ref="48in">in</dfn>, <em>const</em> <em>void</em> *<dfn class="local col9 decl" id="49inptr" title='inptr' data-type='const void *' data-ref="49inptr">inptr</dfn>, <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col0 decl" id="50size" title='size' data-type='size_t' data-ref="50size">size</dfn>);</td></tr>
<tr><th id="503">503</th><td></td></tr>
<tr><th id="504">504</th><td><i  data-doc="add_buffer_init">/*</i></td></tr>
<tr><th id="505">505</th><td><i  data-doc="add_buffer_init"> * add_buffer_init() returns a fine buffer struct</i></td></tr>
<tr><th id="506">506</th><td><i  data-doc="add_buffer_init"> */</i></td></tr>
<tr><th id="507">507</th><td><em>static</em></td></tr>
<tr><th id="508">508</th><td><a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="tu decl def" id="add_buffer_init" title='add_buffer_init' data-type='send_buffer * add_buffer_init()' data-ref="add_buffer_init">add_buffer_init</dfn>(<em>void</em>)</td></tr>
<tr><th id="509">509</th><td>{</td></tr>
<tr><th id="510">510</th><td>  <a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="local col1 decl" id="51blonk" title='blonk' data-type='send_buffer *' data-ref="51blonk">blonk</dfn>;</td></tr>
<tr><th id="511">511</th><td>  <a class="local col1 ref" href="#51blonk" title='blonk' data-ref="51blonk">blonk</a>=(<a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *)<a class="macro" href="memdebug.h.html#75" title="curl_domalloc(sizeof(send_buffer), 511, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/malloc">malloc</a>(<b>sizeof</b>(<a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a>));</td></tr>
<tr><th id="512">512</th><td>  <b>if</b>(<a class="local col1 ref" href="#51blonk" title='blonk' data-ref="51blonk">blonk</a>) {</td></tr>
<tr><th id="513">513</th><td>    <a class="ref" href="../../../include/string.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col1 ref" href="#51blonk" title='blonk' data-ref="51blonk">blonk</a>, <var>0</var>, <b>sizeof</b>(<a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a>));</td></tr>
<tr><th id="514">514</th><td>    <b>return</b> <a class="local col1 ref" href="#51blonk" title='blonk' data-ref="51blonk">blonk</a>;</td></tr>
<tr><th id="515">515</th><td>  }</td></tr>
<tr><th id="516">516</th><td>  <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* failed, go home */</i></td></tr>
<tr><th id="517">517</th><td>}</td></tr>
<tr><th id="518">518</th><td></td></tr>
<tr><th id="519">519</th><td><i  data-doc="add_buffer_send">/*</i></td></tr>
<tr><th id="520">520</th><td><i  data-doc="add_buffer_send"> * add_buffer_send() sends a buffer and frees all associated memory.</i></td></tr>
<tr><th id="521">521</th><td><i  data-doc="add_buffer_send"> */</i></td></tr>
<tr><th id="522">522</th><td><em>static</em></td></tr>
<tr><th id="523">523</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="tu decl def" id="add_buffer_send" title='add_buffer_send' data-type='CURLcode add_buffer_send(send_buffer * in, struct connectdata * conn, long * bytes_written)' data-ref="add_buffer_send">add_buffer_send</dfn>(<a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="local col2 decl" id="52in" title='in' data-type='send_buffer *' data-ref="52in">in</dfn>,</td></tr>
<tr><th id="524">524</th><td>                         <b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col3 decl" id="53conn" title='conn' data-type='struct connectdata *' data-ref="53conn">conn</dfn>,</td></tr>
<tr><th id="525">525</th><td>                         <em>long</em> *<dfn class="local col4 decl" id="54bytes_written" title='bytes_written' data-type='long *' data-ref="54bytes_written">bytes_written</dfn>) <i>/* add the number of sent</i></td></tr>
<tr><th id="526">526</th><td><i>                                                 bytes to this counter */</i></td></tr>
<tr><th id="527">527</th><td>{</td></tr>
<tr><th id="528">528</th><td>  <a class="typedef" href="../../../include/stdio.h.html#ssize_t" title='ssize_t' data-type='__ssize_t' data-ref="ssize_t">ssize_t</a> <dfn class="local col5 decl" id="55amount" title='amount' data-type='ssize_t' data-ref="55amount">amount</dfn>;</td></tr>
<tr><th id="529">529</th><td>  <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="local col6 decl" id="56res" title='res' data-type='CURLcode' data-ref="56res">res</dfn>;</td></tr>
<tr><th id="530">530</th><td>  <em>char</em> *<dfn class="local col7 decl" id="57ptr" title='ptr' data-type='char *' data-ref="57ptr">ptr</dfn>;</td></tr>
<tr><th id="531">531</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col8 decl" id="58size" title='size' data-type='size_t' data-ref="58size">size</dfn>;</td></tr>
<tr><th id="532">532</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#HTTP" title='HTTP' data-ref="HTTP">HTTP</a> *<dfn class="local col9 decl" id="59http" title='http' data-type='struct HTTP *' data-ref="59http">http</dfn> = <a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proto" title='connectdata::proto' data-ref="connectdata::proto">proto</a>.<a class="ref" href="urldata.h.html#connectdata::(anonymous)::http" title='connectdata::(anonymous union)::http' data-ref="connectdata::(anonymous)::http">http</a>;</td></tr>
<tr><th id="533">533</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col0 decl" id="60sendsize" title='sendsize' data-type='size_t' data-ref="60sendsize">sendsize</dfn>;</td></tr>
<tr><th id="534">534</th><td>  <a class="typedef" href="setup.h.html#curl_socket_t" title='curl_socket_t' data-type='int' data-ref="curl_socket_t">curl_socket_t</a> <dfn class="local col1 decl" id="61sockfd" title='sockfd' data-type='curl_socket_t' data-ref="61sockfd">sockfd</dfn> = <a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::sock" title='connectdata::sock' data-ref="connectdata::sock">sock</a>[<a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>];</td></tr>
<tr><th id="535">535</th><td></td></tr>
<tr><th id="536">536</th><td>  <i>/* The looping below is required since we use non-blocking sockets, but due</i></td></tr>
<tr><th id="537">537</th><td><i>     to the circumstances we will just loop and try again and again etc */</i></td></tr>
<tr><th id="538">538</th><td></td></tr>
<tr><th id="539">539</th><td>  <a class="local col7 ref" href="#57ptr" title='ptr' data-ref="57ptr">ptr</a> = <a class="local col2 ref" href="#52in" title='in' data-ref="52in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>;</td></tr>
<tr><th id="540">540</th><td>  <a class="local col8 ref" href="#58size" title='size' data-ref="58size">size</a> = <a class="local col2 ref" href="#52in" title='in' data-ref="52in">in</a>-&gt;<a class="tu ref" href="#send_buffer::size_used" title='send_buffer::size_used' data-use='r' data-ref="send_buffer::size_used">size_used</a>;</td></tr>
<tr><th id="541">541</th><td></td></tr>
<tr><th id="542">542</th><td>  <b>if</b>(<a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a> &amp; <a class="macro" href="urldata.h.html#411" title="(1&lt;&lt;3)" data-ref="_M/PROT_HTTPS">PROT_HTTPS</a>) {</td></tr>
<tr><th id="543">543</th><td>    <i>/* We never send more than CURL_MAX_WRITE_SIZE bytes in one single chunk</i></td></tr>
<tr><th id="544">544</th><td><i>       when we speak HTTPS, as if only a fraction of it is sent now, this data</i></td></tr>
<tr><th id="545">545</th><td><i>       needs to fit into the normal read-callback buffer later on and that</i></td></tr>
<tr><th id="546">546</th><td><i>       buffer is using this size.</i></td></tr>
<tr><th id="547">547</th><td><i>    */</i></td></tr>
<tr><th id="548">548</th><td></td></tr>
<tr><th id="549">549</th><td>    <a class="local col0 ref" href="#60sendsize" title='sendsize' data-ref="60sendsize">sendsize</a>= (<a class="local col8 ref" href="#58size" title='size' data-ref="58size">size</a> &gt; <a class="macro" href="../include/curl/curl.h.html#167" title="16384" data-ref="_M/CURL_MAX_WRITE_SIZE">CURL_MAX_WRITE_SIZE</a>)?<a class="macro" href="../include/curl/curl.h.html#167" title="16384" data-ref="_M/CURL_MAX_WRITE_SIZE">CURL_MAX_WRITE_SIZE</a>:<a class="local col8 ref" href="#58size" title='size' data-ref="58size">size</a>;</td></tr>
<tr><th id="550">550</th><td></td></tr>
<tr><th id="551">551</th><td>    <i>/* OpenSSL is very picky and we must send the SAME buffer pointer to the</i></td></tr>
<tr><th id="552">552</th><td><i>       library when we attempt to re-send this buffer. Sending the same data</i></td></tr>
<tr><th id="553">553</th><td><i>       is not enough, we must use the exact same address. For this reason, we</i></td></tr>
<tr><th id="554">554</th><td><i>       must copy the data to the uploadbuffer first, since that is the buffer</i></td></tr>
<tr><th id="555">555</th><td><i>       we will be using if this send is retried later.</i></td></tr>
<tr><th id="556">556</th><td><i>    */</i></td></tr>
<tr><th id="557">557</th><td>    <a class="ref" href="../../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::uploadbuffer" title='UrlState::uploadbuffer' data-ref="UrlState::uploadbuffer">uploadbuffer</a>, <a class="local col7 ref" href="#57ptr" title='ptr' data-ref="57ptr">ptr</a>, <a class="local col0 ref" href="#60sendsize" title='sendsize' data-ref="60sendsize">sendsize</a>);</td></tr>
<tr><th id="558">558</th><td>    <a class="local col7 ref" href="#57ptr" title='ptr' data-ref="57ptr">ptr</a> = <a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::uploadbuffer" title='UrlState::uploadbuffer' data-ref="UrlState::uploadbuffer">uploadbuffer</a>;</td></tr>
<tr><th id="559">559</th><td>  }</td></tr>
<tr><th id="560">560</th><td>  <b>else</b></td></tr>
<tr><th id="561">561</th><td>    <a class="local col0 ref" href="#60sendsize" title='sendsize' data-ref="60sendsize">sendsize</a> = <a class="local col8 ref" href="#58size" title='size' data-ref="58size">size</a>;</td></tr>
<tr><th id="562">562</th><td>  </td></tr>
<tr><th id="563">563</th><td>  <a class="local col6 ref" href="#56res" title='res' data-ref="56res">res</a> = <a class="ref" href="sendf.h.html#Curl_write" title='Curl_write' data-ref="Curl_write">Curl_write</a>(<a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>, <a class="local col1 ref" href="#61sockfd" title='sockfd' data-ref="61sockfd">sockfd</a>, <a class="local col7 ref" href="#57ptr" title='ptr' data-ref="57ptr">ptr</a>, <a class="local col0 ref" href="#60sendsize" title='sendsize' data-ref="60sendsize">sendsize</a>, &amp;<a class="local col5 ref" href="#55amount" title='amount' data-ref="55amount">amount</a>);</td></tr>
<tr><th id="564">564</th><td></td></tr>
<tr><th id="565">565</th><td>  <b>if</b>(<a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a> == <a class="local col6 ref" href="#56res" title='res' data-ref="56res">res</a>) {</td></tr>
<tr><th id="566">566</th><td></td></tr>
<tr><th id="567">567</th><td>    <b>if</b>(<a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::verbose" title='UserDefined::verbose' data-ref="UserDefined::verbose">verbose</a>)</td></tr>
<tr><th id="568">568</th><td>      <i>/* this data _may_ contain binary stuff */</i></td></tr>
<tr><th id="569">569</th><td>      <a class="ref" href="sendf.h.html#Curl_debug" title='Curl_debug' data-ref="Curl_debug">Curl_debug</a>(<a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>, <a class="enum" href="../include/curl/curl.h.html#CURLINFO_HEADER_OUT" title='CURLINFO_HEADER_OUT' data-ref="CURLINFO_HEADER_OUT">CURLINFO_HEADER_OUT</a>, <a class="local col7 ref" href="#57ptr" title='ptr' data-ref="57ptr">ptr</a>, <a class="local col5 ref" href="#55amount" title='amount' data-ref="55amount">amount</a>);</td></tr>
<tr><th id="570">570</th><td></td></tr>
<tr><th id="571">571</th><td>    *<a class="local col4 ref" href="#54bytes_written" title='bytes_written' data-ref="54bytes_written">bytes_written</a> += <a class="local col5 ref" href="#55amount" title='amount' data-ref="55amount">amount</a>;</td></tr>
<tr><th id="572">572</th><td>    </td></tr>
<tr><th id="573">573</th><td>    <b>if</b>((<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span>)<a class="local col5 ref" href="#55amount" title='amount' data-ref="55amount">amount</a> != <a class="local col8 ref" href="#58size" title='size' data-ref="58size">size</a>) {</td></tr>
<tr><th id="574">574</th><td>      <i>/* The whole request could not be sent in one system call. We must queue</i></td></tr>
<tr><th id="575">575</th><td><i>         it up and send it later when we get the chance. We must not loop here</i></td></tr>
<tr><th id="576">576</th><td><i>         and wait until it might work again. */</i></td></tr>
<tr><th id="577">577</th><td></td></tr>
<tr><th id="578">578</th><td>      <a class="local col8 ref" href="#58size" title='size' data-ref="58size">size</a> -= <a class="local col5 ref" href="#55amount" title='amount' data-ref="55amount">amount</a>;</td></tr>
<tr><th id="579">579</th><td></td></tr>
<tr><th id="580">580</th><td>      <a class="local col7 ref" href="#57ptr" title='ptr' data-ref="57ptr">ptr</a> = <a class="local col2 ref" href="#52in" title='in' data-ref="52in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a> + <a class="local col5 ref" href="#55amount" title='amount' data-ref="55amount">amount</a>;</td></tr>
<tr><th id="581">581</th><td>    </td></tr>
<tr><th id="582">582</th><td>      <i>/* backup the currently set pointers */</i></td></tr>
<tr><th id="583">583</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::fread" title='back::fread' data-ref="back::fread">fread</a> = <a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread" title='connectdata::fread' data-ref="connectdata::fread">fread</a>;</td></tr>
<tr><th id="584">584</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::fread_in" title='back::fread_in' data-ref="back::fread_in">fread_in</a> = <a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread_in" title='connectdata::fread_in' data-ref="connectdata::fread_in">fread_in</a>;</td></tr>
<tr><th id="585">585</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::postdata" title='back::postdata' data-ref="back::postdata">postdata</a> = <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>;</td></tr>
<tr><th id="586">586</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::backup" title='HTTP::backup' data-ref="HTTP::backup">backup</a>.<a class="ref" href="urldata.h.html#back::postsize" title='back::postsize' data-ref="back::postsize">postsize</a> = <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>;</td></tr>
<tr><th id="587">587</th><td></td></tr>
<tr><th id="588">588</th><td>      <i>/* set the new pointers for the request-sending */</i></td></tr>
<tr><th id="589">589</th><td>      <a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread" title='connectdata::fread' data-ref="connectdata::fread">fread</a> = (<a class="typedef" href="../include/curl/curl.h.html#curl_read_callback" title='curl_read_callback' data-type='size_t (*)(char *, size_t, size_t, void *)' data-ref="curl_read_callback">curl_read_callback</a>)<a class="tu ref" href="#readmoredata" title='readmoredata' data-use='r' data-ref="readmoredata">readmoredata</a>;</td></tr>
<tr><th id="590">590</th><td>      <a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread_in" title='connectdata::fread_in' data-ref="connectdata::fread_in">fread_in</a> = (<em>void</em> *)<a class="local col3 ref" href="#53conn" title='conn' data-ref="53conn">conn</a>;</td></tr>
<tr><th id="591">591</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a> = <a class="local col7 ref" href="#57ptr" title='ptr' data-ref="57ptr">ptr</a>;</td></tr>
<tr><th id="592">592</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a> = <a class="local col8 ref" href="#58size" title='size' data-ref="58size">size</a>;</td></tr>
<tr><th id="593">593</th><td></td></tr>
<tr><th id="594">594</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::send_buffer" title='HTTP::send_buffer' data-ref="HTTP::send_buffer">send_buffer</a> = <a class="local col2 ref" href="#52in" title='in' data-ref="52in">in</a>;</td></tr>
<tr><th id="595">595</th><td>      <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sending" title='HTTP::sending' data-ref="HTTP::sending">sending</a> = <a class="enum" href="urldata.h.html#HTTP::HTTPSEND_REQUEST" title='HTTP::HTTPSEND_REQUEST' data-ref="HTTP::HTTPSEND_REQUEST">HTTPSEND_REQUEST</a>;</td></tr>
<tr><th id="596">596</th><td>      </td></tr>
<tr><th id="597">597</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="598">598</th><td>    }</td></tr>
<tr><th id="599">599</th><td>    <a class="local col9 ref" href="#59http" title='http' data-ref="59http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sending" title='HTTP::sending' data-ref="HTTP::sending">sending</a> = <a class="enum" href="urldata.h.html#HTTP::HTTPSEND_BODY" title='HTTP::HTTPSEND_BODY' data-ref="HTTP::HTTPSEND_BODY">HTTPSEND_BODY</a>;</td></tr>
<tr><th id="600">600</th><td>    <i>/* the full buffer was sent, clean up and return */</i></td></tr>
<tr><th id="601">601</th><td>  }</td></tr>
<tr><th id="602">602</th><td>  <b>if</b>(<a class="local col2 ref" href="#52in" title='in' data-ref="52in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>)</td></tr>
<tr><th id="603">603</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(in-&gt;buffer, 603, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col2 ref" href="#52in" title='in' data-ref="52in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>);</td></tr>
<tr><th id="604">604</th><td>  <a class="macro" href="memdebug.h.html#78" title="curl_dofree(in, 604, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col2 ref" href="#52in" title='in' data-ref="52in">in</a>);</td></tr>
<tr><th id="605">605</th><td></td></tr>
<tr><th id="606">606</th><td>  <b>return</b> <a class="local col6 ref" href="#56res" title='res' data-ref="56res">res</a>;</td></tr>
<tr><th id="607">607</th><td>}</td></tr>
<tr><th id="608">608</th><td></td></tr>
<tr><th id="609">609</th><td></td></tr>
<tr><th id="610">610</th><td><i  data-doc="add_bufferf">/* </i></td></tr>
<tr><th id="611">611</th><td><i  data-doc="add_bufferf"> * add_bufferf() builds a buffer from the formatted input</i></td></tr>
<tr><th id="612">612</th><td><i  data-doc="add_bufferf"> */</i></td></tr>
<tr><th id="613">613</th><td><em>static</em></td></tr>
<tr><th id="614">614</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="tu decl def" id="add_bufferf" title='add_bufferf' data-type='CURLcode add_bufferf(send_buffer * in, const char * fmt)' data-ref="add_bufferf">add_bufferf</dfn>(<a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="local col2 decl" id="62in" title='in' data-type='send_buffer *' data-ref="62in">in</dfn>, <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="63fmt" title='fmt' data-type='const char *' data-ref="63fmt">fmt</dfn>, ...)</td></tr>
<tr><th id="615">615</th><td>{</td></tr>
<tr><th id="616">616</th><td>  <em>char</em> *<dfn class="local col4 decl" id="64s" title='s' data-type='char *' data-ref="64s">s</dfn>;</td></tr>
<tr><th id="617">617</th><td>  <span class='typedef' title='va_list' data-type='__gnuc_va_list' data-ref="va_list">va_list</span> <dfn class="local col5 decl" id="65ap" title='ap' data-type='va_list' data-ref="65ap">ap</dfn>;</td></tr>
<tr><th id="618">618</th><td>  <span class="macro" title="__builtin_va_start(ap, fmt)" data-ref="_M/va_start">va_start</span>(<a class="local col5 ref" href="#65ap" title='ap' data-ref="65ap">ap</a>, <a class="local col3 ref" href="#63fmt" title='fmt' data-ref="63fmt">fmt</a>);</td></tr>
<tr><th id="619">619</th><td>  <a class="local col4 ref" href="#64s" title='s' data-ref="64s">s</a> = <a class="macro" href="../include/curl/mprintf.h.html#51" title="curl_mvaprintf" data-ref="_M/vaprintf">vaprintf</a>(<a class="local col3 ref" href="#63fmt" title='fmt' data-ref="63fmt">fmt</a>, <a class="local col5 ref" href="#65ap" title='ap' data-ref="65ap">ap</a>); <i>/* this allocs a new string to append */</i></td></tr>
<tr><th id="620">620</th><td>  <span class="macro" title="__builtin_va_end(ap)" data-ref="_M/va_end">va_end</span>(<a class="local col5 ref" href="#65ap" title='ap' data-ref="65ap">ap</a>);</td></tr>
<tr><th id="621">621</th><td></td></tr>
<tr><th id="622">622</th><td>  <b>if</b>(<a class="local col4 ref" href="#64s" title='s' data-ref="64s">s</a>) {</td></tr>
<tr><th id="623">623</th><td>    <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="local col6 decl" id="66result" title='result' data-type='CURLcode' data-ref="66result">result</dfn> = <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col2 ref" href="#62in" title='in' data-ref="62in">in</a>, <a class="local col4 ref" href="#64s" title='s' data-ref="64s">s</a>, <a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col4 ref" href="#64s" title='s' data-ref="64s">s</a>));</td></tr>
<tr><th id="624">624</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(s, 624, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col4 ref" href="#64s" title='s' data-ref="64s">s</a>);</td></tr>
<tr><th id="625">625</th><td>    <b>if</b>(<a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a> == <a class="local col6 ref" href="#66result" title='result' data-ref="66result">result</a>)</td></tr>
<tr><th id="626">626</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="627">627</th><td>  }</td></tr>
<tr><th id="628">628</th><td>  <i>/* If we failed, we cleanup the whole buffer and return error */</i></td></tr>
<tr><th id="629">629</th><td>  <b>if</b>(<a class="local col2 ref" href="#62in" title='in' data-ref="62in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>)</td></tr>
<tr><th id="630">630</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(in-&gt;buffer, 630, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col2 ref" href="#62in" title='in' data-ref="62in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>);</td></tr>
<tr><th id="631">631</th><td>  <a class="macro" href="memdebug.h.html#78" title="curl_dofree(in, 631, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col2 ref" href="#62in" title='in' data-ref="62in">in</a>);</td></tr>
<tr><th id="632">632</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="633">633</th><td>}</td></tr>
<tr><th id="634">634</th><td></td></tr>
<tr><th id="635">635</th><td><i  data-doc="add_buffer">/*</i></td></tr>
<tr><th id="636">636</th><td><i  data-doc="add_buffer"> * add_buffer() appends a memory chunk to the existing one</i></td></tr>
<tr><th id="637">637</th><td><i  data-doc="add_buffer"> */</i></td></tr>
<tr><th id="638">638</th><td><em>static</em></td></tr>
<tr><th id="639">639</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="tu decl def" id="add_buffer" title='add_buffer' data-type='CURLcode add_buffer(send_buffer * in, const void * inptr, size_t size)' data-ref="add_buffer">add_buffer</dfn>(<a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="local col7 decl" id="67in" title='in' data-type='send_buffer *' data-ref="67in">in</dfn>, <em>const</em> <em>void</em> *<dfn class="local col8 decl" id="68inptr" title='inptr' data-type='const void *' data-ref="68inptr">inptr</dfn>, <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col9 decl" id="69size" title='size' data-type='size_t' data-ref="69size">size</dfn>)</td></tr>
<tr><th id="640">640</th><td>{</td></tr>
<tr><th id="641">641</th><td>  <em>char</em> *<dfn class="local col0 decl" id="70new_rb" title='new_rb' data-type='char *' data-ref="70new_rb">new_rb</dfn>;</td></tr>
<tr><th id="642">642</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col1 decl" id="71new_size" title='new_size' data-type='size_t' data-ref="71new_size">new_size</dfn>;</td></tr>
<tr><th id="643">643</th><td></td></tr>
<tr><th id="644">644</th><td>  <b>if</b>(!<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a> ||</td></tr>
<tr><th id="645">645</th><td>     ((<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::size_used" title='send_buffer::size_used' data-use='r' data-ref="send_buffer::size_used">size_used</a> + <a class="local col9 ref" href="#69size" title='size' data-ref="69size">size</a>) &gt; (<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::size_max" title='send_buffer::size_max' data-use='r' data-ref="send_buffer::size_max">size_max</a> - <var>1</var>))) {</td></tr>
<tr><th id="646">646</th><td>    <a class="local col1 ref" href="#71new_size" title='new_size' data-ref="71new_size">new_size</a> = (<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::size_used" title='send_buffer::size_used' data-use='r' data-ref="send_buffer::size_used">size_used</a>+<a class="local col9 ref" href="#69size" title='size' data-ref="69size">size</a>)*<var>2</var>;</td></tr>
<tr><th id="647">647</th><td>    <b>if</b>(<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>)</td></tr>
<tr><th id="648">648</th><td>      <i>/* we have a buffer, enlarge the existing one */</i></td></tr>
<tr><th id="649">649</th><td>      <a class="local col0 ref" href="#70new_rb" title='new_rb' data-ref="70new_rb">new_rb</a> = (<em>char</em> *)<a class="macro" href="memdebug.h.html#77" title="curl_dorealloc(in-&gt;buffer, new_size, 649, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/realloc">realloc</a>(<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>, <a class="local col1 ref" href="#71new_size" title='new_size' data-ref="71new_size">new_size</a>);</td></tr>
<tr><th id="650">650</th><td>    <b>else</b></td></tr>
<tr><th id="651">651</th><td>      <i>/* create a new buffer */</i></td></tr>
<tr><th id="652">652</th><td>      <a class="local col0 ref" href="#70new_rb" title='new_rb' data-ref="70new_rb">new_rb</a> = (<em>char</em> *)<a class="macro" href="memdebug.h.html#75" title="curl_domalloc(new_size, 652, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/malloc">malloc</a>(<a class="local col1 ref" href="#71new_size" title='new_size' data-ref="71new_size">new_size</a>);</td></tr>
<tr><th id="653">653</th><td></td></tr>
<tr><th id="654">654</th><td>    <b>if</b>(!<a class="local col0 ref" href="#70new_rb" title='new_rb' data-ref="70new_rb">new_rb</a>)</td></tr>
<tr><th id="655">655</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="656">656</th><td></td></tr>
<tr><th id="657">657</th><td>    <a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='w' data-ref="send_buffer::buffer">buffer</a> = <a class="local col0 ref" href="#70new_rb" title='new_rb' data-ref="70new_rb">new_rb</a>;</td></tr>
<tr><th id="658">658</th><td>    <a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::size_max" title='send_buffer::size_max' data-use='w' data-ref="send_buffer::size_max">size_max</a> = <a class="local col1 ref" href="#71new_size" title='new_size' data-ref="71new_size">new_size</a>;</td></tr>
<tr><th id="659">659</th><td>  }</td></tr>
<tr><th id="660">660</th><td>  <a class="ref" href="../../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(&amp;<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>[<a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::size_used" title='send_buffer::size_used' data-use='r' data-ref="send_buffer::size_used">size_used</a>], <a class="local col8 ref" href="#68inptr" title='inptr' data-ref="68inptr">inptr</a>, <a class="local col9 ref" href="#69size" title='size' data-ref="69size">size</a>);</td></tr>
<tr><th id="661">661</th><td>      </td></tr>
<tr><th id="662">662</th><td>  <a class="local col7 ref" href="#67in" title='in' data-ref="67in">in</a>-&gt;<a class="tu ref" href="#send_buffer::size_used" title='send_buffer::size_used' data-use='w' data-ref="send_buffer::size_used">size_used</a> += <a class="local col9 ref" href="#69size" title='size' data-ref="69size">size</a>;</td></tr>
<tr><th id="663">663</th><td></td></tr>
<tr><th id="664">664</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="665">665</th><td>}</td></tr>
<tr><th id="666">666</th><td></td></tr>
<tr><th id="667">667</th><td><i>/* end of the add_buffer functions */</i></td></tr>
<tr><th id="668">668</th><td><i>/* ------------------------------------------------------------------------- */</i></td></tr>
<tr><th id="669">669</th><td></td></tr>
<tr><th id="670">670</th><td><i>/*</i></td></tr>
<tr><th id="671">671</th><td><i> * Curl_compareheader()</i></td></tr>
<tr><th id="672">672</th><td><i> *</i></td></tr>
<tr><th id="673">673</th><td><i> * Returns TRUE if 'headerline' contains the 'header' with given 'content'.</i></td></tr>
<tr><th id="674">674</th><td><i> * Pass headers WITH the colon.</i></td></tr>
<tr><th id="675">675</th><td><i> */</i></td></tr>
<tr><th id="676">676</th><td><a class="typedef" href="setup.h.html#bool" title='bool' data-type='unsigned char' data-ref="bool">bool</a></td></tr>
<tr><th id="677">677</th><td><dfn class="decl def" id="Curl_compareheader" title='Curl_compareheader' data-ref="Curl_compareheader">Curl_compareheader</dfn>(<em>char</em> *<dfn class="local col2 decl" id="72headerline" title='headerline' data-type='char *' data-ref="72headerline">headerline</dfn>,    <i>/* line to check */</i></td></tr>
<tr><th id="678">678</th><td>                   <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="73header" title='header' data-type='const char *' data-ref="73header">header</dfn>,  <i>/* header keyword _with_ colon */</i></td></tr>
<tr><th id="679">679</th><td>                   <em>const</em> <em>char</em> *<dfn class="local col4 decl" id="74content" title='content' data-type='const char *' data-ref="74content">content</dfn>) <i>/* content string to find */</i></td></tr>
<tr><th id="680">680</th><td>{</td></tr>
<tr><th id="681">681</th><td>  <i>/* RFC2616, section 4.2 says: "Each header field consists of a name followed</i></td></tr>
<tr><th id="682">682</th><td><i>   * by a colon (":") and the field value. Field names are case-insensitive.</i></td></tr>
<tr><th id="683">683</th><td><i>   * The field value MAY be preceded by any amount of LWS, though a single SP</i></td></tr>
<tr><th id="684">684</th><td><i>   * is preferred." */</i></td></tr>
<tr><th id="685">685</th><td></td></tr>
<tr><th id="686">686</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col5 decl" id="75hlen" title='hlen' data-type='size_t' data-ref="75hlen">hlen</dfn> = <a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col3 ref" href="#73header" title='header' data-ref="73header">header</a>);</td></tr>
<tr><th id="687">687</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col6 decl" id="76clen" title='clen' data-type='size_t' data-ref="76clen">clen</dfn>;</td></tr>
<tr><th id="688">688</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col7 decl" id="77len" title='len' data-type='size_t' data-ref="77len">len</dfn>;</td></tr>
<tr><th id="689">689</th><td>  <em>char</em> *<dfn class="local col8 decl" id="78start" title='start' data-type='char *' data-ref="78start">start</dfn>;</td></tr>
<tr><th id="690">690</th><td>  <em>char</em> *<dfn class="local col9 decl" id="79end" title='end' data-type='char *' data-ref="79end">end</dfn>;</td></tr>
<tr><th id="691">691</th><td></td></tr>
<tr><th id="692">692</th><td>  <b>if</b>(!<a class="macro" href="strequal.h.html#33" title="curl_strnequal(headerline,header,hlen)" data-ref="_M/strnequal">strnequal</a>(<a class="local col2 ref" href="#72headerline" title='headerline' data-ref="72headerline">headerline</a>, <a class="local col3 ref" href="#73header" title='header' data-ref="73header">header</a>, <a class="local col5 ref" href="#75hlen" title='hlen' data-ref="75hlen">hlen</a>))</td></tr>
<tr><th id="693">693</th><td>    <b>return</b> <a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>; <i>/* doesn't start with header */</i></td></tr>
<tr><th id="694">694</th><td></td></tr>
<tr><th id="695">695</th><td>  <i>/* pass the header */</i></td></tr>
<tr><th id="696">696</th><td>  <a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a> = &amp;<a class="local col2 ref" href="#72headerline" title='headerline' data-ref="72headerline">headerline</a>[<a class="local col5 ref" href="#75hlen" title='hlen' data-ref="75hlen">hlen</a>];</td></tr>
<tr><th id="697">697</th><td></td></tr>
<tr><th id="698">698</th><td>  <i>/* pass all white spaces */</i></td></tr>
<tr><th id="699">699</th><td>  <b>while</b>(*<a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a> &amp;&amp; <a class="macro" href="../../../include/ctype.h.html#205" title="((*__ctype_b_loc ())[(int) (((int)*start))] &amp; (unsigned short int) _ISspace)" data-ref="_M/isspace">isspace</a>((<em>int</em>)*<a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>))</td></tr>
<tr><th id="700">700</th><td>    <a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>++;</td></tr>
<tr><th id="701">701</th><td></td></tr>
<tr><th id="702">702</th><td>  <i>/* find the end of the header line */</i></td></tr>
<tr><th id="703">703</th><td>  <a class="local col9 ref" href="#79end" title='end' data-ref="79end">end</a> = <a class="ref" href="../../../include/string.h.html#strchr" title='strchr' data-ref="strchr">strchr</a>(<a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>, <kbd>'\r'</kbd>); <i>/* lines end with CRLF */</i></td></tr>
<tr><th id="704">704</th><td>  <b>if</b>(!<a class="local col9 ref" href="#79end" title='end' data-ref="79end">end</a>) {</td></tr>
<tr><th id="705">705</th><td>    <i>/* in case there's a non-standard compliant line here */</i></td></tr>
<tr><th id="706">706</th><td>    <a class="local col9 ref" href="#79end" title='end' data-ref="79end">end</a> = <a class="ref" href="../../../include/string.h.html#strchr" title='strchr' data-ref="strchr">strchr</a>(<a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>, <kbd>'\n'</kbd>);</td></tr>
<tr><th id="707">707</th><td></td></tr>
<tr><th id="708">708</th><td>    <b>if</b>(!<a class="local col9 ref" href="#79end" title='end' data-ref="79end">end</a>)</td></tr>
<tr><th id="709">709</th><td>      <i>/* hm, there's no line ending here, use the zero byte! */</i></td></tr>
<tr><th id="710">710</th><td>      <a class="local col9 ref" href="#79end" title='end' data-ref="79end">end</a> = <a class="ref" href="../../../include/string.h.html#strchr" title='strchr' data-ref="strchr">strchr</a>(<a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>, <kbd>'\0'</kbd>);</td></tr>
<tr><th id="711">711</th><td>  }</td></tr>
<tr><th id="712">712</th><td></td></tr>
<tr><th id="713">713</th><td>  <a class="local col7 ref" href="#77len" title='len' data-ref="77len">len</a> = <a class="local col9 ref" href="#79end" title='end' data-ref="79end">end</a>-<a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>; <i>/* length of the content part of the input line */</i></td></tr>
<tr><th id="714">714</th><td>  <a class="local col6 ref" href="#76clen" title='clen' data-ref="76clen">clen</a> = <a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col4 ref" href="#74content" title='content' data-ref="74content">content</a>); <i>/* length of the word to find */</i></td></tr>
<tr><th id="715">715</th><td></td></tr>
<tr><th id="716">716</th><td>  <i>/* find the content string in the rest of the line */</i></td></tr>
<tr><th id="717">717</th><td>  <b>for</b>(;<a class="local col7 ref" href="#77len" title='len' data-ref="77len">len</a>&gt;=<a class="local col6 ref" href="#76clen" title='clen' data-ref="76clen">clen</a>;<a class="local col7 ref" href="#77len" title='len' data-ref="77len">len</a>--, <a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>++) {</td></tr>
<tr><th id="718">718</th><td>    <b>if</b>(<a class="macro" href="strequal.h.html#33" title="curl_strnequal(start,content,clen)" data-ref="_M/strnequal">strnequal</a>(<a class="local col8 ref" href="#78start" title='start' data-ref="78start">start</a>, <a class="local col4 ref" href="#74content" title='content' data-ref="74content">content</a>, <a class="local col6 ref" href="#76clen" title='clen' data-ref="76clen">clen</a>))</td></tr>
<tr><th id="719">719</th><td>      <b>return</b> <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>; <i>/* match! */</i></td></tr>
<tr><th id="720">720</th><td>  }</td></tr>
<tr><th id="721">721</th><td></td></tr>
<tr><th id="722">722</th><td>  <b>return</b> <a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>; <i>/* no match */</i></td></tr>
<tr><th id="723">723</th><td>}</td></tr>
<tr><th id="724">724</th><td></td></tr>
<tr><th id="725">725</th><td><i>/*</i></td></tr>
<tr><th id="726">726</th><td><i> * ConnectHTTPProxyTunnel() requires that we're connected to a HTTP proxy. This</i></td></tr>
<tr><th id="727">727</th><td><i> * function will issue the necessary commands to get a seamless tunnel through</i></td></tr>
<tr><th id="728">728</th><td><i> * this proxy. After that, the socket can be used just as a normal socket.</i></td></tr>
<tr><th id="729">729</th><td><i> */</i></td></tr>
<tr><th id="730">730</th><td></td></tr>
<tr><th id="731">731</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="decl def" id="Curl_ConnectHTTPProxyTunnel" title='Curl_ConnectHTTPProxyTunnel' data-ref="Curl_ConnectHTTPProxyTunnel">Curl_ConnectHTTPProxyTunnel</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col0 decl" id="80conn" title='conn' data-type='struct connectdata *' data-ref="80conn">conn</dfn>,</td></tr>
<tr><th id="732">732</th><td>                                     <em>int</em> <dfn class="local col1 decl" id="81sockindex" title='sockindex' data-type='int' data-ref="81sockindex">sockindex</dfn>,</td></tr>
<tr><th id="733">733</th><td>                                     <em>char</em> *<dfn class="local col2 decl" id="82hostname" title='hostname' data-type='char *' data-ref="82hostname">hostname</dfn>,</td></tr>
<tr><th id="734">734</th><td>                                     <em>int</em> <dfn class="local col3 decl" id="83remote_port" title='remote_port' data-type='int' data-ref="83remote_port">remote_port</dfn>)</td></tr>
<tr><th id="735">735</th><td>{</td></tr>
<tr><th id="736">736</th><td>  <em>int</em> <dfn class="local col4 decl" id="84httpcode" title='httpcode' data-type='int' data-ref="84httpcode">httpcode</dfn>=<var>0</var>;</td></tr>
<tr><th id="737">737</th><td>  <em>int</em> <dfn class="local col5 decl" id="85subversion" title='subversion' data-type='int' data-ref="85subversion">subversion</dfn>=<var>0</var>;</td></tr>
<tr><th id="738">738</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col6 decl" id="86data" title='data' data-type='struct SessionHandle *' data-ref="86data">data</dfn>=<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="739">739</th><td>  <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="local col7 decl" id="87result" title='result' data-type='CURLcode' data-ref="87result">result</dfn>;</td></tr>
<tr><th id="740">740</th><td>  <em>int</em> <dfn class="local col8 decl" id="88res" title='res' data-type='int' data-ref="88res">res</dfn>;</td></tr>
<tr><th id="741">741</th><td></td></tr>
<tr><th id="742">742</th><td>  <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col9 decl" id="89nread" title='nread' data-type='size_t' data-ref="89nread">nread</dfn>;   <i>/* total size read */</i></td></tr>
<tr><th id="743">743</th><td>  <em>int</em> <dfn class="local col0 decl" id="90perline" title='perline' data-type='int' data-ref="90perline">perline</dfn>; <i>/* count bytes per line */</i></td></tr>
<tr><th id="744">744</th><td>  <a class="typedef" href="setup.h.html#bool" title='bool' data-type='unsigned char' data-ref="bool">bool</a> <dfn class="local col1 decl" id="91keepon" title='keepon' data-type='bool' data-ref="91keepon">keepon</dfn>=<a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="745">745</th><td>  <a class="typedef" href="../../../include/stdio.h.html#ssize_t" title='ssize_t' data-type='__ssize_t' data-ref="ssize_t">ssize_t</a> <dfn class="local col2 decl" id="92gotbytes" title='gotbytes' data-type='ssize_t' data-ref="92gotbytes">gotbytes</dfn>;</td></tr>
<tr><th id="746">746</th><td>  <em>char</em> *<dfn class="local col3 decl" id="93ptr" title='ptr' data-type='char *' data-ref="93ptr">ptr</dfn>;</td></tr>
<tr><th id="747">747</th><td>  <em>long</em> <dfn class="local col4 decl" id="94timeout" title='timeout' data-type='long' data-ref="94timeout">timeout</dfn> = <var>3600</var>; <i>/* default timeout in seconds */</i></td></tr>
<tr><th id="748">748</th><td>  <b>struct</b> <a class="type" href="../../../include/x86_64-linux-gnu/bits/time.h.html#timeval" title='timeval' data-ref="timeval">timeval</a> <dfn class="local col5 decl" id="95interval" title='interval' data-type='struct timeval' data-ref="95interval">interval</dfn>;</td></tr>
<tr><th id="749">749</th><td>  <a class="typedef" href="../../../include/x86_64-linux-gnu/sys/select.h.html#fd_set" title='fd_set' data-type='struct fd_set' data-ref="fd_set">fd_set</a> <dfn class="local col6 decl" id="96rkeepfd" title='rkeepfd' data-type='fd_set' data-ref="96rkeepfd">rkeepfd</dfn>;</td></tr>
<tr><th id="750">750</th><td>  <a class="typedef" href="../../../include/x86_64-linux-gnu/sys/select.h.html#fd_set" title='fd_set' data-type='struct fd_set' data-ref="fd_set">fd_set</a> <dfn class="local col7 decl" id="97readfd" title='readfd' data-type='fd_set' data-ref="97readfd">readfd</dfn>;</td></tr>
<tr><th id="751">751</th><td>  <em>char</em> *<dfn class="local col8 decl" id="98line_start" title='line_start' data-type='char *' data-ref="98line_start">line_start</dfn>;</td></tr>
<tr><th id="752">752</th><td>  <em>char</em> *<dfn class="local col9 decl" id="99host_port" title='host_port' data-type='char *' data-ref="99host_port">host_port</dfn>;</td></tr>
<tr><th id="753">753</th><td>  <a class="typedef" href="setup.h.html#curl_socket_t" title='curl_socket_t' data-type='int' data-ref="curl_socket_t">curl_socket_t</a> <dfn class="local col0 decl" id="100tunnelsocket" title='tunnelsocket' data-type='curl_socket_t' data-ref="100tunnelsocket">tunnelsocket</dfn> = <a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::sock" title='connectdata::sock' data-ref="connectdata::sock">sock</a>[<a class="local col1 ref" href="#81sockindex" title='sockindex' data-ref="81sockindex">sockindex</a>];</td></tr>
<tr><th id="754">754</th><td></td></tr>
<tr><th id="755">755</th><td><u>#define <dfn class="macro" id="_M/SELECT_OK" data-ref="_M/SELECT_OK">SELECT_OK</dfn>      0</u></td></tr>
<tr><th id="756">756</th><td><u>#define <dfn class="macro" id="_M/SELECT_ERROR" data-ref="_M/SELECT_ERROR">SELECT_ERROR</dfn>   1</u></td></tr>
<tr><th id="757">757</th><td><u>#define <dfn class="macro" id="_M/SELECT_TIMEOUT" data-ref="_M/SELECT_TIMEOUT">SELECT_TIMEOUT</dfn> 2</u></td></tr>
<tr><th id="758">758</th><td>  <em>int</em> <dfn class="local col1 decl" id="101error" title='error' data-type='int' data-ref="101error">error</dfn> = <a class="macro" href="#755" title="0" data-ref="_M/SELECT_OK">SELECT_OK</a>;</td></tr>
<tr><th id="759">759</th><td></td></tr>
<tr><th id="760">760</th><td>  <a class="macro" href="sendf.h.html#31" title="Curl_infof" data-ref="_M/infof">infof</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <q>"Establish HTTP proxy tunnel to %s:%d\n"</q>, <a class="local col2 ref" href="#82hostname" title='hostname' data-ref="82hostname">hostname</a>, <a class="local col3 ref" href="#83remote_port" title='remote_port' data-ref="83remote_port">remote_port</a>);</td></tr>
<tr><th id="761">761</th><td></td></tr>
<tr><th id="762">762</th><td>  <b>do</b> {</td></tr>
<tr><th id="763">763</th><td>    <a class="typedef" href="setup.h.html#bool" title='bool' data-type='unsigned char' data-ref="bool">bool</a> <dfn class="local col2 decl" id="102auth" title='auth' data-type='bool' data-ref="102auth">auth</dfn>; <i>/* we don't really have to know when the auth phase is done,</i></td></tr>
<tr><th id="764">764</th><td><i>                  but this variable will be set to true then */</i></td></tr>
<tr><th id="765">765</th><td></td></tr>
<tr><th id="766">766</th><td>    <b>if</b>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::newurl" title='connectdata::newurl' data-ref="connectdata::newurl">newurl</a>) {</td></tr>
<tr><th id="767">767</th><td>      <i>/* This only happens if we've looped here due to authentication reasons,</i></td></tr>
<tr><th id="768">768</th><td><i>         and we don't really use the newly cloned URL here then. Just free()</i></td></tr>
<tr><th id="769">769</th><td><i>         it. */</i></td></tr>
<tr><th id="770">770</th><td>      <a class="macro" href="memdebug.h.html#78" title="curl_dofree(conn-&gt;newurl, 770, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::newurl" title='connectdata::newurl' data-ref="connectdata::newurl">newurl</a>); </td></tr>
<tr><th id="771">771</th><td>      <a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::newurl" title='connectdata::newurl' data-ref="connectdata::newurl">newurl</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="772">772</th><td>    }</td></tr>
<tr><th id="773">773</th><td></td></tr>
<tr><th id="774">774</th><td>    <a class="local col9 ref" href="#99host_port" title='host_port' data-ref="99host_port">host_port</a> = <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"%s:%d"</q>, <a class="local col2 ref" href="#82hostname" title='hostname' data-ref="82hostname">hostname</a>, <a class="local col3 ref" href="#83remote_port" title='remote_port' data-ref="83remote_port">remote_port</a>);</td></tr>
<tr><th id="775">775</th><td>    <b>if</b>(!<a class="local col9 ref" href="#99host_port" title='host_port' data-ref="99host_port">host_port</a>)</td></tr>
<tr><th id="776">776</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="777">777</th><td></td></tr>
<tr><th id="778">778</th><td>    <i>/* Setup the proxy-authorization header, if any */</i></td></tr>
<tr><th id="779">779</th><td>    <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a> = <a class="tu ref" href="#http_auth_headers" title='http_auth_headers' data-use='c' data-ref="http_auth_headers">http_auth_headers</a>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>, (<em>char</em> *)<q>"CONNECT"</q>, <a class="local col9 ref" href="#99host_port" title='host_port' data-ref="99host_port">host_port</a>, &amp;<a class="local col2 ref" href="#102auth" title='auth' data-ref="102auth">auth</a>);</td></tr>
<tr><th id="780">780</th><td>    <b>if</b>(<a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a> == <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>) {</td></tr>
<tr><th id="781">781</th><td></td></tr>
<tr><th id="782">782</th><td>      <i>/* OK, now send the connect request to the proxy */</i></td></tr>
<tr><th id="783">783</th><td>      <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a> =</td></tr>
<tr><th id="784">784</th><td>        <a class="ref" href="sendf.h.html#Curl_sendf" title='Curl_sendf' data-ref="Curl_sendf">Curl_sendf</a>(<a class="local col0 ref" href="#100tunnelsocket" title='tunnelsocket' data-ref="100tunnelsocket">tunnelsocket</a>, <a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>,</td></tr>
<tr><th id="785">785</th><td>                   <q>"CONNECT %s:%d HTTP/1.0\015\012"</q></td></tr>
<tr><th id="786">786</th><td>                   <q>"%s"</q></td></tr>
<tr><th id="787">787</th><td>                   <q>"%s"</q></td></tr>
<tr><th id="788">788</th><td>                   <q>"\r\n"</q>,</td></tr>
<tr><th id="789">789</th><td>                   <a class="local col2 ref" href="#82hostname" title='hostname' data-ref="82hostname">hostname</a>, <a class="local col3 ref" href="#83remote_port" title='remote_port' data-ref="83remote_port">remote_port</a>,</td></tr>
<tr><th id="790">790</th><td>                   <a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::proxy_user_passwd" title='ConnectBits::proxy_user_passwd' data-ref="ConnectBits::proxy_user_passwd">proxy_user_passwd</a>?</td></tr>
<tr><th id="791">791</th><td>                   <a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::proxyuserpwd" title='dynamically_allocated_data::proxyuserpwd' data-ref="dynamically_allocated_data::proxyuserpwd">proxyuserpwd</a>:<q>""</q>,</td></tr>
<tr><th id="792">792</th><td>                   <a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::useragent" title='UserDefined::useragent' data-ref="UserDefined::useragent">useragent</a>?<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::uagent" title='dynamically_allocated_data::uagent' data-ref="dynamically_allocated_data::uagent">uagent</a>:<q>""</q></td></tr>
<tr><th id="793">793</th><td>                   );</td></tr>
<tr><th id="794">794</th><td>      <b>if</b>(<a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>)</td></tr>
<tr><th id="795">795</th><td>        <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <q>"Failed sending CONNECT to proxy"</q>);</td></tr>
<tr><th id="796">796</th><td>    }</td></tr>
<tr><th id="797">797</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(host_port, 797, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col9 ref" href="#99host_port" title='host_port' data-ref="99host_port">host_port</a>);</td></tr>
<tr><th id="798">798</th><td>    <b>if</b>(<a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>)</td></tr>
<tr><th id="799">799</th><td>      <b>return</b> <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>;</td></tr>
<tr><th id="800">800</th><td></td></tr>
<tr><th id="801">801</th><td>    <a class="macro" href="../../../include/x86_64-linux-gnu/sys/select.h.html#93" title="do { int __d0, __d1; __asm__ __volatile__ (&quot;cld; rep; &quot; &quot;stosq&quot; : &quot;=c&quot; (__d0), &quot;=D&quot; (__d1) : &quot;a&quot; (0), &quot;0&quot; (sizeof (fd_set) / sizeof (__fd_mask)), &quot;1&quot; (&amp;((&amp;readfd)-&gt;__fds_bits)[0]) : &quot;memory&quot;); } while (0)" data-ref="_M/FD_ZERO">FD_ZERO</a> (&amp;<a class="local col7 ref" href="#97readfd" title='readfd' data-ref="97readfd">readfd</a>);		<i>/* clear it */</i></td></tr>
<tr><th id="802">802</th><td>    <a class="macro" href="../../../include/x86_64-linux-gnu/sys/select.h.html#90" title="((void) (((&amp;readfd)-&gt;__fds_bits)[((tunnelsocket) / (8 * (int) sizeof (__fd_mask)))] |= ((__fd_mask) (1UL &lt;&lt; ((tunnelsocket) % (8 * (int) sizeof (__fd_mask)))))))" data-ref="_M/FD_SET">FD_SET</a> (<a class="local col0 ref" href="#100tunnelsocket" title='tunnelsocket' data-ref="100tunnelsocket">tunnelsocket</a>, &amp;<a class="local col7 ref" href="#97readfd" title='readfd' data-ref="97readfd">readfd</a>);     <i>/* read socket */</i></td></tr>
<tr><th id="803">803</th><td></td></tr>
<tr><th id="804">804</th><td>    <i>/* get this in a backup variable to be able to restore it on each lap in</i></td></tr>
<tr><th id="805">805</th><td><i>       the select() loop */</i></td></tr>
<tr><th id="806">806</th><td>    <a class="local col6 ref" href="#96rkeepfd" title='rkeepfd' data-ref="96rkeepfd">rkeepfd</a> = <a class="local col7 ref" href="#97readfd" title='readfd' data-ref="97readfd">readfd</a>;</td></tr>
<tr><th id="807">807</th><td></td></tr>
<tr><th id="808">808</th><td>    <a class="local col3 ref" href="#93ptr" title='ptr' data-ref="93ptr">ptr</a>=<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>;</td></tr>
<tr><th id="809">809</th><td>    <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a> = <a class="local col3 ref" href="#93ptr" title='ptr' data-ref="93ptr">ptr</a>;</td></tr>
<tr><th id="810">810</th><td></td></tr>
<tr><th id="811">811</th><td>    <a class="local col9 ref" href="#89nread" title='nread' data-ref="89nread">nread</a>=<var>0</var>;</td></tr>
<tr><th id="812">812</th><td>    <a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>=<var>0</var>;</td></tr>
<tr><th id="813">813</th><td>    <a class="local col1 ref" href="#91keepon" title='keepon' data-ref="91keepon">keepon</a>=<a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="814">814</th><td></td></tr>
<tr><th id="815">815</th><td>    <b>while</b>((<a class="local col9 ref" href="#89nread" title='nread' data-ref="89nread">nread</a>&lt;<a class="macro" href="urldata.h.html#104" title="16384" data-ref="_M/BUFSIZE">BUFSIZE</a>) &amp;&amp; (<a class="local col1 ref" href="#91keepon" title='keepon' data-ref="91keepon">keepon</a> &amp;&amp; !<a class="local col1 ref" href="#101error" title='error' data-ref="101error">error</a>)) {</td></tr>
<tr><th id="816">816</th><td>      <a class="local col7 ref" href="#97readfd" title='readfd' data-ref="97readfd">readfd</a> = <a class="local col6 ref" href="#96rkeepfd" title='rkeepfd' data-ref="96rkeepfd">rkeepfd</a>;     <i>/* set every lap */</i></td></tr>
<tr><th id="817">817</th><td>      <a class="local col5 ref" href="#95interval" title='interval' data-ref="95interval">interval</a>.<a class="ref" href="../../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a> = <var>1</var>;  <i>/* timeout each second and check the timeout */</i></td></tr>
<tr><th id="818">818</th><td>      <a class="local col5 ref" href="#95interval" title='interval' data-ref="95interval">interval</a>.<a class="ref" href="../../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a> = <var>0</var>;</td></tr>
<tr><th id="819">819</th><td></td></tr>
<tr><th id="820">820</th><td>      <b>if</b>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::timeout" title='UserDefined::timeout' data-ref="UserDefined::timeout">timeout</a>) {</td></tr>
<tr><th id="821">821</th><td>        <i>/* if timeout is requested, find out how much remaining time we have */</i></td></tr>
<tr><th id="822">822</th><td>        <a class="local col4 ref" href="#94timeout" title='timeout' data-ref="94timeout">timeout</a> = <a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::timeout" title='UserDefined::timeout' data-ref="UserDefined::timeout">timeout</a> - <i>/* timeout time */</i></td></tr>
<tr><th id="823">823</th><td>          <a class="ref" href="timeval.h.html#Curl_tvdiff" title='Curl_tvdiff' data-ref="Curl_tvdiff">Curl_tvdiff</a>(<a class="ref" href="timeval.h.html#Curl_tvnow" title='Curl_tvnow' data-ref="Curl_tvnow">Curl_tvnow</a>(), <a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::now" title='connectdata::now' data-ref="connectdata::now">now</a>)/<var>1000</var>; <i>/* spent time */</i></td></tr>
<tr><th id="824">824</th><td>        <b>if</b>(<a class="local col4 ref" href="#94timeout" title='timeout' data-ref="94timeout">timeout</a> &lt;=<var>0</var> ) {</td></tr>
<tr><th id="825">825</th><td>          <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <q>"Proxy connection aborted due to timeout"</q>);</td></tr>
<tr><th id="826">826</th><td>          <a class="local col1 ref" href="#101error" title='error' data-ref="101error">error</a> = <a class="macro" href="#757" title="2" data-ref="_M/SELECT_TIMEOUT">SELECT_TIMEOUT</a>; <i>/* already too little time */</i></td></tr>
<tr><th id="827">827</th><td>          <b>break</b>;</td></tr>
<tr><th id="828">828</th><td>        }</td></tr>
<tr><th id="829">829</th><td>      }</td></tr>
<tr><th id="830">830</th><td>      </td></tr>
<tr><th id="831">831</th><td>      <b>switch</b> (<a class="ref" href="../../../include/x86_64-linux-gnu/sys/select.h.html#select" title='select' data-ref="select">select</a> (<a class="local col0 ref" href="#100tunnelsocket" title='tunnelsocket' data-ref="100tunnelsocket">tunnelsocket</a>+<var>1</var>, &amp;<a class="local col7 ref" href="#97readfd" title='readfd' data-ref="97readfd">readfd</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, &amp;<a class="local col5 ref" href="#95interval" title='interval' data-ref="95interval">interval</a>)) {</td></tr>
<tr><th id="832">832</th><td>      <b>case</b> -<var>1</var>: <i>/* select() error, stop reading */</i></td></tr>
<tr><th id="833">833</th><td>        <a class="local col1 ref" href="#101error" title='error' data-ref="101error">error</a> = <a class="macro" href="#756" title="1" data-ref="_M/SELECT_ERROR">SELECT_ERROR</a>;</td></tr>
<tr><th id="834">834</th><td>        <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <q>"Proxy CONNECT aborted due to select() error"</q>);</td></tr>
<tr><th id="835">835</th><td>        <b>break</b>;</td></tr>
<tr><th id="836">836</th><td>      <b>case</b> <var>0</var>: <i>/* timeout */</i></td></tr>
<tr><th id="837">837</th><td>        <b>break</b>;</td></tr>
<tr><th id="838">838</th><td>      <b>default</b>:</td></tr>
<tr><th id="839">839</th><td>        <i>/*</i></td></tr>
<tr><th id="840">840</th><td><i>         * This code previously didn't use the kerberos sec_read() code</i></td></tr>
<tr><th id="841">841</th><td><i>         * to read, but when we use Curl_read() it may do so. Do confirm</i></td></tr>
<tr><th id="842">842</th><td><i>         * that this is still ok and then remove this comment!</i></td></tr>
<tr><th id="843">843</th><td><i>         */</i></td></tr>
<tr><th id="844">844</th><td>        <a class="local col8 ref" href="#88res" title='res' data-ref="88res">res</a>= <a class="ref" href="sendf.h.html#Curl_read" title='Curl_read' data-ref="Curl_read">Curl_read</a>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>, <a class="local col0 ref" href="#100tunnelsocket" title='tunnelsocket' data-ref="100tunnelsocket">tunnelsocket</a>, <a class="local col3 ref" href="#93ptr" title='ptr' data-ref="93ptr">ptr</a>, <a class="macro" href="urldata.h.html#104" title="16384" data-ref="_M/BUFSIZE">BUFSIZE</a>-<a class="local col9 ref" href="#89nread" title='nread' data-ref="89nread">nread</a>, &amp;<a class="local col2 ref" href="#92gotbytes" title='gotbytes' data-ref="92gotbytes">gotbytes</a>);</td></tr>
<tr><th id="845">845</th><td>        <b>if</b>(<a class="local col8 ref" href="#88res" title='res' data-ref="88res">res</a>&lt; <var>0</var>)</td></tr>
<tr><th id="846">846</th><td>          <i>/* EWOULDBLOCK */</i></td></tr>
<tr><th id="847">847</th><td>          <b>continue</b>; <i>/* go loop yourself */</i></td></tr>
<tr><th id="848">848</th><td>        <b>else</b> <b>if</b>(<a class="local col8 ref" href="#88res" title='res' data-ref="88res">res</a>)</td></tr>
<tr><th id="849">849</th><td>          <a class="local col1 ref" href="#91keepon" title='keepon' data-ref="91keepon">keepon</a> = <a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>;</td></tr>
<tr><th id="850">850</th><td>        <b>else</b> <b>if</b>(<a class="local col2 ref" href="#92gotbytes" title='gotbytes' data-ref="92gotbytes">gotbytes</a> &lt;= <var>0</var>) {</td></tr>
<tr><th id="851">851</th><td>          <a class="local col1 ref" href="#91keepon" title='keepon' data-ref="91keepon">keepon</a> = <a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>;</td></tr>
<tr><th id="852">852</th><td>          <a class="local col1 ref" href="#101error" title='error' data-ref="101error">error</a> = <a class="macro" href="#756" title="1" data-ref="_M/SELECT_ERROR">SELECT_ERROR</a>;</td></tr>
<tr><th id="853">853</th><td>          <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <q>"Proxy CONNECT aborted"</q>);</td></tr>
<tr><th id="854">854</th><td>        }</td></tr>
<tr><th id="855">855</th><td>        <b>else</b> {</td></tr>
<tr><th id="856">856</th><td>          <i>/*</i></td></tr>
<tr><th id="857">857</th><td><i>           * We got a whole chunk of data, which can be anything from one byte</i></td></tr>
<tr><th id="858">858</th><td><i>           * to a set of lines and possibly just a piece of the last line.</i></td></tr>
<tr><th id="859">859</th><td><i>           *</i></td></tr>
<tr><th id="860">860</th><td><i>           * TODO: To make this code work less error-prone, we need to make</i></td></tr>
<tr><th id="861">861</th><td><i>           * sure that we read and create full lines before we compare them,</i></td></tr>
<tr><th id="862">862</th><td><i>           * as there is really nothing that stops the proxy from delivering</i></td></tr>
<tr><th id="863">863</th><td><i>           * the response lines in multiple parts, each part consisting of</i></td></tr>
<tr><th id="864">864</th><td><i>           * only a little piece of the line(s).  */</i></td></tr>
<tr><th id="865">865</th><td>          <em>int</em> <dfn class="local col3 decl" id="103i" title='i' data-type='int' data-ref="103i">i</dfn>;</td></tr>
<tr><th id="866">866</th><td></td></tr>
<tr><th id="867">867</th><td>          <a class="local col9 ref" href="#89nread" title='nread' data-ref="89nread">nread</a> += <a class="local col2 ref" href="#92gotbytes" title='gotbytes' data-ref="92gotbytes">gotbytes</a>;</td></tr>
<tr><th id="868">868</th><td>          <b>for</b>(<a class="local col3 ref" href="#103i" title='i' data-ref="103i">i</a> = <var>0</var>; <a class="local col3 ref" href="#103i" title='i' data-ref="103i">i</a> &lt; <a class="local col2 ref" href="#92gotbytes" title='gotbytes' data-ref="92gotbytes">gotbytes</a>; <a class="local col3 ref" href="#93ptr" title='ptr' data-ref="93ptr">ptr</a>++, <a class="local col3 ref" href="#103i" title='i' data-ref="103i">i</a>++) {</td></tr>
<tr><th id="869">869</th><td>            <a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>++; <i>/* amount of bytes in this line so far */</i></td></tr>
<tr><th id="870">870</th><td>            <b>if</b>(*<a class="local col3 ref" href="#93ptr" title='ptr' data-ref="93ptr">ptr</a>==<kbd>'\n'</kbd>) {</td></tr>
<tr><th id="871">871</th><td>              <em>char</em> <dfn class="local col4 decl" id="104letter" title='letter' data-type='char' data-ref="104letter">letter</dfn>;</td></tr>
<tr><th id="872">872</th><td>              <em>int</em> <dfn class="local col5 decl" id="105writetype" title='writetype' data-type='int' data-ref="105writetype">writetype</dfn>;</td></tr>
<tr><th id="873">873</th><td>            </td></tr>
<tr><th id="874">874</th><td>              <i>/* output debug output if that is requested */</i></td></tr>
<tr><th id="875">875</th><td>              <b>if</b>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::verbose" title='UserDefined::verbose' data-ref="UserDefined::verbose">verbose</a>)</td></tr>
<tr><th id="876">876</th><td>                <a class="ref" href="sendf.h.html#Curl_debug" title='Curl_debug' data-ref="Curl_debug">Curl_debug</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <a class="enum" href="../include/curl/curl.h.html#CURLINFO_HEADER_IN" title='CURLINFO_HEADER_IN' data-ref="CURLINFO_HEADER_IN">CURLINFO_HEADER_IN</a>, <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>, <a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>);</td></tr>
<tr><th id="877">877</th><td></td></tr>
<tr><th id="878">878</th><td>              <i>/* send the header to the callback */</i></td></tr>
<tr><th id="879">879</th><td>              <a class="local col5 ref" href="#105writetype" title='writetype' data-ref="105writetype">writetype</a> = <a class="macro" href="sendf.h.html#35" title="2" data-ref="_M/CLIENTWRITE_HEADER">CLIENTWRITE_HEADER</a>;</td></tr>
<tr><th id="880">880</th><td>              <b>if</b>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="macro" href="urldata.h.html#860" title="include_header" data-ref="_M/http_include_header">http_include_header</a>)</td></tr>
<tr><th id="881">881</th><td>                <a class="local col5 ref" href="#105writetype" title='writetype' data-ref="105writetype">writetype</a> |= <a class="macro" href="sendf.h.html#34" title="1" data-ref="_M/CLIENTWRITE_BODY">CLIENTWRITE_BODY</a>;</td></tr>
<tr><th id="882">882</th><td></td></tr>
<tr><th id="883">883</th><td>              <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a> = <a class="ref" href="sendf.h.html#Curl_client_write" title='Curl_client_write' data-ref="Curl_client_write">Curl_client_write</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <a class="local col5 ref" href="#105writetype" title='writetype' data-ref="105writetype">writetype</a>, <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>, <a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>);</td></tr>
<tr><th id="884">884</th><td>              <b>if</b>(<a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>)</td></tr>
<tr><th id="885">885</th><td>                <b>return</b> <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>;</td></tr>
<tr><th id="886">886</th><td></td></tr>
<tr><th id="887">887</th><td>              <i>/* Newlines are CRLF, so the CR is ignored as the line isn't</i></td></tr>
<tr><th id="888">888</th><td><i>                 really terminated until the LF comes. Treat a following CR</i></td></tr>
<tr><th id="889">889</th><td><i>                 as end-of-headers as well.*/</i></td></tr>
<tr><th id="890">890</th><td></td></tr>
<tr><th id="891">891</th><td>              <b>if</b>((<kbd>'\r'</kbd> == <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>[<var>0</var>]) ||</td></tr>
<tr><th id="892">892</th><td>                 (<kbd>'\n'</kbd> == <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>[<var>0</var>])) {</td></tr>
<tr><th id="893">893</th><td>                <i>/* end of response-headers from the proxy */</i></td></tr>
<tr><th id="894">894</th><td>                <a class="local col1 ref" href="#91keepon" title='keepon' data-ref="91keepon">keepon</a>=<a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>;</td></tr>
<tr><th id="895">895</th><td>                <b>break</b>; <i>/* breaks out of for-loop, not switch() */</i></td></tr>
<tr><th id="896">896</th><td>              }</td></tr>
<tr><th id="897">897</th><td></td></tr>
<tr><th id="898">898</th><td>              <i>/* keep a backup of the position we are about to blank */</i></td></tr>
<tr><th id="899">899</th><td>              <a class="local col4 ref" href="#104letter" title='letter' data-ref="104letter">letter</a> = <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>[<a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>];</td></tr>
<tr><th id="900">900</th><td>              <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>[<a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>]=<var>0</var>; <i>/* zero terminate the buffer */</i></td></tr>
<tr><th id="901">901</th><td>              <b>if</b>((<a class="macro" href="strequal.h.html#37" title="curl_strnequal(&quot;WWW-Authenticate:&quot;,line_start,strlen(&quot;WWW-Authenticate:&quot;))" data-ref="_M/checkprefix">checkprefix</a>(<q>"WWW-Authenticate:"</q>, <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>) &amp;&amp;</td></tr>
<tr><th id="902">902</th><td>                  (<var>401</var> == <a class="local col4 ref" href="#84httpcode" title='httpcode' data-ref="84httpcode">httpcode</a>)) ||</td></tr>
<tr><th id="903">903</th><td>                 (<a class="macro" href="strequal.h.html#37" title="curl_strnequal(&quot;Proxy-authenticate:&quot;,line_start,strlen(&quot;Proxy-authenticate:&quot;))" data-ref="_M/checkprefix">checkprefix</a>(<q>"Proxy-authenticate:"</q>, <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>) &amp;&amp;</td></tr>
<tr><th id="904">904</th><td>                  (<var>407</var> == <a class="local col4 ref" href="#84httpcode" title='httpcode' data-ref="84httpcode">httpcode</a>))) {</td></tr>
<tr><th id="905">905</th><td>                <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a> = <a class="ref" href="#Curl_http_auth" title='Curl_http_auth' data-ref="Curl_http_auth">Curl_http_auth</a>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>, <a class="local col4 ref" href="#84httpcode" title='httpcode' data-ref="84httpcode">httpcode</a>, <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>);</td></tr>
<tr><th id="906">906</th><td>                <b>if</b>(<a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>)</td></tr>
<tr><th id="907">907</th><td>                  <b>return</b> <a class="local col7 ref" href="#87result" title='result' data-ref="87result">result</a>;</td></tr>
<tr><th id="908">908</th><td>              }</td></tr>
<tr><th id="909">909</th><td>              <b>else</b> <b>if</b>(<var>2</var> == <a class="ref" href="../../../include/stdio.h.html#__isoc99_sscanf" title='sscanf' data-ref="__isoc99_sscanf">sscanf</a>(<a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>, <q>"HTTP/1.%d %d"</q>,</td></tr>
<tr><th id="910">910</th><td>                                  &amp;<a class="local col5 ref" href="#85subversion" title='subversion' data-ref="85subversion">subversion</a>,</td></tr>
<tr><th id="911">911</th><td>                                  &amp;<a class="local col4 ref" href="#84httpcode" title='httpcode' data-ref="84httpcode">httpcode</a>)) {</td></tr>
<tr><th id="912">912</th><td>                <i>/* store the HTTP code */</i></td></tr>
<tr><th id="913">913</th><td>                <a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::info" title='SessionHandle::info' data-ref="SessionHandle::info">info</a>.<a class="ref" href="urldata.h.html#PureInfo::httpproxycode" title='PureInfo::httpproxycode' data-ref="PureInfo::httpproxycode">httpproxycode</a> = <a class="local col4 ref" href="#84httpcode" title='httpcode' data-ref="84httpcode">httpcode</a>;                </td></tr>
<tr><th id="914">914</th><td>              }</td></tr>
<tr><th id="915">915</th><td>              <i>/* put back the letter we blanked out before */</i></td></tr>
<tr><th id="916">916</th><td>              <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a>[<a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>]= <a class="local col4 ref" href="#104letter" title='letter' data-ref="104letter">letter</a>;</td></tr>
<tr><th id="917">917</th><td></td></tr>
<tr><th id="918">918</th><td>              <a class="local col0 ref" href="#90perline" title='perline' data-ref="90perline">perline</a>=<var>0</var>; <i>/* line starts over here */</i></td></tr>
<tr><th id="919">919</th><td>              <a class="local col8 ref" href="#98line_start" title='line_start' data-ref="98line_start">line_start</a> = <a class="local col3 ref" href="#93ptr" title='ptr' data-ref="93ptr">ptr</a>+<var>1</var>; <i>/* this skips the zero byte we wrote */</i></td></tr>
<tr><th id="920">920</th><td>            }</td></tr>
<tr><th id="921">921</th><td>          }</td></tr>
<tr><th id="922">922</th><td>        }</td></tr>
<tr><th id="923">923</th><td>        <b>break</b>;</td></tr>
<tr><th id="924">924</th><td>      } <i>/* switch */</i></td></tr>
<tr><th id="925">925</th><td>    } <i>/* while there's buffer left and loop is requested */</i></td></tr>
<tr><th id="926">926</th><td></td></tr>
<tr><th id="927">927</th><td>    <b>if</b>(<a class="local col1 ref" href="#101error" title='error' data-ref="101error">error</a>)</td></tr>
<tr><th id="928">928</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_RECV_ERROR" title='CURLE_RECV_ERROR' data-ref="CURLE_RECV_ERROR">CURLE_RECV_ERROR</a>;</td></tr>
<tr><th id="929">929</th><td></td></tr>
<tr><th id="930">930</th><td>    <i>/* Deal with the possibly already received authenticate headers. 'newurl'</i></td></tr>
<tr><th id="931">931</th><td><i>       is set to a new URL if we must loop. */</i></td></tr>
<tr><th id="932">932</th><td>    <a class="ref" href="#Curl_http_auth_act" title='Curl_http_auth_act' data-ref="Curl_http_auth_act">Curl_http_auth_act</a>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>);</td></tr>
<tr><th id="933">933</th><td>  </td></tr>
<tr><th id="934">934</th><td>  } <b>while</b>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::newurl" title='connectdata::newurl' data-ref="connectdata::newurl">newurl</a>);</td></tr>
<tr><th id="935">935</th><td></td></tr>
<tr><th id="936">936</th><td>  <b>if</b>(<var>200</var> != <a class="local col4 ref" href="#84httpcode" title='httpcode' data-ref="84httpcode">httpcode</a>) {</td></tr>
<tr><th id="937">937</th><td>    <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <q>"Received HTTP code %d from proxy after CONNECT"</q>, <a class="local col4 ref" href="#84httpcode" title='httpcode' data-ref="84httpcode">httpcode</a>);</td></tr>
<tr><th id="938">938</th><td>    <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_RECV_ERROR" title='CURLE_RECV_ERROR' data-ref="CURLE_RECV_ERROR">CURLE_RECV_ERROR</a>;</td></tr>
<tr><th id="939">939</th><td>  }</td></tr>
<tr><th id="940">940</th><td>  </td></tr>
<tr><th id="941">941</th><td>  <i>/* If a proxy-authorization header was used for the proxy, then we should</i></td></tr>
<tr><th id="942">942</th><td><i>     make sure that it isn't accidentally used for the document request</i></td></tr>
<tr><th id="943">943</th><td><i>     after we've connected. So let's free and clear it here. */</i></td></tr>
<tr><th id="944">944</th><td>  <a class="ref" href="url.h.html#Curl_safefree" title='Curl_safefree' data-ref="Curl_safefree">Curl_safefree</a>(<a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::proxyuserpwd" title='dynamically_allocated_data::proxyuserpwd' data-ref="dynamically_allocated_data::proxyuserpwd">proxyuserpwd</a>);</td></tr>
<tr><th id="945">945</th><td>  <a class="local col0 ref" href="#80conn" title='conn' data-ref="80conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::proxyuserpwd" title='dynamically_allocated_data::proxyuserpwd' data-ref="dynamically_allocated_data::proxyuserpwd">proxyuserpwd</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="946">946</th><td></td></tr>
<tr><th id="947">947</th><td>  <a class="ref" href="#Curl_http_auth_stage" title='Curl_http_auth_stage' data-ref="Curl_http_auth_stage">Curl_http_auth_stage</a>(<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <var>401</var>); <i>/* move on to the host auth */</i></td></tr>
<tr><th id="948">948</th><td></td></tr>
<tr><th id="949">949</th><td>  <a class="macro" href="sendf.h.html#31" title="Curl_infof" data-ref="_M/infof">infof</a> (<a class="local col6 ref" href="#86data" title='data' data-ref="86data">data</a>, <q>"Proxy replied OK to CONNECT request\n"</q>);</td></tr>
<tr><th id="950">950</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="951">951</th><td>}</td></tr>
<tr><th id="952">952</th><td></td></tr>
<tr><th id="953">953</th><td><i>/*</i></td></tr>
<tr><th id="954">954</th><td><i> * HTTP stuff to do at connect-time.</i></td></tr>
<tr><th id="955">955</th><td><i> */</i></td></tr>
<tr><th id="956">956</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="decl def" id="Curl_http_connect" title='Curl_http_connect' data-ref="Curl_http_connect">Curl_http_connect</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col6 decl" id="106conn" title='conn' data-type='struct connectdata *' data-ref="106conn">conn</dfn>)</td></tr>
<tr><th id="957">957</th><td>{</td></tr>
<tr><th id="958">958</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col7 decl" id="107data" title='data' data-type='struct SessionHandle *' data-ref="107data">data</dfn>;</td></tr>
<tr><th id="959">959</th><td>  <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="local col8 decl" id="108result" title='result' data-type='CURLcode' data-ref="108result">result</dfn>;</td></tr>
<tr><th id="960">960</th><td></td></tr>
<tr><th id="961">961</th><td>  <a class="local col7 ref" href="#107data" title='data' data-ref="107data">data</a>=<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="962">962</th><td></td></tr>
<tr><th id="963">963</th><td>  <i>/* If we are not using a proxy and we want a secure connection,</i></td></tr>
<tr><th id="964">964</th><td><i>   * perform SSL initialization &amp; connection now.</i></td></tr>
<tr><th id="965">965</th><td><i>   * If using a proxy with https, then we must tell the proxy to CONNECT</i></td></tr>
<tr><th id="966">966</th><td><i>   * us to the host we want to talk to.  Only after the connect</i></td></tr>
<tr><th id="967">967</th><td><i>   * has occured, can we start talking SSL</i></td></tr>
<tr><th id="968">968</th><td><i>   */</i></td></tr>
<tr><th id="969">969</th><td></td></tr>
<tr><th id="970">970</th><td>  <b>if</b>(<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::httpproxy" title='ConnectBits::httpproxy' data-ref="ConnectBits::httpproxy">httpproxy</a> &amp;&amp;</td></tr>
<tr><th id="971">971</th><td>     ((<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a> &amp; <a class="macro" href="urldata.h.html#411" title="(1&lt;&lt;3)" data-ref="_M/PROT_HTTPS">PROT_HTTPS</a>) || <a class="local col7 ref" href="#107data" title='data' data-ref="107data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::tunnel_thru_httpproxy" title='UserDefined::tunnel_thru_httpproxy' data-ref="UserDefined::tunnel_thru_httpproxy">tunnel_thru_httpproxy</a>)) {</td></tr>
<tr><th id="972">972</th><td></td></tr>
<tr><th id="973">973</th><td>    <i>/* either HTTPS over proxy, OR explicitly asked for a tunnel */</i></td></tr>
<tr><th id="974">974</th><td>    <a class="local col8 ref" href="#108result" title='result' data-ref="108result">result</a> = <a class="ref" href="#Curl_ConnectHTTPProxyTunnel" title='Curl_ConnectHTTPProxyTunnel' data-ref="Curl_ConnectHTTPProxyTunnel">Curl_ConnectHTTPProxyTunnel</a>(<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>, <a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>,</td></tr>
<tr><th id="975">975</th><td>                                         <a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::hostname" title='connectdata::hostname' data-ref="connectdata::hostname">hostname</a>, <a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::remote_port" title='connectdata::remote_port' data-ref="connectdata::remote_port">remote_port</a>);</td></tr>
<tr><th id="976">976</th><td>    <b>if</b>(<a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a> != <a class="local col8 ref" href="#108result" title='result' data-ref="108result">result</a>)</td></tr>
<tr><th id="977">977</th><td>      <b>return</b> <a class="local col8 ref" href="#108result" title='result' data-ref="108result">result</a>;</td></tr>
<tr><th id="978">978</th><td>  }    </td></tr>
<tr><th id="979">979</th><td></td></tr>
<tr><th id="980">980</th><td>  <b>if</b>(<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a> &amp; <a class="macro" href="urldata.h.html#411" title="(1&lt;&lt;3)" data-ref="_M/PROT_HTTPS">PROT_HTTPS</a>) {</td></tr>
<tr><th id="981">981</th><td>    <i>/* now, perform the SSL initialization for this socket */</i></td></tr>
<tr><th id="982">982</th><td>    <a class="local col8 ref" href="#108result" title='result' data-ref="108result">result</a> = <a class="ref" href="ssluse.h.html#Curl_SSLConnect" title='Curl_SSLConnect' data-ref="Curl_SSLConnect">Curl_SSLConnect</a>(<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>, <a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>);</td></tr>
<tr><th id="983">983</th><td>    <b>if</b>(<a class="local col8 ref" href="#108result" title='result' data-ref="108result">result</a>)</td></tr>
<tr><th id="984">984</th><td>      <b>return</b> <a class="local col8 ref" href="#108result" title='result' data-ref="108result">result</a>;</td></tr>
<tr><th id="985">985</th><td>  }</td></tr>
<tr><th id="986">986</th><td></td></tr>
<tr><th id="987">987</th><td>  <b>if</b>(<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::user_passwd" title='ConnectBits::user_passwd' data-ref="ConnectBits::user_passwd">user_passwd</a> &amp;&amp; !<a class="local col7 ref" href="#107data" title='data' data-ref="107data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::this_is_a_follow" title='UrlState::this_is_a_follow' data-ref="UrlState::this_is_a_follow">this_is_a_follow</a>) {</td></tr>
<tr><th id="988">988</th><td>    <i>/* Authorization: is requested, this is not a followed location, get the</i></td></tr>
<tr><th id="989">989</th><td><i>       original host name */</i></td></tr>
<tr><th id="990">990</th><td>    <b>if</b> (<a class="local col7 ref" href="#107data" title='data' data-ref="107data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::auth_host" title='UrlState::auth_host' data-ref="UrlState::auth_host">auth_host</a>)</td></tr>
<tr><th id="991">991</th><td>      <i>/* Free to avoid leaking memory on multiple requests*/</i></td></tr>
<tr><th id="992">992</th><td>      <a class="macro" href="memdebug.h.html#78" title="curl_dofree(data-&gt;state.auth_host, 992, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col7 ref" href="#107data" title='data' data-ref="107data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::auth_host" title='UrlState::auth_host' data-ref="UrlState::auth_host">auth_host</a>);</td></tr>
<tr><th id="993">993</th><td></td></tr>
<tr><th id="994">994</th><td>    <a class="local col7 ref" href="#107data" title='data' data-ref="107data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::auth_host" title='UrlState::auth_host' data-ref="UrlState::auth_host">auth_host</a> = <a class="macro" href="memdebug.h.html#74" title="curl_dostrdup(conn-&gt;hostname, 994, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/strdup">strdup</a>(<a class="local col6 ref" href="#106conn" title='conn' data-ref="106conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::hostname" title='connectdata::hostname' data-ref="connectdata::hostname">hostname</a>);</td></tr>
<tr><th id="995">995</th><td>  }</td></tr>
<tr><th id="996">996</th><td></td></tr>
<tr><th id="997">997</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="998">998</th><td>}</td></tr>
<tr><th id="999">999</th><td></td></tr>
<tr><th id="1000">1000</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="decl def" id="Curl_http_done" title='Curl_http_done' data-ref="Curl_http_done">Curl_http_done</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col9 decl" id="109conn" title='conn' data-type='struct connectdata *' data-ref="109conn">conn</dfn>)</td></tr>
<tr><th id="1001">1001</th><td>{</td></tr>
<tr><th id="1002">1002</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col0 decl" id="110data" title='data' data-type='struct SessionHandle *' data-ref="110data">data</dfn>;</td></tr>
<tr><th id="1003">1003</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#HTTP" title='HTTP' data-ref="HTTP">HTTP</a> *<dfn class="local col1 decl" id="111http" title='http' data-type='struct HTTP *' data-ref="111http">http</dfn>;</td></tr>
<tr><th id="1004">1004</th><td></td></tr>
<tr><th id="1005">1005</th><td>  <a class="local col0 ref" href="#110data" title='data' data-ref="110data">data</a>=<a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="1006">1006</th><td>  <a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>=<a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proto" title='connectdata::proto' data-ref="connectdata::proto">proto</a>.<a class="ref" href="urldata.h.html#connectdata::(anonymous)::http" title='connectdata::(anonymous union)::http' data-ref="connectdata::(anonymous)::http">http</a>;</td></tr>
<tr><th id="1007">1007</th><td></td></tr>
<tr><th id="1008">1008</th><td>  <i>/* set the proper values (possibly modified on POST) */</i></td></tr>
<tr><th id="1009">1009</th><td>  <a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread" title='connectdata::fread' data-ref="connectdata::fread">fread</a> = <a class="local col0 ref" href="#110data" title='data' data-ref="110data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::fread" title='UserDefined::fread' data-ref="UserDefined::fread">fread</a>; <i>/* restore */</i></td></tr>
<tr><th id="1010">1010</th><td>  <a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread_in" title='connectdata::fread_in' data-ref="connectdata::fread_in">fread_in</a> = <a class="local col0 ref" href="#110data" title='data' data-ref="110data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::in" title='UserDefined::in' data-ref="UserDefined::in">in</a>; <i>/* restore */</i></td></tr>
<tr><th id="1011">1011</th><td></td></tr>
<tr><th id="1012">1012</th><td>  <b>if</b> (<a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) </td></tr>
<tr><th id="1013">1013</th><td>    <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="1014">1014</th><td></td></tr>
<tr><th id="1015">1015</th><td>  <b>if</b>(<a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::send_buffer" title='HTTP::send_buffer' data-ref="HTTP::send_buffer">send_buffer</a>) {</td></tr>
<tr><th id="1016">1016</th><td>    <a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="local col2 decl" id="112buff" title='buff' data-type='send_buffer *' data-ref="112buff">buff</dfn> = <a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::send_buffer" title='HTTP::send_buffer' data-ref="HTTP::send_buffer">send_buffer</a>;</td></tr>
<tr><th id="1017">1017</th><td>    </td></tr>
<tr><th id="1018">1018</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(buff-&gt;buffer, 1018, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col2 ref" href="#112buff" title='buff' data-ref="112buff">buff</a>-&gt;<a class="tu ref" href="#send_buffer::buffer" title='send_buffer::buffer' data-use='r' data-ref="send_buffer::buffer">buffer</a>);</td></tr>
<tr><th id="1019">1019</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(buff, 1019, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col2 ref" href="#112buff" title='buff' data-ref="112buff">buff</a>);</td></tr>
<tr><th id="1020">1020</th><td>    <a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::send_buffer" title='HTTP::send_buffer' data-ref="HTTP::send_buffer">send_buffer</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* cleaer the pointer */</i></td></tr>
<tr><th id="1021">1021</th><td>  }</td></tr>
<tr><th id="1022">1022</th><td></td></tr>
<tr><th id="1023">1023</th><td>  <b>if</b>(<a class="enum" href="urldata.h.html#HTTPREQ_POST_FORM" title='HTTPREQ_POST_FORM' data-ref="HTTPREQ_POST_FORM">HTTPREQ_POST_FORM</a> == <a class="local col0 ref" href="#110data" title='data' data-ref="110data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>) {</td></tr>
<tr><th id="1024">1024</th><td>    <a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bytecount" title='connectdata::bytecount' data-ref="connectdata::bytecount">bytecount</a> = <a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::readbytecount" title='HTTP::readbytecount' data-ref="HTTP::readbytecount">readbytecount</a> + <a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::writebytecount" title='HTTP::writebytecount' data-ref="HTTP::writebytecount">writebytecount</a>;</td></tr>
<tr><th id="1025">1025</th><td>      </td></tr>
<tr><th id="1026">1026</th><td>    <a class="ref" href="formdata.h.html#Curl_formclean" title='Curl_formclean' data-ref="Curl_formclean">Curl_formclean</a>(<a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sendit" title='HTTP::sendit' data-ref="HTTP::sendit">sendit</a>); <i>/* Now free that whole lot */</i></td></tr>
<tr><th id="1027">1027</th><td>  }</td></tr>
<tr><th id="1028">1028</th><td>  <b>else</b> <b>if</b>(<a class="enum" href="urldata.h.html#HTTPREQ_PUT" title='HTTPREQ_PUT' data-ref="HTTPREQ_PUT">HTTPREQ_PUT</a> == <a class="local col0 ref" href="#110data" title='data' data-ref="110data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>)</td></tr>
<tr><th id="1029">1029</th><td>    <a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bytecount" title='connectdata::bytecount' data-ref="connectdata::bytecount">bytecount</a> = <a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::readbytecount" title='HTTP::readbytecount' data-ref="HTTP::readbytecount">readbytecount</a> + <a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::writebytecount" title='HTTP::writebytecount' data-ref="HTTP::writebytecount">writebytecount</a>;</td></tr>
<tr><th id="1030">1030</th><td></td></tr>
<tr><th id="1031">1031</th><td>  <b>if</b>(!<a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::retry" title='ConnectBits::retry' data-ref="ConnectBits::retry">retry</a> &amp;&amp;</td></tr>
<tr><th id="1032">1032</th><td>     !(<a class="local col1 ref" href="#111http" title='http' data-ref="111http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::readbytecount" title='HTTP::readbytecount' data-ref="HTTP::readbytecount">readbytecount</a> + <a class="local col9 ref" href="#109conn" title='conn' data-ref="109conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::headerbytecount" title='connectdata::headerbytecount' data-ref="connectdata::headerbytecount">headerbytecount</a>)) {</td></tr>
<tr><th id="1033">1033</th><td>    <i>/* If this connection isn't simply closed to be retried, AND nothing was</i></td></tr>
<tr><th id="1034">1034</th><td><i>       read from the HTTP server, this can't be right so we return an error</i></td></tr>
<tr><th id="1035">1035</th><td><i>       here */</i></td></tr>
<tr><th id="1036">1036</th><td>    <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col0 ref" href="#110data" title='data' data-ref="110data">data</a>, <q>"Empty reply from server"</q>);</td></tr>
<tr><th id="1037">1037</th><td>    <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_GOT_NOTHING" title='CURLE_GOT_NOTHING' data-ref="CURLE_GOT_NOTHING">CURLE_GOT_NOTHING</a>;</td></tr>
<tr><th id="1038">1038</th><td>  }</td></tr>
<tr><th id="1039">1039</th><td></td></tr>
<tr><th id="1040">1040</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="1041">1041</th><td>}</td></tr>
<tr><th id="1042">1042</th><td></td></tr>
<tr><th id="1043">1043</th><td><em>void</em> <dfn class="decl def" id="Curl_http_auth_stage" title='Curl_http_auth_stage' data-ref="Curl_http_auth_stage">Curl_http_auth_stage</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col3 decl" id="113data" title='data' data-type='struct SessionHandle *' data-ref="113data">data</dfn>,</td></tr>
<tr><th id="1044">1044</th><td>                          <em>int</em> <dfn class="local col4 decl" id="114stage" title='stage' data-type='int' data-ref="114stage">stage</dfn>)</td></tr>
<tr><th id="1045">1045</th><td>{</td></tr>
<tr><th id="1046">1046</th><td>  <a class="macro" href="setup.h.html#146" title="(((stage == 401) || (stage == 407)) ? (void) (0) : __assert_fail (&quot;(stage == 401) || (stage == 407)&quot;, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;, 1046, __PRETTY_FUNCTION__))" data-ref="_M/curlassert">curlassert</a>((<a class="local col4 ref" href="#114stage" title='stage' data-ref="114stage">stage</a> == <var>401</var>) || (<a class="local col4 ref" href="#114stage" title='stage' data-ref="114stage">stage</a> == <var>407</var>));</td></tr>
<tr><th id="1047">1047</th><td></td></tr>
<tr><th id="1048">1048</th><td>  <i>/* We set none, one or more bits for which authentication types we accept</i></td></tr>
<tr><th id="1049">1049</th><td><i>     for this stage. */</i></td></tr>
<tr><th id="1050">1050</th><td>  <a class="local col3 ref" href="#113data" title='data' data-ref="113data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authwant" title='UrlState::authwant' data-ref="UrlState::authwant">authwant</a> = (<a class="local col4 ref" href="#114stage" title='stage' data-ref="114stage">stage</a> == <var>401</var>)?</td></tr>
<tr><th id="1051">1051</th><td>    <a class="local col3 ref" href="#113data" title='data' data-ref="113data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpauth" title='UserDefined::httpauth' data-ref="UserDefined::httpauth">httpauth</a>:<a class="local col3 ref" href="#113data" title='data' data-ref="113data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::proxyauth" title='UserDefined::proxyauth' data-ref="UserDefined::proxyauth">proxyauth</a>;</td></tr>
<tr><th id="1052">1052</th><td></td></tr>
<tr><th id="1053">1053</th><td>  <a class="local col3 ref" href="#113data" title='data' data-ref="113data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authstage" title='UrlState::authstage' data-ref="UrlState::authstage">authstage</a> = <a class="local col4 ref" href="#114stage" title='stage' data-ref="114stage">stage</a>;</td></tr>
<tr><th id="1054">1054</th><td>  <a class="local col3 ref" href="#113data" title='data' data-ref="113data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::authavail" title='UrlState::authavail' data-ref="UrlState::authavail">authavail</a> = <a class="macro" href="../include/curl/curl.h.html#295" title="0" data-ref="_M/CURLAUTH_NONE">CURLAUTH_NONE</a>; <i>/* no type available yet */</i></td></tr>
<tr><th id="1055">1055</th><td>}</td></tr>
<tr><th id="1056">1056</th><td></td></tr>
<tr><th id="1057">1057</th><td><a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="decl def" id="Curl_http" title='Curl_http' data-ref="Curl_http">Curl_http</dfn>(<b>struct</b> <a class="type" href="urldata.h.html#connectdata" title='connectdata' data-ref="connectdata">connectdata</a> *<dfn class="local col5 decl" id="115conn" title='conn' data-type='struct connectdata *' data-ref="115conn">conn</dfn>)</td></tr>
<tr><th id="1058">1058</th><td>{</td></tr>
<tr><th id="1059">1059</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#SessionHandle" title='SessionHandle' data-ref="SessionHandle">SessionHandle</a> *<dfn class="local col6 decl" id="116data" title='data' data-type='struct SessionHandle *' data-ref="116data">data</dfn>=<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::data" title='connectdata::data' data-ref="connectdata::data">data</a>;</td></tr>
<tr><th id="1060">1060</th><td>  <em>char</em> *<dfn class="local col7 decl" id="117buf" title='buf' data-type='char *' data-ref="117buf">buf</dfn> = <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>; <i>/* this is a short cut to the buffer */</i></td></tr>
<tr><th id="1061">1061</th><td>  <a class="typedef" href="../include/curl/curl.h.html#CURLcode" title='CURLcode' data-type='enum CURLcode' data-ref="CURLcode">CURLcode</a> <dfn class="local col8 decl" id="118result" title='result' data-type='CURLcode' data-ref="118result">result</dfn>=<a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="1062">1062</th><td>  <b>struct</b> <a class="type" href="urldata.h.html#HTTP" title='HTTP' data-ref="HTTP">HTTP</a> *<dfn class="local col9 decl" id="119http" title='http' data-type='struct HTTP *' data-ref="119http">http</dfn>;</td></tr>
<tr><th id="1063">1063</th><td>  <b>struct</b> <a class="type" href="cookie.h.html#Cookie" title='Cookie' data-ref="Cookie">Cookie</a> *<dfn class="local col0 decl" id="120co" title='co' data-type='struct Cookie *' data-ref="120co">co</dfn>=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* no cookies from start */</i></td></tr>
<tr><th id="1064">1064</th><td>  <em>char</em> *<dfn class="local col1 decl" id="121ppath" title='ppath' data-type='char *' data-ref="121ppath">ppath</dfn> = <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::ppath" title='connectdata::ppath' data-ref="connectdata::ppath">ppath</a>; <i>/* three previous function arguments */</i></td></tr>
<tr><th id="1065">1065</th><td>  <em>char</em> *<dfn class="local col2 decl" id="122host" title='host' data-type='char *' data-ref="122host">host</dfn> = <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::name" title='connectdata::name' data-ref="connectdata::name">name</a>;</td></tr>
<tr><th id="1066">1066</th><td>  <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="123te" title='te' data-type='const char *' data-ref="123te">te</dfn> = <q>""</q>; <i>/* tranfer-encoding */</i></td></tr>
<tr><th id="1067">1067</th><td>  <em>char</em> *<dfn class="local col4 decl" id="124ptr" title='ptr' data-type='char *' data-ref="124ptr">ptr</dfn>;</td></tr>
<tr><th id="1068">1068</th><td>  <em>char</em> *<dfn class="local col5 decl" id="125request" title='request' data-type='char *' data-ref="125request">request</dfn>;</td></tr>
<tr><th id="1069">1069</th><td>  <a class="typedef" href="setup.h.html#bool" title='bool' data-type='unsigned char' data-ref="bool">bool</a> <dfn class="local col6 decl" id="126authdone" title='authdone' data-type='bool' data-ref="126authdone">authdone</dfn>=<a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>; <i>/* if the authentication phase is done */</i></td></tr>
<tr><th id="1070">1070</th><td></td></tr>
<tr><th id="1071">1071</th><td>  <b>if</b>(!<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proto" title='connectdata::proto' data-ref="connectdata::proto">proto</a>.<a class="ref" href="urldata.h.html#connectdata::(anonymous)::http" title='connectdata::(anonymous union)::http' data-ref="connectdata::(anonymous)::http">http</a>) {</td></tr>
<tr><th id="1072">1072</th><td>    <i>/* Only allocate this struct if we don't already have it! */</i></td></tr>
<tr><th id="1073">1073</th><td></td></tr>
<tr><th id="1074">1074</th><td>    <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a> = (<b>struct</b> <a class="type" href="urldata.h.html#HTTP" title='HTTP' data-ref="HTTP">HTTP</a> *)<a class="macro" href="memdebug.h.html#75" title="curl_domalloc(sizeof(struct HTTP), 1074, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/malloc">malloc</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="urldata.h.html#HTTP" title='HTTP' data-ref="HTTP">HTTP</a>));</td></tr>
<tr><th id="1075">1075</th><td>    <b>if</b>(!<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>)</td></tr>
<tr><th id="1076">1076</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="1077">1077</th><td>    <a class="ref" href="../../../include/string.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>, <var>0</var>, <b>sizeof</b>(<b>struct</b> <a class="type" href="urldata.h.html#HTTP" title='HTTP' data-ref="HTTP">HTTP</a>));</td></tr>
<tr><th id="1078">1078</th><td>    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proto" title='connectdata::proto' data-ref="connectdata::proto">proto</a>.<a class="ref" href="urldata.h.html#connectdata::(anonymous)::http" title='connectdata::(anonymous union)::http' data-ref="connectdata::(anonymous)::http">http</a> = <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>;</td></tr>
<tr><th id="1079">1079</th><td>  }</td></tr>
<tr><th id="1080">1080</th><td>  <b>else</b></td></tr>
<tr><th id="1081">1081</th><td>    <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a> = <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::proto" title='connectdata::proto' data-ref="connectdata::proto">proto</a>.<a class="ref" href="urldata.h.html#connectdata::(anonymous)::http" title='connectdata::(anonymous union)::http' data-ref="connectdata::(anonymous)::http">http</a>;</td></tr>
<tr><th id="1082">1082</th><td></td></tr>
<tr><th id="1083">1083</th><td>  <i>/* We default to persistant connections */</i></td></tr>
<tr><th id="1084">1084</th><td>  <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::close" title='ConnectBits::close' data-ref="ConnectBits::close">close</a> = <a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>;</td></tr>
<tr><th id="1085">1085</th><td></td></tr>
<tr><th id="1086">1086</th><td>  <b>if</b> ( (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a>&amp;(<a class="macro" href="urldata.h.html#410" title="(1&lt;&lt;2)" data-ref="_M/PROT_HTTP">PROT_HTTP</a>|<a class="macro" href="urldata.h.html#412" title="(1&lt;&lt;4)" data-ref="_M/PROT_FTP">PROT_FTP</a>)) &amp;&amp;</td></tr>
<tr><th id="1087">1087</th><td>       <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::upload" title='UserDefined::upload' data-ref="UserDefined::upload">upload</a>) {</td></tr>
<tr><th id="1088">1088</th><td>    <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a> = <a class="enum" href="urldata.h.html#HTTPREQ_PUT" title='HTTPREQ_PUT' data-ref="HTTPREQ_PUT">HTTPREQ_PUT</a>;</td></tr>
<tr><th id="1089">1089</th><td>  }</td></tr>
<tr><th id="1090">1090</th><td></td></tr>
<tr><th id="1091">1091</th><td>  <a class="local col5 ref" href="#125request" title='request' data-ref="125request">request</a> = <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::customrequest" title='UserDefined::customrequest' data-ref="UserDefined::customrequest">customrequest</a>?</td></tr>
<tr><th id="1092">1092</th><td>    <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::customrequest" title='UserDefined::customrequest' data-ref="UserDefined::customrequest">customrequest</a>:</td></tr>
<tr><th id="1093">1093</th><td>    (<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::no_body" title='UserDefined::no_body' data-ref="UserDefined::no_body">no_body</a>?(<em>char</em> *)<q>"HEAD"</q>:</td></tr>
<tr><th id="1094">1094</th><td>     ((<a class="enum" href="urldata.h.html#HTTPREQ_POST" title='HTTPREQ_POST' data-ref="HTTPREQ_POST">HTTPREQ_POST</a> == <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>) ||</td></tr>
<tr><th id="1095">1095</th><td>      (<a class="enum" href="urldata.h.html#HTTPREQ_POST_FORM" title='HTTPREQ_POST_FORM' data-ref="HTTPREQ_POST_FORM">HTTPREQ_POST_FORM</a> == <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>))?(<em>char</em> *)<q>"POST"</q>:</td></tr>
<tr><th id="1096">1096</th><td>     (<a class="enum" href="urldata.h.html#HTTPREQ_PUT" title='HTTPREQ_PUT' data-ref="HTTPREQ_PUT">HTTPREQ_PUT</a> == <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>)?(<em>char</em> *)<q>"PUT"</q>:(<em>char</em> *)<q>"GET"</q>);</td></tr>
<tr><th id="1097">1097</th><td>  </td></tr>
<tr><th id="1098">1098</th><td>  <i>/* The User-Agent string has been built in url.c already, because it might</i></td></tr>
<tr><th id="1099">1099</th><td><i>     have been used in the proxy connect, but if we have got a header with</i></td></tr>
<tr><th id="1100">1100</th><td><i>     the user-agent string specified, we erase the previously made string</i></td></tr>
<tr><th id="1101">1101</th><td><i>     here. */</i></td></tr>
<tr><th id="1102">1102</th><td>  <b>if</b>(<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"User-Agent:"</q>) &amp;&amp; <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::uagent" title='dynamically_allocated_data::uagent' data-ref="dynamically_allocated_data::uagent">uagent</a>) {</td></tr>
<tr><th id="1103">1103</th><td>    <a class="macro" href="memdebug.h.html#78" title="curl_dofree(conn-&gt;allocptr.uagent, 1103, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::uagent" title='dynamically_allocated_data::uagent' data-ref="dynamically_allocated_data::uagent">uagent</a>);</td></tr>
<tr><th id="1104">1104</th><td>    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::uagent" title='dynamically_allocated_data::uagent' data-ref="dynamically_allocated_data::uagent">uagent</a>=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1105">1105</th><td>  }</td></tr>
<tr><th id="1106">1106</th><td></td></tr>
<tr><th id="1107">1107</th><td>  <i>/* setup the authentication headers */</i></td></tr>
<tr><th id="1108">1108</th><td>  <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="tu ref" href="#http_auth_headers" title='http_auth_headers' data-use='c' data-ref="http_auth_headers">http_auth_headers</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>, <a class="local col5 ref" href="#125request" title='request' data-ref="125request">request</a>, <a class="local col1 ref" href="#121ppath" title='ppath' data-ref="121ppath">ppath</a>, &amp;<a class="local col6 ref" href="#126authdone" title='authdone' data-ref="126authdone">authdone</a>);</td></tr>
<tr><th id="1109">1109</th><td>  <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1110">1110</th><td>    <b>return</b> <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>;</td></tr>
<tr><th id="1111">1111</th><td></td></tr>
<tr><th id="1112">1112</th><td>  <a class="ref" href="url.h.html#Curl_safefree" title='Curl_safefree' data-ref="Curl_safefree">Curl_safefree</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::ref" title='dynamically_allocated_data::ref' data-ref="dynamically_allocated_data::ref">ref</a>);</td></tr>
<tr><th id="1113">1113</th><td>  <b>if</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::change" title='SessionHandle::change' data-ref="SessionHandle::change">change</a>.<a class="ref" href="urldata.h.html#DynamicStatic::referer" title='DynamicStatic::referer' data-ref="DynamicStatic::referer">referer</a> &amp;&amp; !<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Referer:"</q>))</td></tr>
<tr><th id="1114">1114</th><td>    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::ref" title='dynamically_allocated_data::ref' data-ref="dynamically_allocated_data::ref">ref</a> = <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Referer: %s\015\012"</q>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::change" title='SessionHandle::change' data-ref="SessionHandle::change">change</a>.<a class="ref" href="urldata.h.html#DynamicStatic::referer" title='DynamicStatic::referer' data-ref="DynamicStatic::referer">referer</a>);</td></tr>
<tr><th id="1115">1115</th><td>  <b>else</b></td></tr>
<tr><th id="1116">1116</th><td>    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::ref" title='dynamically_allocated_data::ref' data-ref="dynamically_allocated_data::ref">ref</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1117">1117</th><td></td></tr>
<tr><th id="1118">1118</th><td>  <a class="ref" href="url.h.html#Curl_safefree" title='Curl_safefree' data-ref="Curl_safefree">Curl_safefree</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookie" title='dynamically_allocated_data::cookie' data-ref="dynamically_allocated_data::cookie">cookie</a>);</td></tr>
<tr><th id="1119">1119</th><td>  <b>if</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::cookie" title='UserDefined::cookie' data-ref="UserDefined::cookie">cookie</a> &amp;&amp; !<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Cookie:"</q>))</td></tr>
<tr><th id="1120">1120</th><td>    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookie" title='dynamically_allocated_data::cookie' data-ref="dynamically_allocated_data::cookie">cookie</a> = <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Cookie: %s\015\012"</q>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::cookie" title='UserDefined::cookie' data-ref="UserDefined::cookie">cookie</a>);</td></tr>
<tr><th id="1121">1121</th><td>  <b>else</b></td></tr>
<tr><th id="1122">1122</th><td>    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookie" title='dynamically_allocated_data::cookie' data-ref="dynamically_allocated_data::cookie">cookie</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1123">1123</th><td></td></tr>
<tr><th id="1124">1124</th><td>  <b>if</b>(!<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a> &amp;&amp; (<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a> != <a class="enum" href="urldata.h.html#HTTPREQ_GET" title='HTTPREQ_GET' data-ref="HTTPREQ_GET">HTTPREQ_GET</a>)) {</td></tr>
<tr><th id="1125">1125</th><td>    <i>/* not a chunky transfer yet, but data is to be sent */</i></td></tr>
<tr><th id="1126">1126</th><td>    <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> = <a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Transfer-Encoding:"</q>);</td></tr>
<tr><th id="1127">1127</th><td>    <b>if</b>(<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>) {</td></tr>
<tr><th id="1128">1128</th><td>      <i>/* Some kind of TE is requested, check if 'chunked' is chosen */</i></td></tr>
<tr><th id="1129">1129</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a> =</td></tr>
<tr><th id="1130">1130</th><td>        <a class="ref" href="#Curl_compareheader" title='Curl_compareheader' data-ref="Curl_compareheader">Curl_compareheader</a>(<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>, <q>"Transfer-Encoding:"</q>, <q>"chunked"</q>);</td></tr>
<tr><th id="1131">1131</th><td>      <a class="local col3 ref" href="#123te" title='te' data-ref="123te">te</a> = <q>""</q>;</td></tr>
<tr><th id="1132">1132</th><td>    }</td></tr>
<tr><th id="1133">1133</th><td>  }</td></tr>
<tr><th id="1134">1134</th><td>  <b>else</b> <b>if</b>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a>) {</td></tr>
<tr><th id="1135">1135</th><td>    <i>/* RFC2616 section 4.4:</i></td></tr>
<tr><th id="1136">1136</th><td><i>       Messages MUST NOT include both a Content-Length header field and a</i></td></tr>
<tr><th id="1137">1137</th><td><i>       non-identity transfer-coding. If the message does include a non-</i></td></tr>
<tr><th id="1138">1138</th><td><i>       identity transfer-coding, the Content-Length MUST be ignored. */</i></td></tr>
<tr><th id="1139">1139</th><td></td></tr>
<tr><th id="1140">1140</th><td>    <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Transfer-Encoding:"</q>)) {</td></tr>
<tr><th id="1141">1141</th><td>      <a class="local col3 ref" href="#123te" title='te' data-ref="123te">te</a> = <q>"Transfer-Encoding: chunked\r\n"</q>;</td></tr>
<tr><th id="1142">1142</th><td>    }</td></tr>
<tr><th id="1143">1143</th><td>    <b>else</b> {</td></tr>
<tr><th id="1144">1144</th><td>      <a class="local col3 ref" href="#123te" title='te' data-ref="123te">te</a> = <q>""</q>;</td></tr>
<tr><th id="1145">1145</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a> = <a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>; <i>/* transfer-encoding was disabled,</i></td></tr>
<tr><th id="1146">1146</th><td><i>                                           so don't chunkify this! */</i></td></tr>
<tr><th id="1147">1147</th><td>    }</td></tr>
<tr><th id="1148">1148</th><td>  }</td></tr>
<tr><th id="1149">1149</th><td></td></tr>
<tr><th id="1150">1150</th><td>  <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> = <a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Host:"</q>);</td></tr>
<tr><th id="1151">1151</th><td>  <b>if</b>(<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> &amp;&amp; !<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::this_is_a_follow" title='UrlState::this_is_a_follow' data-ref="UrlState::this_is_a_follow">this_is_a_follow</a>) {</td></tr>
<tr><th id="1152">1152</th><td>    <i>/* If we have a given custom Host: header, we extract the host name in</i></td></tr>
<tr><th id="1153">1153</th><td><i>       order to possibly use it for cookie reasons later on. We only allow the</i></td></tr>
<tr><th id="1154">1154</th><td><i>       custom Host: header if this is NOT a redirect, as setting Host: in the</i></td></tr>
<tr><th id="1155">1155</th><td><i>       redirected request is being out on thin ice. */</i></td></tr>
<tr><th id="1156">1156</th><td>    <em>char</em> *<dfn class="local col7 decl" id="127start" title='start' data-type='char *' data-ref="127start">start</dfn> = <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>+<a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<q>"Host:"</q>);</td></tr>
<tr><th id="1157">1157</th><td>    <b>while</b>(*<a class="local col7 ref" href="#127start" title='start' data-ref="127start">start</a> &amp;&amp; <a class="macro" href="../../../include/ctype.h.html#205" title="((*__ctype_b_loc ())[(int) (((int)*start))] &amp; (unsigned short int) _ISspace)" data-ref="_M/isspace">isspace</a>((<em>int</em>)*<a class="local col7 ref" href="#127start" title='start' data-ref="127start">start</a> ))</td></tr>
<tr><th id="1158">1158</th><td>      <a class="local col7 ref" href="#127start" title='start' data-ref="127start">start</a>++;</td></tr>
<tr><th id="1159">1159</th><td>    <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> = <a class="local col7 ref" href="#127start" title='start' data-ref="127start">start</a>; <i>/* start host-scanning here */</i></td></tr>
<tr><th id="1160">1160</th><td></td></tr>
<tr><th id="1161">1161</th><td>    <i>/* scan through the string to find the end (space or colon) */</i></td></tr>
<tr><th id="1162">1162</th><td>    <b>while</b>(*<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> &amp;&amp; !<a class="macro" href="../../../include/ctype.h.html#205" title="((*__ctype_b_loc ())[(int) (((int)*ptr))] &amp; (unsigned short int) _ISspace)" data-ref="_M/isspace">isspace</a>((<em>int</em>)*<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>) &amp;&amp; !(<kbd>':'</kbd>==*<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>))</td></tr>
<tr><th id="1163">1163</th><td>      <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>++;</td></tr>
<tr><th id="1164">1164</th><td>    </td></tr>
<tr><th id="1165">1165</th><td>    <b>if</b>(<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> != <a class="local col7 ref" href="#127start" title='start' data-ref="127start">start</a>) {</td></tr>
<tr><th id="1166">1166</th><td>      <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col8 decl" id="128len" title='len' data-type='size_t' data-ref="128len">len</dfn>=<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>-<a class="local col7 ref" href="#127start" title='start' data-ref="127start">start</a>;</td></tr>
<tr><th id="1167">1167</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookiehost" title='dynamically_allocated_data::cookiehost' data-ref="dynamically_allocated_data::cookiehost">cookiehost</a> = <a class="macro" href="memdebug.h.html#75" title="curl_domalloc(len+1, 1167, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/malloc">malloc</a>(<a class="local col8 ref" href="#128len" title='len' data-ref="128len">len</a>+<var>1</var>);</td></tr>
<tr><th id="1168">1168</th><td>      <b>if</b>(!<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookiehost" title='dynamically_allocated_data::cookiehost' data-ref="dynamically_allocated_data::cookiehost">cookiehost</a>)</td></tr>
<tr><th id="1169">1169</th><td>        <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="1170">1170</th><td>      <a class="ref" href="../../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookiehost" title='dynamically_allocated_data::cookiehost' data-ref="dynamically_allocated_data::cookiehost">cookiehost</a>, <a class="local col7 ref" href="#127start" title='start' data-ref="127start">start</a>, <a class="local col8 ref" href="#128len" title='len' data-ref="128len">len</a>);</td></tr>
<tr><th id="1171">1171</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookiehost" title='dynamically_allocated_data::cookiehost' data-ref="dynamically_allocated_data::cookiehost">cookiehost</a>[<a class="local col8 ref" href="#128len" title='len' data-ref="128len">len</a>]=<var>0</var>;</td></tr>
<tr><th id="1172">1172</th><td>    }</td></tr>
<tr><th id="1173">1173</th><td>  }    </td></tr>
<tr><th id="1174">1174</th><td>  <b>else</b> {</td></tr>
<tr><th id="1175">1175</th><td>    <a class="ref" href="url.h.html#Curl_safefree" title='Curl_safefree' data-ref="Curl_safefree">Curl_safefree</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::host" title='dynamically_allocated_data::host' data-ref="dynamically_allocated_data::host">host</a>);</td></tr>
<tr><th id="1176">1176</th><td></td></tr>
<tr><th id="1177">1177</th><td>    <i>/* When building Host: headers, we must put the host name within</i></td></tr>
<tr><th id="1178">1178</th><td><i>       [brackets] if the host name is a plain IPv6-address. RFC2732-style. */</i></td></tr>
<tr><th id="1179">1179</th><td>       </td></tr>
<tr><th id="1180">1180</th><td>    <b>if</b>(((<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a>&amp;<a class="macro" href="urldata.h.html#411" title="(1&lt;&lt;3)" data-ref="_M/PROT_HTTPS">PROT_HTTPS</a>) &amp;&amp; (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::remote_port" title='connectdata::remote_port' data-ref="connectdata::remote_port">remote_port</a> == <a class="macro" href="urldata.h.html#35" title="443" data-ref="_M/PORT_HTTPS">PORT_HTTPS</a>)) ||</td></tr>
<tr><th id="1181">1181</th><td>       (!(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a>&amp;<a class="macro" href="urldata.h.html#411" title="(1&lt;&lt;3)" data-ref="_M/PROT_HTTPS">PROT_HTTPS</a>) &amp;&amp; (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::remote_port" title='connectdata::remote_port' data-ref="connectdata::remote_port">remote_port</a> == <a class="macro" href="urldata.h.html#34" title="80" data-ref="_M/PORT_HTTP">PORT_HTTP</a>)) )</td></tr>
<tr><th id="1182">1182</th><td>      <i>/* If (HTTPS on port 443) OR (non-HTTPS on port 80) then don't include</i></td></tr>
<tr><th id="1183">1183</th><td><i>         the port number in the host string */</i></td></tr>
<tr><th id="1184">1184</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::host" title='dynamically_allocated_data::host' data-ref="dynamically_allocated_data::host">host</a> = <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Host: %s%s%s\r\n"</q>,</td></tr>
<tr><th id="1185">1185</th><td>                                    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::ipv6_ip" title='ConnectBits::ipv6_ip' data-ref="ConnectBits::ipv6_ip">ipv6_ip</a>?<q>"["</q>:<q>""</q>,</td></tr>
<tr><th id="1186">1186</th><td>                                    <a class="local col2 ref" href="#122host" title='host' data-ref="122host">host</a>,</td></tr>
<tr><th id="1187">1187</th><td>                                    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::ipv6_ip" title='ConnectBits::ipv6_ip' data-ref="ConnectBits::ipv6_ip">ipv6_ip</a>?<q>"]"</q>:<q>""</q>);</td></tr>
<tr><th id="1188">1188</th><td>    <b>else</b></td></tr>
<tr><th id="1189">1189</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::host" title='dynamically_allocated_data::host' data-ref="dynamically_allocated_data::host">host</a> = <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Host: %s%s%s:%d\r\n"</q>,</td></tr>
<tr><th id="1190">1190</th><td>                                    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::ipv6_ip" title='ConnectBits::ipv6_ip' data-ref="ConnectBits::ipv6_ip">ipv6_ip</a>?<q>"["</q>:<q>""</q>,</td></tr>
<tr><th id="1191">1191</th><td>                                    <a class="local col2 ref" href="#122host" title='host' data-ref="122host">host</a>,</td></tr>
<tr><th id="1192">1192</th><td>                                    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::ipv6_ip" title='ConnectBits::ipv6_ip' data-ref="ConnectBits::ipv6_ip">ipv6_ip</a>?<q>"]"</q>:<q>""</q>,</td></tr>
<tr><th id="1193">1193</th><td>                                    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::remote_port" title='connectdata::remote_port' data-ref="connectdata::remote_port">remote_port</a>);</td></tr>
<tr><th id="1194">1194</th><td></td></tr>
<tr><th id="1195">1195</th><td>    <b>if</b>(!<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::host" title='dynamically_allocated_data::host' data-ref="dynamically_allocated_data::host">host</a>)</td></tr>
<tr><th id="1196">1196</th><td>      <i>/* without Host: we can't make a nice request */</i></td></tr>
<tr><th id="1197">1197</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="1198">1198</th><td>  }</td></tr>
<tr><th id="1199">1199</th><td></td></tr>
<tr><th id="1200">1200</th><td>  <b>if</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::cookies" title='SessionHandle::cookies' data-ref="SessionHandle::cookies">cookies</a>) {</td></tr>
<tr><th id="1201">1201</th><td>    <a class="ref" href="share.h.html#Curl_share_lock" title='Curl_share_lock' data-ref="Curl_share_lock">Curl_share_lock</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <a class="enum" href="../include/curl/curl.h.html#CURL_LOCK_DATA_COOKIE" title='CURL_LOCK_DATA_COOKIE' data-ref="CURL_LOCK_DATA_COOKIE">CURL_LOCK_DATA_COOKIE</a>, <a class="enum" href="../include/curl/curl.h.html#CURL_LOCK_ACCESS_SINGLE" title='CURL_LOCK_ACCESS_SINGLE' data-ref="CURL_LOCK_ACCESS_SINGLE">CURL_LOCK_ACCESS_SINGLE</a>);</td></tr>
<tr><th id="1202">1202</th><td>    <a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a> = <a class="ref" href="cookie.h.html#Curl_cookie_getlist" title='Curl_cookie_getlist' data-ref="Curl_cookie_getlist">Curl_cookie_getlist</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::cookies" title='SessionHandle::cookies' data-ref="SessionHandle::cookies">cookies</a>,</td></tr>
<tr><th id="1203">1203</th><td>                             <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookiehost" title='dynamically_allocated_data::cookiehost' data-ref="dynamically_allocated_data::cookiehost">cookiehost</a>?</td></tr>
<tr><th id="1204">1204</th><td>                             <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookiehost" title='dynamically_allocated_data::cookiehost' data-ref="dynamically_allocated_data::cookiehost">cookiehost</a>:<a class="local col2 ref" href="#122host" title='host' data-ref="122host">host</a>, <a class="local col1 ref" href="#121ppath" title='ppath' data-ref="121ppath">ppath</a>,</td></tr>
<tr><th id="1205">1205</th><td>                             (<a class="typedef" href="setup.h.html#bool" title='bool' data-type='unsigned char' data-ref="bool">bool</a>)(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a>&amp;<a class="macro" href="urldata.h.html#411" title="(1&lt;&lt;3)" data-ref="_M/PROT_HTTPS">PROT_HTTPS</a>?<a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>:<a class="macro" href="setup.h.html#70" title="0" data-ref="_M/FALSE">FALSE</a>));</td></tr>
<tr><th id="1206">1206</th><td>    <a class="ref" href="share.h.html#Curl_share_unlock" title='Curl_share_unlock' data-ref="Curl_share_unlock">Curl_share_unlock</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <a class="enum" href="../include/curl/curl.h.html#CURL_LOCK_DATA_COOKIE" title='CURL_LOCK_DATA_COOKIE' data-ref="CURL_LOCK_DATA_COOKIE">CURL_LOCK_DATA_COOKIE</a>);</td></tr>
<tr><th id="1207">1207</th><td>  }</td></tr>
<tr><th id="1208">1208</th><td></td></tr>
<tr><th id="1209">1209</th><td>  <b>if</b> (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::httpproxy" title='ConnectBits::httpproxy' data-ref="ConnectBits::httpproxy">httpproxy</a> &amp;&amp;</td></tr>
<tr><th id="1210">1210</th><td>      !<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::tunnel_thru_httpproxy" title='UserDefined::tunnel_thru_httpproxy' data-ref="UserDefined::tunnel_thru_httpproxy">tunnel_thru_httpproxy</a> &amp;&amp;</td></tr>
<tr><th id="1211">1211</th><td>      !(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::protocol" title='connectdata::protocol' data-ref="connectdata::protocol">protocol</a>&amp;<a class="macro" href="urldata.h.html#411" title="(1&lt;&lt;3)" data-ref="_M/PROT_HTTPS">PROT_HTTPS</a>))  {</td></tr>
<tr><th id="1212">1212</th><td>    <i>/* The path sent to the proxy is in fact the entire URL */</i></td></tr>
<tr><th id="1213">1213</th><td>    <a class="local col1 ref" href="#121ppath" title='ppath' data-ref="121ppath">ppath</a> = <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::change" title='SessionHandle::change' data-ref="SessionHandle::change">change</a>.<a class="ref" href="urldata.h.html#DynamicStatic::url" title='DynamicStatic::url' data-ref="DynamicStatic::url">url</a>;</td></tr>
<tr><th id="1214">1214</th><td>  }</td></tr>
<tr><th id="1215">1215</th><td>  <b>if</b>(<a class="enum" href="urldata.h.html#HTTPREQ_POST_FORM" title='HTTPREQ_POST_FORM' data-ref="HTTPREQ_POST_FORM">HTTPREQ_POST_FORM</a> == <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>) {</td></tr>
<tr><th id="1216">1216</th><td>    <i>/* we must build the whole darned post sequence first, so that we have</i></td></tr>
<tr><th id="1217">1217</th><td><i>       a size of the whole shebang before we start to send it */</i></td></tr>
<tr><th id="1218">1218</th><td>     <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="ref" href="formdata.h.html#Curl_getFormData" title='Curl_getFormData' data-ref="Curl_getFormData">Curl_getFormData</a>(&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sendit" title='HTTP::sendit' data-ref="HTTP::sendit">sendit</a>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httppost" title='UserDefined::httppost' data-ref="UserDefined::httppost">httppost</a>,</td></tr>
<tr><th id="1219">1219</th><td>                               &amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>);</td></tr>
<tr><th id="1220">1220</th><td>     <b>if</b>(<a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a> != <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>) {</td></tr>
<tr><th id="1221">1221</th><td>       <i>/* Curl_getFormData() doesn't use failf() */</i></td></tr>
<tr><th id="1222">1222</th><td>       <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"failed creating formpost data"</q>);</td></tr>
<tr><th id="1223">1223</th><td>       <b>return</b> <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>;</td></tr>
<tr><th id="1224">1224</th><td>     }</td></tr>
<tr><th id="1225">1225</th><td>  }</td></tr>
<tr><th id="1226">1226</th><td></td></tr>
<tr><th id="1227">1227</th><td></td></tr>
<tr><th id="1228">1228</th><td>  <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Pragma:"</q>))</td></tr>
<tr><th id="1229">1229</th><td>    <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::p_pragma" title='HTTP::p_pragma' data-ref="HTTP::p_pragma">p_pragma</a> = <q>"Pragma: no-cache\r\n"</q>;</td></tr>
<tr><th id="1230">1230</th><td></td></tr>
<tr><th id="1231">1231</th><td>  <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Accept:"</q>))</td></tr>
<tr><th id="1232">1232</th><td>    <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::p_accept" title='HTTP::p_accept' data-ref="HTTP::p_accept">p_accept</a> = <q>"Accept: */*\r\n"</q>;</td></tr>
<tr><th id="1233">1233</th><td></td></tr>
<tr><th id="1234">1234</th><td>  <b>if</b>(( (<a class="enum" href="urldata.h.html#HTTPREQ_POST" title='HTTPREQ_POST' data-ref="HTTPREQ_POST">HTTPREQ_POST</a> == <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>) ||</td></tr>
<tr><th id="1235">1235</th><td>       (<a class="enum" href="urldata.h.html#HTTPREQ_POST_FORM" title='HTTPREQ_POST_FORM' data-ref="HTTPREQ_POST_FORM">HTTPREQ_POST_FORM</a> == <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>) ||</td></tr>
<tr><th id="1236">1236</th><td>       (<a class="enum" href="urldata.h.html#HTTPREQ_PUT" title='HTTPREQ_PUT' data-ref="HTTPREQ_PUT">HTTPREQ_PUT</a> == <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>) ) &amp;&amp;</td></tr>
<tr><th id="1237">1237</th><td>     <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a>) {</td></tr>
<tr><th id="1238">1238</th><td>    <i>/**********************************************************************</i></td></tr>
<tr><th id="1239">1239</th><td><i>     * Resuming upload in HTTP means that we PUT or POST and that we have</i></td></tr>
<tr><th id="1240">1240</th><td><i>     * got a resume_from value set. The resume value has already created</i></td></tr>
<tr><th id="1241">1241</th><td><i>     * a Range: header that will be passed along. We need to "fast forward"</i></td></tr>
<tr><th id="1242">1242</th><td><i>     * the file the given number of bytes and decrease the assume upload</i></td></tr>
<tr><th id="1243">1243</th><td><i>     * file size before we continue this venture in the dark lands of HTTP.</i></td></tr>
<tr><th id="1244">1244</th><td><i>     *********************************************************************/</i></td></tr>
<tr><th id="1245">1245</th><td>   </td></tr>
<tr><th id="1246">1246</th><td>    <b>if</b>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a> &lt; <var>0</var> ) {</td></tr>
<tr><th id="1247">1247</th><td>      <i>/*</i></td></tr>
<tr><th id="1248">1248</th><td><i>       * This is meant to get the size of the present remote-file by itself.</i></td></tr>
<tr><th id="1249">1249</th><td><i>       * We don't support this now. Bail out!</i></td></tr>
<tr><th id="1250">1250</th><td><i>       */</i></td></tr>
<tr><th id="1251">1251</th><td>       <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a> = <var>0</var>;</td></tr>
<tr><th id="1252">1252</th><td>    }</td></tr>
<tr><th id="1253">1253</th><td></td></tr>
<tr><th id="1254">1254</th><td>    <b>if</b>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a>) {</td></tr>
<tr><th id="1255">1255</th><td>      <i>/* do we still game? */</i></td></tr>
<tr><th id="1256">1256</th><td>      <a class="typedef" href="../include/curl/curl.h.html#curl_off_t" title='curl_off_t' data-type='off_t' data-ref="curl_off_t">curl_off_t</a> <dfn class="local col9 decl" id="129passed" title='passed' data-type='curl_off_t' data-ref="129passed">passed</dfn>=<var>0</var>;</td></tr>
<tr><th id="1257">1257</th><td></td></tr>
<tr><th id="1258">1258</th><td>      <i>/* Now, let's read off the proper amount of bytes from the</i></td></tr>
<tr><th id="1259">1259</th><td><i>         input. If we knew it was a proper file we could've just</i></td></tr>
<tr><th id="1260">1260</th><td><i>         fseek()ed but we only have a stream here */</i></td></tr>
<tr><th id="1261">1261</th><td>      <b>do</b> {</td></tr>
<tr><th id="1262">1262</th><td>        <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col0 decl" id="130readthisamountnow" title='readthisamountnow' data-type='size_t' data-ref="130readthisamountnow">readthisamountnow</dfn> = (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span>)(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a> - <a class="local col9 ref" href="#129passed" title='passed' data-ref="129passed">passed</a>);</td></tr>
<tr><th id="1263">1263</th><td>        <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col1 decl" id="131actuallyread" title='actuallyread' data-type='size_t' data-ref="131actuallyread">actuallyread</dfn>;</td></tr>
<tr><th id="1264">1264</th><td></td></tr>
<tr><th id="1265">1265</th><td>        <b>if</b>(<a class="local col0 ref" href="#130readthisamountnow" title='readthisamountnow' data-ref="130readthisamountnow">readthisamountnow</a> &gt; <a class="macro" href="urldata.h.html#104" title="16384" data-ref="_M/BUFSIZE">BUFSIZE</a>)</td></tr>
<tr><th id="1266">1266</th><td>          <a class="local col0 ref" href="#130readthisamountnow" title='readthisamountnow' data-ref="130readthisamountnow">readthisamountnow</a> = <a class="macro" href="urldata.h.html#104" title="16384" data-ref="_M/BUFSIZE">BUFSIZE</a>;</td></tr>
<tr><th id="1267">1267</th><td></td></tr>
<tr><th id="1268">1268</th><td>        <a class="local col1 ref" href="#131actuallyread" title='actuallyread' data-ref="131actuallyread">actuallyread</a> =</td></tr>
<tr><th id="1269">1269</th><td>          <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::fread" title='UserDefined::fread' data-ref="UserDefined::fread">fread</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::state" title='SessionHandle::state' data-ref="SessionHandle::state">state</a>.<a class="ref" href="urldata.h.html#UrlState::buffer" title='UrlState::buffer' data-ref="UrlState::buffer">buffer</a>, <var>1</var>, (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span>)<a class="local col0 ref" href="#130readthisamountnow" title='readthisamountnow' data-ref="130readthisamountnow">readthisamountnow</a>,</td></tr>
<tr><th id="1270">1270</th><td>                          <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::in" title='UserDefined::in' data-ref="UserDefined::in">in</a>);</td></tr>
<tr><th id="1271">1271</th><td></td></tr>
<tr><th id="1272">1272</th><td>        <a class="local col9 ref" href="#129passed" title='passed' data-ref="129passed">passed</a> += <a class="local col1 ref" href="#131actuallyread" title='actuallyread' data-ref="131actuallyread">actuallyread</a>;</td></tr>
<tr><th id="1273">1273</th><td>        <b>if</b>(<a class="local col1 ref" href="#131actuallyread" title='actuallyread' data-ref="131actuallyread">actuallyread</a> != <a class="local col0 ref" href="#130readthisamountnow" title='readthisamountnow' data-ref="130readthisamountnow">readthisamountnow</a>) {</td></tr>
<tr><th id="1274">1274</th><td>          <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Could only read %"</q> <a class="macro" href="setup.h.html#97" title="&quot;lld&quot;" data-ref="_M/FORMAT_OFF_T">FORMAT_OFF_T</a></td></tr>
<tr><th id="1275">1275</th><td>                <q>" bytes from the input"</q>,</td></tr>
<tr><th id="1276">1276</th><td>                <a class="local col9 ref" href="#129passed" title='passed' data-ref="129passed">passed</a>);</td></tr>
<tr><th id="1277">1277</th><td>          <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_READ_ERROR" title='CURLE_READ_ERROR' data-ref="CURLE_READ_ERROR">CURLE_READ_ERROR</a>;</td></tr>
<tr><th id="1278">1278</th><td>        }</td></tr>
<tr><th id="1279">1279</th><td>      } <b>while</b>(<a class="local col9 ref" href="#129passed" title='passed' data-ref="129passed">passed</a> != <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a>); <i>/* loop until done */</i></td></tr>
<tr><th id="1280">1280</th><td></td></tr>
<tr><th id="1281">1281</th><td>      <i>/* now, decrease the size of the read */</i></td></tr>
<tr><th id="1282">1282</th><td>      <b>if</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a>&gt;<var>0</var>) {</td></tr>
<tr><th id="1283">1283</th><td>        <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a> -= <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a>;</td></tr>
<tr><th id="1284">1284</th><td></td></tr>
<tr><th id="1285">1285</th><td>        <b>if</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a> &lt;= <var>0</var>) {</td></tr>
<tr><th id="1286">1286</th><td>          <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"File already completely uploaded"</q>);</td></tr>
<tr><th id="1287">1287</th><td>          <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_PARTIAL_FILE" title='CURLE_PARTIAL_FILE' data-ref="CURLE_PARTIAL_FILE">CURLE_PARTIAL_FILE</a>;</td></tr>
<tr><th id="1288">1288</th><td>        }</td></tr>
<tr><th id="1289">1289</th><td>      }</td></tr>
<tr><th id="1290">1290</th><td>      <i>/* we've passed, proceed as normal */</i></td></tr>
<tr><th id="1291">1291</th><td>    }</td></tr>
<tr><th id="1292">1292</th><td>  }</td></tr>
<tr><th id="1293">1293</th><td>  <b>if</b>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::use_range" title='ConnectBits::use_range' data-ref="ConnectBits::use_range">use_range</a>) {</td></tr>
<tr><th id="1294">1294</th><td>    <i>/*</i></td></tr>
<tr><th id="1295">1295</th><td><i>     * A range is selected. We use different headers whether we're downloading</i></td></tr>
<tr><th id="1296">1296</th><td><i>     * or uploading and we always let customized headers override our internal</i></td></tr>
<tr><th id="1297">1297</th><td><i>     * ones if any such are specified.</i></td></tr>
<tr><th id="1298">1298</th><td><i>     */</i></td></tr>
<tr><th id="1299">1299</th><td>    <b>if</b>((<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a> == <a class="enum" href="urldata.h.html#HTTPREQ_GET" title='HTTPREQ_GET' data-ref="HTTPREQ_GET">HTTPREQ_GET</a>) &amp;&amp;</td></tr>
<tr><th id="1300">1300</th><td>       !<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Range:"</q>)) {</td></tr>
<tr><th id="1301">1301</th><td>      <i>/* if a line like this was already allocated, free the previous one */</i></td></tr>
<tr><th id="1302">1302</th><td>      <b>if</b>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::rangeline" title='dynamically_allocated_data::rangeline' data-ref="dynamically_allocated_data::rangeline">rangeline</a>)</td></tr>
<tr><th id="1303">1303</th><td>        <a class="macro" href="memdebug.h.html#78" title="curl_dofree(conn-&gt;allocptr.rangeline, 1303, &quot;/home/jon/workspace/id-software/DOOM-3/neo/curl/lib/http.c&quot;)" data-ref="_M/free">free</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::rangeline" title='dynamically_allocated_data::rangeline' data-ref="dynamically_allocated_data::rangeline">rangeline</a>);</td></tr>
<tr><th id="1304">1304</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::rangeline" title='dynamically_allocated_data::rangeline' data-ref="dynamically_allocated_data::rangeline">rangeline</a> = <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Range: bytes=%s\r\n"</q>, <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::range" title='connectdata::range' data-ref="connectdata::range">range</a>);</td></tr>
<tr><th id="1305">1305</th><td>    }</td></tr>
<tr><th id="1306">1306</th><td>    <b>else</b> <b>if</b>((<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a> != <a class="enum" href="urldata.h.html#HTTPREQ_GET" title='HTTPREQ_GET' data-ref="HTTPREQ_GET">HTTPREQ_GET</a>) &amp;&amp;</td></tr>
<tr><th id="1307">1307</th><td>            !<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Content-Range:"</q>)) {</td></tr>
<tr><th id="1308">1308</th><td></td></tr>
<tr><th id="1309">1309</th><td>      <b>if</b>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a>) {</td></tr>
<tr><th id="1310">1310</th><td>        <i>/* This is because "resume" was selected */</i></td></tr>
<tr><th id="1311">1311</th><td>        <a class="typedef" href="../include/curl/curl.h.html#curl_off_t" title='curl_off_t' data-type='off_t' data-ref="curl_off_t">curl_off_t</a> <dfn class="local col2 decl" id="132total_expected_size" title='total_expected_size' data-type='curl_off_t' data-ref="132total_expected_size">total_expected_size</dfn>=</td></tr>
<tr><th id="1312">1312</th><td>          <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::resume_from" title='connectdata::resume_from' data-ref="connectdata::resume_from">resume_from</a> + <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a>;</td></tr>
<tr><th id="1313">1313</th><td>        <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::rangeline" title='dynamically_allocated_data::rangeline' data-ref="dynamically_allocated_data::rangeline">rangeline</a> =</td></tr>
<tr><th id="1314">1314</th><td>	    <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Content-Range: bytes %s%"</q> <a class="macro" href="setup.h.html#97" title="&quot;lld&quot;" data-ref="_M/FORMAT_OFF_T">FORMAT_OFF_T</a></td></tr>
<tr><th id="1315">1315</th><td>                    <q>"/%"</q> <a class="macro" href="setup.h.html#97" title="&quot;lld&quot;" data-ref="_M/FORMAT_OFF_T">FORMAT_OFF_T</a> <q>"\r\n"</q>,</td></tr>
<tr><th id="1316">1316</th><td>		    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::range" title='connectdata::range' data-ref="connectdata::range">range</a>, <a class="local col2 ref" href="#132total_expected_size" title='total_expected_size' data-ref="132total_expected_size">total_expected_size</a>-<var>1</var>,</td></tr>
<tr><th id="1317">1317</th><td>		    <a class="local col2 ref" href="#132total_expected_size" title='total_expected_size' data-ref="132total_expected_size">total_expected_size</a>);</td></tr>
<tr><th id="1318">1318</th><td>      }</td></tr>
<tr><th id="1319">1319</th><td>      <b>else</b> {</td></tr>
<tr><th id="1320">1320</th><td>        <i>/* Range was selected and then we just pass the incoming range and </i></td></tr>
<tr><th id="1321">1321</th><td><i>           append total size */</i></td></tr>
<tr><th id="1322">1322</th><td>        <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::rangeline" title='dynamically_allocated_data::rangeline' data-ref="dynamically_allocated_data::rangeline">rangeline</a> =</td></tr>
<tr><th id="1323">1323</th><td>	    <a class="macro" href="../include/curl/mprintf.h.html#50" title="curl_maprintf" data-ref="_M/aprintf">aprintf</a>(<q>"Content-Range: bytes %s/%"</q> <a class="macro" href="setup.h.html#97" title="&quot;lld&quot;" data-ref="_M/FORMAT_OFF_T">FORMAT_OFF_T</a> <q>"\r\n"</q>,</td></tr>
<tr><th id="1324">1324</th><td>		    <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::range" title='connectdata::range' data-ref="connectdata::range">range</a>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a>);</td></tr>
<tr><th id="1325">1325</th><td>      }</td></tr>
<tr><th id="1326">1326</th><td>    }</td></tr>
<tr><th id="1327">1327</th><td>  }</td></tr>
<tr><th id="1328">1328</th><td></td></tr>
<tr><th id="1329">1329</th><td>  {</td></tr>
<tr><th id="1330">1330</th><td>    <i>/* Use 1.1 unless the use specificly asked for 1.0 */</i></td></tr>
<tr><th id="1331">1331</th><td>    <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="133httpstring" title='httpstring' data-type='const char *' data-ref="133httpstring">httpstring</dfn>=</td></tr>
<tr><th id="1332">1332</th><td>      <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpversion" title='UserDefined::httpversion' data-ref="UserDefined::httpversion">httpversion</a>==<a class="enum" href="../include/curl/curl.h.html#CURL_HTTP_VERSION_1_0" title='CURL_HTTP_VERSION_1_0' data-ref="CURL_HTTP_VERSION_1_0">CURL_HTTP_VERSION_1_0</a>?<q>"1.0"</q>:<q>"1.1"</q>;</td></tr>
<tr><th id="1333">1333</th><td></td></tr>
<tr><th id="1334">1334</th><td>    <a class="typedef" href="#send_buffer" title='send_buffer' data-type='struct send_buffer' data-ref="send_buffer">send_buffer</a> *<dfn class="local col4 decl" id="134req_buffer" title='req_buffer' data-type='send_buffer *' data-ref="134req_buffer">req_buffer</dfn>;</td></tr>
<tr><th id="1335">1335</th><td>    <b>struct</b> <a class="type" href="../include/curl/curl.h.html#curl_slist" title='curl_slist' data-ref="curl_slist">curl_slist</a> *<dfn class="local col5 decl" id="135headers" title='headers' data-type='struct curl_slist *' data-ref="135headers">headers</dfn>=<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::headers" title='UserDefined::headers' data-ref="UserDefined::headers">headers</a>;</td></tr>
<tr><th id="1336">1336</th><td>    <a class="typedef" href="../include/curl/curl.h.html#curl_off_t" title='curl_off_t' data-type='off_t' data-ref="curl_off_t">curl_off_t</a> <dfn class="local col6 decl" id="136postsize" title='postsize' data-type='curl_off_t' data-ref="136postsize">postsize</dfn>; <i>/* off_t type to be able to hold a large file size */</i></td></tr>
<tr><th id="1337">1337</th><td></td></tr>
<tr><th id="1338">1338</th><td>    <i>/* initialize a dynamic send-buffer */</i></td></tr>
<tr><th id="1339">1339</th><td>    <a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a> = <a class="tu ref" href="#add_buffer_init" title='add_buffer_init' data-use='c' data-ref="add_buffer_init">add_buffer_init</a>();</td></tr>
<tr><th id="1340">1340</th><td></td></tr>
<tr><th id="1341">1341</th><td>    <b>if</b>(!<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>)</td></tr>
<tr><th id="1342">1342</th><td>      <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OUT_OF_MEMORY" title='CURLE_OUT_OF_MEMORY' data-ref="CURLE_OUT_OF_MEMORY">CURLE_OUT_OF_MEMORY</a>;</td></tr>
<tr><th id="1343">1343</th><td></td></tr>
<tr><th id="1344">1344</th><td>    <i>/* add the main request stuff */</i></td></tr>
<tr><th id="1345">1345</th><td>    <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> =</td></tr>
<tr><th id="1346">1346</th><td>      <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1347">1347</th><td>                  <q>"%s "</q> <i>/* GET/HEAD/POST/PUT */</i></td></tr>
<tr><th id="1348">1348</th><td>                  <q>"%s HTTP/%s\r\n"</q> <i>/* path + HTTP version */</i></td></tr>
<tr><th id="1349">1349</th><td>                  <q>"%s"</q> <i>/* proxyuserpwd */</i></td></tr>
<tr><th id="1350">1350</th><td>                  <q>"%s"</q> <i>/* userpwd */</i></td></tr>
<tr><th id="1351">1351</th><td>                  <q>"%s"</q> <i>/* range */</i></td></tr>
<tr><th id="1352">1352</th><td>                  <q>"%s"</q> <i>/* user agent */</i></td></tr>
<tr><th id="1353">1353</th><td>                  <q>"%s"</q> <i>/* cookie */</i></td></tr>
<tr><th id="1354">1354</th><td>                  <q>"%s"</q> <i>/* host */</i></td></tr>
<tr><th id="1355">1355</th><td>                  <q>"%s"</q> <i>/* pragma */</i></td></tr>
<tr><th id="1356">1356</th><td>                  <q>"%s"</q> <i>/* accept */</i></td></tr>
<tr><th id="1357">1357</th><td>                  <q>"%s"</q> <i>/* accept-encoding */</i></td></tr>
<tr><th id="1358">1358</th><td>                  <q>"%s"</q> <i>/* referer */</i></td></tr>
<tr><th id="1359">1359</th><td>                  <q>"%s"</q>,<i>/* transfer-encoding */</i></td></tr>
<tr><th id="1360">1360</th><td></td></tr>
<tr><th id="1361">1361</th><td>                <a class="local col5 ref" href="#125request" title='request' data-ref="125request">request</a>,</td></tr>
<tr><th id="1362">1362</th><td>                <a class="local col1 ref" href="#121ppath" title='ppath' data-ref="121ppath">ppath</a>,</td></tr>
<tr><th id="1363">1363</th><td>                <a class="local col3 ref" href="#133httpstring" title='httpstring' data-ref="133httpstring">httpstring</a>,</td></tr>
<tr><th id="1364">1364</th><td>                (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::httpproxy" title='ConnectBits::httpproxy' data-ref="ConnectBits::httpproxy">httpproxy</a> &amp;&amp; <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::proxyuserpwd" title='dynamically_allocated_data::proxyuserpwd' data-ref="dynamically_allocated_data::proxyuserpwd">proxyuserpwd</a>)?</td></tr>
<tr><th id="1365">1365</th><td>                <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::proxyuserpwd" title='dynamically_allocated_data::proxyuserpwd' data-ref="dynamically_allocated_data::proxyuserpwd">proxyuserpwd</a>:<q>""</q>,</td></tr>
<tr><th id="1366">1366</th><td>                <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::userpwd" title='dynamically_allocated_data::userpwd' data-ref="dynamically_allocated_data::userpwd">userpwd</a>?<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::userpwd" title='dynamically_allocated_data::userpwd' data-ref="dynamically_allocated_data::userpwd">userpwd</a>:<q>""</q>,</td></tr>
<tr><th id="1367">1367</th><td>                (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::use_range" title='ConnectBits::use_range' data-ref="ConnectBits::use_range">use_range</a> &amp;&amp; <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::rangeline" title='dynamically_allocated_data::rangeline' data-ref="dynamically_allocated_data::rangeline">rangeline</a>)?</td></tr>
<tr><th id="1368">1368</th><td>                <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::rangeline" title='dynamically_allocated_data::rangeline' data-ref="dynamically_allocated_data::rangeline">rangeline</a>:<q>""</q>,</td></tr>
<tr><th id="1369">1369</th><td>                (<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::useragent" title='UserDefined::useragent' data-ref="UserDefined::useragent">useragent</a> &amp;&amp; *<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::useragent" title='UserDefined::useragent' data-ref="UserDefined::useragent">useragent</a> &amp;&amp; <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::uagent" title='dynamically_allocated_data::uagent' data-ref="dynamically_allocated_data::uagent">uagent</a>)?</td></tr>
<tr><th id="1370">1370</th><td>                <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::uagent" title='dynamically_allocated_data::uagent' data-ref="dynamically_allocated_data::uagent">uagent</a>:<q>""</q>,</td></tr>
<tr><th id="1371">1371</th><td>                (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookie" title='dynamically_allocated_data::cookie' data-ref="dynamically_allocated_data::cookie">cookie</a>?<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::cookie" title='dynamically_allocated_data::cookie' data-ref="dynamically_allocated_data::cookie">cookie</a>:<q>""</q>), <i>/* Cookie: &lt;data&gt; */</i></td></tr>
<tr><th id="1372">1372</th><td>                (<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::host" title='dynamically_allocated_data::host' data-ref="dynamically_allocated_data::host">host</a>?<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::host" title='dynamically_allocated_data::host' data-ref="dynamically_allocated_data::host">host</a>:<q>""</q>), <i>/* Host: host */</i></td></tr>
<tr><th id="1373">1373</th><td>                <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::p_pragma" title='HTTP::p_pragma' data-ref="HTTP::p_pragma">p_pragma</a>?<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::p_pragma" title='HTTP::p_pragma' data-ref="HTTP::p_pragma">p_pragma</a>:<q>""</q>,</td></tr>
<tr><th id="1374">1374</th><td>                <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::p_accept" title='HTTP::p_accept' data-ref="HTTP::p_accept">p_accept</a>?<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::p_accept" title='HTTP::p_accept' data-ref="HTTP::p_accept">p_accept</a>:<q>""</q>,</td></tr>
<tr><th id="1375">1375</th><td>                (<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::encoding" title='UserDefined::encoding' data-ref="UserDefined::encoding">encoding</a> &amp;&amp; *<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::encoding" title='UserDefined::encoding' data-ref="UserDefined::encoding">encoding</a> &amp;&amp; <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::accept_encoding" title='dynamically_allocated_data::accept_encoding' data-ref="dynamically_allocated_data::accept_encoding">accept_encoding</a>)?</td></tr>
<tr><th id="1376">1376</th><td>                <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::accept_encoding" title='dynamically_allocated_data::accept_encoding' data-ref="dynamically_allocated_data::accept_encoding">accept_encoding</a>:<q>""</q>, <i>/* 08/28/02 jhrg */</i></td></tr>
<tr><th id="1377">1377</th><td>                (<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::change" title='SessionHandle::change' data-ref="SessionHandle::change">change</a>.<a class="ref" href="urldata.h.html#DynamicStatic::referer" title='DynamicStatic::referer' data-ref="DynamicStatic::referer">referer</a> &amp;&amp; <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::ref" title='dynamically_allocated_data::ref' data-ref="dynamically_allocated_data::ref">ref</a>)?<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::allocptr" title='connectdata::allocptr' data-ref="connectdata::allocptr">allocptr</a>.<a class="ref" href="urldata.h.html#dynamically_allocated_data::ref" title='dynamically_allocated_data::ref' data-ref="dynamically_allocated_data::ref">ref</a>:<q>""</q> <i>/* Referer: &lt;data&gt; &lt;CRLF&gt; */</i>,</td></tr>
<tr><th id="1378">1378</th><td>                <a class="local col3 ref" href="#123te" title='te' data-ref="123te">te</a></td></tr>
<tr><th id="1379">1379</th><td>                );</td></tr>
<tr><th id="1380">1380</th><td></td></tr>
<tr><th id="1381">1381</th><td>    <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1382">1382</th><td>      <b>return</b> <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>;</td></tr>
<tr><th id="1383">1383</th><td></td></tr>
<tr><th id="1384">1384</th><td>    <b>if</b>(<a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>) {</td></tr>
<tr><th id="1385">1385</th><td>      <em>int</em> <dfn class="local col7 decl" id="137count" title='count' data-type='int' data-ref="137count">count</dfn>=<var>0</var>;</td></tr>
<tr><th id="1386">1386</th><td>      <b>struct</b> <a class="type" href="cookie.h.html#Cookie" title='Cookie' data-ref="Cookie">Cookie</a> *<dfn class="local col8 decl" id="138store" title='store' data-type='struct Cookie *' data-ref="138store">store</dfn>=<a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>;</td></tr>
<tr><th id="1387">1387</th><td>      <i>/* now loop through all cookies that matched */</i></td></tr>
<tr><th id="1388">1388</th><td>      <b>while</b>(<a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>) {</td></tr>
<tr><th id="1389">1389</th><td>        <b>if</b>(<a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>-&gt;<a class="ref" href="cookie.h.html#Cookie::value" title='Cookie::value' data-ref="Cookie::value">value</a>) {</td></tr>
<tr><th id="1390">1390</th><td>          <b>if</b>(<var>0</var> == <a class="local col7 ref" href="#137count" title='count' data-ref="137count">count</a>) {</td></tr>
<tr><th id="1391">1391</th><td>            <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"Cookie: "</q>);</td></tr>
<tr><th id="1392">1392</th><td>          }</td></tr>
<tr><th id="1393">1393</th><td>          <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1394">1394</th><td>                      <q>"%s%s=%s"</q>, <a class="local col7 ref" href="#137count" title='count' data-ref="137count">count</a>?<q>"; "</q>:<q>""</q>, <a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>-&gt;<a class="ref" href="cookie.h.html#Cookie::name" title='Cookie::name' data-ref="Cookie::name">name</a>, <a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>-&gt;<a class="ref" href="cookie.h.html#Cookie::value" title='Cookie::value' data-ref="Cookie::value">value</a>);</td></tr>
<tr><th id="1395">1395</th><td>          <a class="local col7 ref" href="#137count" title='count' data-ref="137count">count</a>++;</td></tr>
<tr><th id="1396">1396</th><td>        }</td></tr>
<tr><th id="1397">1397</th><td>        <a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a> = <a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>-&gt;<a class="ref" href="cookie.h.html#Cookie::next" title='Cookie::next' data-ref="Cookie::next">next</a>; <i>/* next cookie please */</i></td></tr>
<tr><th id="1398">1398</th><td>      }</td></tr>
<tr><th id="1399">1399</th><td>      <b>if</b>(<a class="local col7 ref" href="#137count" title='count' data-ref="137count">count</a>) {</td></tr>
<tr><th id="1400">1400</th><td>        <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n"</q>, <var>2</var>);</td></tr>
<tr><th id="1401">1401</th><td>      }</td></tr>
<tr><th id="1402">1402</th><td>      <a class="ref" href="cookie.h.html#Curl_cookie_freelist" title='Curl_cookie_freelist' data-ref="Curl_cookie_freelist">Curl_cookie_freelist</a>(<a class="local col8 ref" href="#138store" title='store' data-ref="138store">store</a>); <i>/* free the cookie list */</i></td></tr>
<tr><th id="1403">1403</th><td>      <a class="local col0 ref" href="#120co" title='co' data-ref="120co">co</a>=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1404">1404</th><td>    }</td></tr>
<tr><th id="1405">1405</th><td></td></tr>
<tr><th id="1406">1406</th><td>    <b>if</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::timecondition" title='UserDefined::timecondition' data-ref="UserDefined::timecondition">timecondition</a>) {</td></tr>
<tr><th id="1407">1407</th><td>      <b>struct</b> <a class="type" href="../../../include/time.h.html#tm" title='tm' data-ref="tm">tm</a> *<dfn class="local col9 decl" id="139thistime" title='thistime' data-type='struct tm *' data-ref="139thistime">thistime</dfn>;</td></tr>
<tr><th id="1408">1408</th><td></td></tr>
<tr><th id="1409">1409</th><td>      <i>/* Phil Karn (Fri, 13 Apr 2001) pointed out that the If-Modified-Since</i></td></tr>
<tr><th id="1410">1410</th><td><i>       * header family should have their times set in GMT as RFC2616 defines:</i></td></tr>
<tr><th id="1411">1411</th><td><i>       * "All HTTP date/time stamps MUST be represented in Greenwich Mean Time</i></td></tr>
<tr><th id="1412">1412</th><td><i>       * (GMT), without exception. For the purposes of HTTP, GMT is exactly</i></td></tr>
<tr><th id="1413">1413</th><td><i>       * equal to UTC (Coordinated Universal Time)." (see page 20 of RFC2616).</i></td></tr>
<tr><th id="1414">1414</th><td><i>       */</i></td></tr>
<tr><th id="1415">1415</th><td></td></tr>
<tr><th id="1416">1416</th><td><u>#<span data-ppcond="1416">ifdef</span> <a class="macro" href="config.h.html#119" data-ref="_M/HAVE_GMTIME_R">HAVE_GMTIME_R</a></u></td></tr>
<tr><th id="1417">1417</th><td>      <i>/* thread-safe version */</i></td></tr>
<tr><th id="1418">1418</th><td>      <b>struct</b> <a class="type" href="../../../include/time.h.html#tm" title='tm' data-ref="tm">tm</a> <dfn class="local col0 decl" id="140keeptime" title='keeptime' data-type='struct tm' data-ref="140keeptime">keeptime</dfn>;</td></tr>
<tr><th id="1419">1419</th><td>      <a class="local col9 ref" href="#139thistime" title='thistime' data-ref="139thistime">thistime</a> = (<b>struct</b> <a class="type" href="../../../include/time.h.html#tm" title='tm' data-ref="tm">tm</a> *)<a class="ref" href="../../../include/time.h.html#gmtime_r" title='gmtime_r' data-ref="gmtime_r">gmtime_r</a>(&amp;<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::timevalue" title='UserDefined::timevalue' data-ref="UserDefined::timevalue">timevalue</a>, &amp;<a class="local col0 ref" href="#140keeptime" title='keeptime' data-ref="140keeptime">keeptime</a>);</td></tr>
<tr><th id="1420">1420</th><td><u>#<span data-ppcond="1416">else</span></u></td></tr>
<tr><th id="1421">1421</th><td>      thistime = gmtime(&amp;data-&gt;set.timevalue);</td></tr>
<tr><th id="1422">1422</th><td><u>#<span data-ppcond="1416">endif</span></u></td></tr>
<tr><th id="1423">1423</th><td></td></tr>
<tr><th id="1424">1424</th><td><u>#<span data-ppcond="1424">ifdef</span> <a class="macro" href="config.h.html#308" data-ref="_M/HAVE_STRFTIME">HAVE_STRFTIME</a></u></td></tr>
<tr><th id="1425">1425</th><td>      <i>/* format: "Tue, 15 Nov 1994 12:45:26 GMT" */</i></td></tr>
<tr><th id="1426">1426</th><td>      <a class="ref" href="../../../include/time.h.html#strftime" title='strftime' data-ref="strftime">strftime</a>(<a class="local col7 ref" href="#117buf" title='buf' data-ref="117buf">buf</a>, <a class="macro" href="urldata.h.html#104" title="16384" data-ref="_M/BUFSIZE">BUFSIZE</a>-<var>1</var>, <q>"%a, %d %b %Y %H:%M:%S GMT"</q>, <a class="local col9 ref" href="#139thistime" title='thistime' data-ref="139thistime">thistime</a>);</td></tr>
<tr><th id="1427">1427</th><td><u>#<span data-ppcond="1424">else</span></u></td></tr>
<tr><th id="1428">1428</th><td>      <i>/* TODO: Right, we *could* write a replacement here */</i></td></tr>
<tr><th id="1429">1429</th><td>      strcpy(buf, <q>"no strftime() support"</q>);</td></tr>
<tr><th id="1430">1430</th><td><u>#<span data-ppcond="1424">endif</span></u></td></tr>
<tr><th id="1431">1431</th><td>      <b>switch</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::timecondition" title='UserDefined::timecondition' data-ref="UserDefined::timecondition">timecondition</a>) {</td></tr>
<tr><th id="1432">1432</th><td>      <b>case</b> <a class="enum" href="../include/curl/curl.h.html#CURL_TIMECOND_IFMODSINCE" title='CURL_TIMECOND_IFMODSINCE' data-ref="CURL_TIMECOND_IFMODSINCE">CURL_TIMECOND_IFMODSINCE</a>:</td></tr>
<tr><th id="1433">1433</th><td>      <b>default</b>:</td></tr>
<tr><th id="1434">1434</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1435">1435</th><td>                    <q>"If-Modified-Since: %s\r\n"</q>, <a class="local col7 ref" href="#117buf" title='buf' data-ref="117buf">buf</a>);</td></tr>
<tr><th id="1436">1436</th><td>        <b>break</b>;</td></tr>
<tr><th id="1437">1437</th><td>      <b>case</b> <a class="enum" href="../include/curl/curl.h.html#CURL_TIMECOND_IFUNMODSINCE" title='CURL_TIMECOND_IFUNMODSINCE' data-ref="CURL_TIMECOND_IFUNMODSINCE">CURL_TIMECOND_IFUNMODSINCE</a>:</td></tr>
<tr><th id="1438">1438</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1439">1439</th><td>                    <q>"If-Unmodified-Since: %s\r\n"</q>, <a class="local col7 ref" href="#117buf" title='buf' data-ref="117buf">buf</a>);</td></tr>
<tr><th id="1440">1440</th><td>        <b>break</b>;</td></tr>
<tr><th id="1441">1441</th><td>      <b>case</b> <a class="enum" href="../include/curl/curl.h.html#CURL_TIMECOND_LASTMOD" title='CURL_TIMECOND_LASTMOD' data-ref="CURL_TIMECOND_LASTMOD">CURL_TIMECOND_LASTMOD</a>:</td></tr>
<tr><th id="1442">1442</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1443">1443</th><td>                    <q>"Last-Modified: %s\r\n"</q>, <a class="local col7 ref" href="#117buf" title='buf' data-ref="117buf">buf</a>);</td></tr>
<tr><th id="1444">1444</th><td>        <b>break</b>;</td></tr>
<tr><th id="1445">1445</th><td>      }</td></tr>
<tr><th id="1446">1446</th><td>    }</td></tr>
<tr><th id="1447">1447</th><td></td></tr>
<tr><th id="1448">1448</th><td>    <b>while</b>(<a class="local col5 ref" href="#135headers" title='headers' data-ref="135headers">headers</a>) {</td></tr>
<tr><th id="1449">1449</th><td>      <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> = <a class="ref" href="../../../include/string.h.html#strchr" title='strchr' data-ref="strchr">strchr</a>(<a class="local col5 ref" href="#135headers" title='headers' data-ref="135headers">headers</a>-&gt;<a class="ref" href="../include/curl/curl.h.html#curl_slist::data" title='curl_slist::data' data-ref="curl_slist::data">data</a>, <kbd>':'</kbd>);</td></tr>
<tr><th id="1450">1450</th><td>      <b>if</b>(<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>) {</td></tr>
<tr><th id="1451">1451</th><td>        <i>/* we require a colon for this to be a true header */</i></td></tr>
<tr><th id="1452">1452</th><td></td></tr>
<tr><th id="1453">1453</th><td>        <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>++; <i>/* pass the colon */</i></td></tr>
<tr><th id="1454">1454</th><td>        <b>while</b>(*<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a> &amp;&amp; <a class="macro" href="../../../include/ctype.h.html#205" title="((*__ctype_b_loc ())[(int) (((int)*ptr))] &amp; (unsigned short int) _ISspace)" data-ref="_M/isspace">isspace</a>((<em>int</em>)*<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>))</td></tr>
<tr><th id="1455">1455</th><td>          <a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>++;</td></tr>
<tr><th id="1456">1456</th><td></td></tr>
<tr><th id="1457">1457</th><td>        <b>if</b>(*<a class="local col4 ref" href="#124ptr" title='ptr' data-ref="124ptr">ptr</a>) {</td></tr>
<tr><th id="1458">1458</th><td>          <i>/* only send this if the contents was non-blank */</i></td></tr>
<tr><th id="1459">1459</th><td></td></tr>
<tr><th id="1460">1460</th><td>          <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"%s\r\n"</q>, <a class="local col5 ref" href="#135headers" title='headers' data-ref="135headers">headers</a>-&gt;<a class="ref" href="../include/curl/curl.h.html#curl_slist::data" title='curl_slist::data' data-ref="curl_slist::data">data</a>);</td></tr>
<tr><th id="1461">1461</th><td>        }</td></tr>
<tr><th id="1462">1462</th><td>      }</td></tr>
<tr><th id="1463">1463</th><td>      <a class="local col5 ref" href="#135headers" title='headers' data-ref="135headers">headers</a> = <a class="local col5 ref" href="#135headers" title='headers' data-ref="135headers">headers</a>-&gt;<a class="ref" href="../include/curl/curl.h.html#curl_slist::next" title='curl_slist::next' data-ref="curl_slist::next">next</a>;</td></tr>
<tr><th id="1464">1464</th><td>    }</td></tr>
<tr><th id="1465">1465</th><td></td></tr>
<tr><th id="1466">1466</th><td>    <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;  <i>/* nothing to post at this point */</i></td></tr>
<tr><th id="1467">1467</th><td>    <a class="ref" href="progress.h.html#Curl_pgrsSetUploadSize" title='Curl_pgrsSetUploadSize' data-ref="Curl_pgrsSetUploadSize">Curl_pgrsSetUploadSize</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <var>0</var>); <i>/* upload size is 0 atm */</i></td></tr>
<tr><th id="1468">1468</th><td></td></tr>
<tr><th id="1469">1469</th><td>    <i>/* If 'authdone' is still FALSE, we must not set the write socket index to</i></td></tr>
<tr><th id="1470">1470</th><td><i>       the Curl_transfer() call below, as we're not ready to actually upload</i></td></tr>
<tr><th id="1471">1471</th><td><i>       any data yet. */</i></td></tr>
<tr><th id="1472">1472</th><td></td></tr>
<tr><th id="1473">1473</th><td>    <b>switch</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::httpreq" title='UserDefined::httpreq' data-ref="UserDefined::httpreq">httpreq</a>) {</td></tr>
<tr><th id="1474">1474</th><td></td></tr>
<tr><th id="1475">1475</th><td>    <b>case</b> <a class="enum" href="urldata.h.html#HTTPREQ_POST_FORM" title='HTTPREQ_POST_FORM' data-ref="HTTPREQ_POST_FORM">HTTPREQ_POST_FORM</a>:</td></tr>
<tr><th id="1476">1476</th><td>      <b>if</b>(<a class="ref" href="formdata.h.html#Curl_FormInit" title='Curl_FormInit' data-ref="Curl_FormInit">Curl_FormInit</a>(&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::form" title='HTTP::form' data-ref="HTTP::form">form</a>, <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sendit" title='HTTP::sendit' data-ref="HTTP::sendit">sendit</a>)) {</td></tr>
<tr><th id="1477">1477</th><td>        <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Internal HTTP POST error!"</q>);</td></tr>
<tr><th id="1478">1478</th><td>        <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_HTTP_POST_ERROR" title='CURLE_HTTP_POST_ERROR' data-ref="CURLE_HTTP_POST_ERROR">CURLE_HTTP_POST_ERROR</a>;</td></tr>
<tr><th id="1479">1479</th><td>      }</td></tr>
<tr><th id="1480">1480</th><td></td></tr>
<tr><th id="1481">1481</th><td>      <i>/* set the read function to read from the generated form data */</i></td></tr>
<tr><th id="1482">1482</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread" title='connectdata::fread' data-ref="connectdata::fread">fread</a> = (<a class="typedef" href="../include/curl/curl.h.html#curl_read_callback" title='curl_read_callback' data-type='size_t (*)(char *, size_t, size_t, void *)' data-ref="curl_read_callback">curl_read_callback</a>)<a class="ref" href="formdata.h.html#Curl_FormReader" title='Curl_FormReader' data-ref="Curl_FormReader">Curl_FormReader</a>;</td></tr>
<tr><th id="1483">1483</th><td>      <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread_in" title='connectdata::fread_in' data-ref="connectdata::fread_in">fread_in</a> = &amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::form" title='HTTP::form' data-ref="HTTP::form">form</a>;</td></tr>
<tr><th id="1484">1484</th><td></td></tr>
<tr><th id="1485">1485</th><td>      <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sending" title='HTTP::sending' data-ref="HTTP::sending">sending</a> = <a class="enum" href="urldata.h.html#HTTP::HTTPSEND_BODY" title='HTTP::HTTPSEND_BODY' data-ref="HTTP::HTTPSEND_BODY">HTTPSEND_BODY</a>;</td></tr>
<tr><th id="1486">1486</th><td></td></tr>
<tr><th id="1487">1487</th><td>      <b>if</b>(!<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a>)</td></tr>
<tr><th id="1488">1488</th><td>        <i>/* only add Content-Length if not uploading chunked */</i></td></tr>
<tr><th id="1489">1489</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1490">1490</th><td>                    <q>"Content-Length: %"</q> <a class="macro" href="setup.h.html#97" title="&quot;lld&quot;" data-ref="_M/FORMAT_OFF_T">FORMAT_OFF_T</a> <q>"\r\n"</q>, <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>);</td></tr>
<tr><th id="1491">1491</th><td></td></tr>
<tr><th id="1492">1492</th><td>      <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Expect:"</q>)) {</td></tr>
<tr><th id="1493">1493</th><td>        <i>/* if not disabled explicitly we add a Expect: 100-continue</i></td></tr>
<tr><th id="1494">1494</th><td><i>           to the headers which actually speeds up post operations (as</i></td></tr>
<tr><th id="1495">1495</th><td><i>           there is one packet coming back from the web server) */</i></td></tr>
<tr><th id="1496">1496</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1497">1497</th><td>                    <q>"Expect: 100-continue\r\n"</q>);</td></tr>
<tr><th id="1498">1498</th><td>        <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::expect100header" title='UserDefined::expect100header' data-ref="UserDefined::expect100header">expect100header</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="1499">1499</th><td>      }</td></tr>
<tr><th id="1500">1500</th><td></td></tr>
<tr><th id="1501">1501</th><td>      <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Content-Type:"</q>)) {</td></tr>
<tr><th id="1502">1502</th><td>        <i>/* Get Content-Type: line from Curl_FormReadOneLine, which happens</i></td></tr>
<tr><th id="1503">1503</th><td><i>           to always be the first line. We can know this for sure since</i></td></tr>
<tr><th id="1504">1504</th><td><i>           we always build the formpost linked list the same way!</i></td></tr>
<tr><th id="1505">1505</th><td><i></i></td></tr>
<tr><th id="1506">1506</th><td><i>           The Content-Type header line also contains the MIME boundary</i></td></tr>
<tr><th id="1507">1507</th><td><i>           string etc why disabling this header is likely to not make things</i></td></tr>
<tr><th id="1508">1508</th><td><i>           work, but we support it anyway.</i></td></tr>
<tr><th id="1509">1509</th><td><i>        */</i></td></tr>
<tr><th id="1510">1510</th><td>        <em>char</em> <dfn class="local col1 decl" id="141contentType" title='contentType' data-type='char [256]' data-ref="141contentType">contentType</dfn>[<var>256</var>];</td></tr>
<tr><th id="1511">1511</th><td>        <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col2 decl" id="142linelength" title='linelength' data-type='size_t' data-ref="142linelength">linelength</dfn>=<var>0</var>;</td></tr>
<tr><th id="1512">1512</th><td>        <a class="local col2 ref" href="#142linelength" title='linelength' data-ref="142linelength">linelength</a> = <a class="ref" href="formdata.h.html#Curl_FormReadOneLine" title='Curl_FormReadOneLine' data-ref="Curl_FormReadOneLine">Curl_FormReadOneLine</a>(<a class="local col1 ref" href="#141contentType" title='contentType' data-ref="141contentType">contentType</a>,</td></tr>
<tr><th id="1513">1513</th><td>                                          <b>sizeof</b>(<a class="local col1 ref" href="#141contentType" title='contentType' data-ref="141contentType">contentType</a>),</td></tr>
<tr><th id="1514">1514</th><td>                                          <var>1</var>,</td></tr>
<tr><th id="1515">1515</th><td>                                          (<a class="typedef" href="../../../include/stdio.h.html#FILE" title='FILE' data-type='struct _IO_FILE' data-ref="FILE">FILE</a> *)&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::form" title='HTTP::form' data-ref="HTTP::form">form</a>);</td></tr>
<tr><th id="1516">1516</th><td>        <b>if</b>(!<a class="local col2 ref" href="#142linelength" title='linelength' data-ref="142linelength">linelength</a>) {</td></tr>
<tr><th id="1517">1517</th><td>          <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Could not get Content-Type header line!"</q>);</td></tr>
<tr><th id="1518">1518</th><td>          <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_HTTP_POST_ERROR" title='CURLE_HTTP_POST_ERROR' data-ref="CURLE_HTTP_POST_ERROR">CURLE_HTTP_POST_ERROR</a>;</td></tr>
<tr><th id="1519">1519</th><td>        }</td></tr>
<tr><th id="1520">1520</th><td>        <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <a class="local col1 ref" href="#141contentType" title='contentType' data-ref="141contentType">contentType</a>, <a class="local col2 ref" href="#142linelength" title='linelength' data-ref="142linelength">linelength</a>);</td></tr>
<tr><th id="1521">1521</th><td>      }</td></tr>
<tr><th id="1522">1522</th><td></td></tr>
<tr><th id="1523">1523</th><td>      <i>/* make the request end in a true CRLF */</i></td></tr>
<tr><th id="1524">1524</th><td>      <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n"</q>, <var>2</var>);</td></tr>
<tr><th id="1525">1525</th><td></td></tr>
<tr><th id="1526">1526</th><td>      <i>/* set upload size to the progress meter */</i></td></tr>
<tr><th id="1527">1527</th><td>      <a class="ref" href="progress.h.html#Curl_pgrsSetUploadSize" title='Curl_pgrsSetUploadSize' data-ref="Curl_pgrsSetUploadSize">Curl_pgrsSetUploadSize</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>);</td></tr>
<tr><th id="1528">1528</th><td></td></tr>
<tr><th id="1529">1529</th><td>      <i>/* fire away the whole request to the server */</i></td></tr>
<tr><th id="1530">1530</th><td>      <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="tu ref" href="#add_buffer_send" title='add_buffer_send' data-use='c' data-ref="add_buffer_send">add_buffer_send</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>, </td></tr>
<tr><th id="1531">1531</th><td>                               &amp;<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::info" title='SessionHandle::info' data-ref="SessionHandle::info">info</a>.<a class="ref" href="urldata.h.html#PureInfo::request_size" title='PureInfo::request_size' data-ref="PureInfo::request_size">request_size</a>);</td></tr>
<tr><th id="1532">1532</th><td>      <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1533">1533</th><td>        <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Failed sending POST request"</q>);</td></tr>
<tr><th id="1534">1534</th><td>      <b>else</b></td></tr>
<tr><th id="1535">1535</th><td>        <i>/* setup variables for the upcoming transfer */</i></td></tr>
<tr><th id="1536">1536</th><td>        <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="ref" href="transfer.h.html#Curl_Transfer" title='Curl_Transfer' data-ref="Curl_Transfer">Curl_Transfer</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>, <a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>, -<var>1</var>, <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>,</td></tr>
<tr><th id="1537">1537</th><td>                               &amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::readbytecount" title='HTTP::readbytecount' data-ref="HTTP::readbytecount">readbytecount</a>,</td></tr>
<tr><th id="1538">1538</th><td>                               <a class="local col6 ref" href="#126authdone" title='authdone' data-ref="126authdone">authdone</a>?<a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>:-<var>1</var>,</td></tr>
<tr><th id="1539">1539</th><td>                               <a class="local col6 ref" href="#126authdone" title='authdone' data-ref="126authdone">authdone</a>?&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::writebytecount" title='HTTP::writebytecount' data-ref="HTTP::writebytecount">writebytecount</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1540">1540</th><td>      <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>) {</td></tr>
<tr><th id="1541">1541</th><td>        <a class="ref" href="formdata.h.html#Curl_formclean" title='Curl_formclean' data-ref="Curl_formclean">Curl_formclean</a>(<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sendit" title='HTTP::sendit' data-ref="HTTP::sendit">sendit</a>); <i>/* free that whole lot */</i></td></tr>
<tr><th id="1542">1542</th><td>        <b>return</b> <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>;</td></tr>
<tr><th id="1543">1543</th><td>      }</td></tr>
<tr><th id="1544">1544</th><td>      <b>break</b>;</td></tr>
<tr><th id="1545">1545</th><td></td></tr>
<tr><th id="1546">1546</th><td>    <b>case</b> <a class="enum" href="urldata.h.html#HTTPREQ_PUT" title='HTTPREQ_PUT' data-ref="HTTPREQ_PUT">HTTPREQ_PUT</a>: <i>/* Let's PUT the data to the server! */</i></td></tr>
<tr><th id="1547">1547</th><td></td></tr>
<tr><th id="1548">1548</th><td>      <b>if</b>((<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a>&gt;<var>0</var>) &amp;&amp; !<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a>)</td></tr>
<tr><th id="1549">1549</th><td>        <i>/* only add Content-Length if not uploading chunked */</i></td></tr>
<tr><th id="1550">1550</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1551">1551</th><td>                    <q>"Content-Length: %"</q> <a class="macro" href="setup.h.html#97" title="&quot;lld&quot;" data-ref="_M/FORMAT_OFF_T">FORMAT_OFF_T</a> <q>"\r\n"</q>, <i>/* size */</i></td></tr>
<tr><th id="1552">1552</th><td>                    <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a> );</td></tr>
<tr><th id="1553">1553</th><td></td></tr>
<tr><th id="1554">1554</th><td>      <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Expect:"</q>)) {</td></tr>
<tr><th id="1555">1555</th><td>        <i>/* if not disabled explicitly we add a Expect: 100-continue</i></td></tr>
<tr><th id="1556">1556</th><td><i>           to the headers which actually speeds up post operations (as</i></td></tr>
<tr><th id="1557">1557</th><td><i>           there is one packet coming back from the web server) */</i></td></tr>
<tr><th id="1558">1558</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1559">1559</th><td>                    <q>"Expect: 100-continue\r\n"</q>);</td></tr>
<tr><th id="1560">1560</th><td>        <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::expect100header" title='UserDefined::expect100header' data-ref="UserDefined::expect100header">expect100header</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="1561">1561</th><td>      }</td></tr>
<tr><th id="1562">1562</th><td></td></tr>
<tr><th id="1563">1563</th><td>      <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n"</q>, <var>2</var>); <i>/* end of headers */</i></td></tr>
<tr><th id="1564">1564</th><td></td></tr>
<tr><th id="1565">1565</th><td>      <i>/* set the upload size to the progress meter */</i></td></tr>
<tr><th id="1566">1566</th><td>      <a class="ref" href="progress.h.html#Curl_pgrsSetUploadSize" title='Curl_pgrsSetUploadSize' data-ref="Curl_pgrsSetUploadSize">Curl_pgrsSetUploadSize</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a>);</td></tr>
<tr><th id="1567">1567</th><td></td></tr>
<tr><th id="1568">1568</th><td>      <i>/* this sends the buffer and frees all the buffer resources */</i></td></tr>
<tr><th id="1569">1569</th><td>      <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="tu ref" href="#add_buffer_send" title='add_buffer_send' data-use='c' data-ref="add_buffer_send">add_buffer_send</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>,</td></tr>
<tr><th id="1570">1570</th><td>                               &amp;<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::info" title='SessionHandle::info' data-ref="SessionHandle::info">info</a>.<a class="ref" href="urldata.h.html#PureInfo::request_size" title='PureInfo::request_size' data-ref="PureInfo::request_size">request_size</a>);</td></tr>
<tr><th id="1571">1571</th><td>      <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1572">1572</th><td>        <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Failed sending POST request"</q>);</td></tr>
<tr><th id="1573">1573</th><td>      <b>else</b></td></tr>
<tr><th id="1574">1574</th><td>        <i>/* prepare for transfer */</i></td></tr>
<tr><th id="1575">1575</th><td>        <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="ref" href="transfer.h.html#Curl_Transfer" title='Curl_Transfer' data-ref="Curl_Transfer">Curl_Transfer</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>, <a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>, -<var>1</var>, <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>,</td></tr>
<tr><th id="1576">1576</th><td>                               &amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::readbytecount" title='HTTP::readbytecount' data-ref="HTTP::readbytecount">readbytecount</a>,</td></tr>
<tr><th id="1577">1577</th><td>                               <a class="local col6 ref" href="#126authdone" title='authdone' data-ref="126authdone">authdone</a>?<a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>:-<var>1</var>,</td></tr>
<tr><th id="1578">1578</th><td>                               <a class="local col6 ref" href="#126authdone" title='authdone' data-ref="126authdone">authdone</a>?&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::writebytecount" title='HTTP::writebytecount' data-ref="HTTP::writebytecount">writebytecount</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1579">1579</th><td>      <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1580">1580</th><td>        <b>return</b> <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>;</td></tr>
<tr><th id="1581">1581</th><td>      <b>break</b>;</td></tr>
<tr><th id="1582">1582</th><td></td></tr>
<tr><th id="1583">1583</th><td>    <b>case</b> <a class="enum" href="urldata.h.html#HTTPREQ_POST" title='HTTPREQ_POST' data-ref="HTTPREQ_POST">HTTPREQ_POST</a>:</td></tr>
<tr><th id="1584">1584</th><td>      <i>/* this is the simple POST, using x-www-form-urlencoded style */</i></td></tr>
<tr><th id="1585">1585</th><td></td></tr>
<tr><th id="1586">1586</th><td>      <i>/* store the size of the postfields */</i></td></tr>
<tr><th id="1587">1587</th><td>      <a class="local col6 ref" href="#136postsize" title='postsize' data-ref="136postsize">postsize</a> = <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfieldsize" title='UserDefined::postfieldsize' data-ref="UserDefined::postfieldsize">postfieldsize</a>?</td></tr>
<tr><th id="1588">1588</th><td>        <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfieldsize" title='UserDefined::postfieldsize' data-ref="UserDefined::postfieldsize">postfieldsize</a>:</td></tr>
<tr><th id="1589">1589</th><td>        (<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfields" title='UserDefined::postfields' data-ref="UserDefined::postfields">postfields</a>?(<a class="typedef" href="../include/curl/curl.h.html#curl_off_t" title='curl_off_t' data-type='off_t' data-ref="curl_off_t">curl_off_t</a>)<a class="ref" href="../../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfields" title='UserDefined::postfields' data-ref="UserDefined::postfields">postfields</a>):<var>0</var>);</td></tr>
<tr><th id="1590">1590</th><td>      </td></tr>
<tr><th id="1591">1591</th><td>      <b>if</b>(!<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a>) {</td></tr>
<tr><th id="1592">1592</th><td>        <i>/* We only set Content-Length and allow a custom Content-Length if</i></td></tr>
<tr><th id="1593">1593</th><td><i>           we don't upload data chunked, as RFC2616 forbids us to set both</i></td></tr>
<tr><th id="1594">1594</th><td><i>           kinds of headers (Transfer-Encoding: chunked and Content-Length) */</i></td></tr>
<tr><th id="1595">1595</th><td></td></tr>
<tr><th id="1596">1596</th><td>        <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Content-Length:"</q>))</td></tr>
<tr><th id="1597">1597</th><td>          <i>/* we allow replacing this header, although it isn't very wise to</i></td></tr>
<tr><th id="1598">1598</th><td><i>             actually set your own */</i></td></tr>
<tr><th id="1599">1599</th><td>          <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"Content-Length: %"</q> <a class="macro" href="setup.h.html#97" title="&quot;lld&quot;" data-ref="_M/FORMAT_OFF_T">FORMAT_OFF_T</a><q>"\r\n"</q>,</td></tr>
<tr><th id="1600">1600</th><td>                      <a class="local col6 ref" href="#136postsize" title='postsize' data-ref="136postsize">postsize</a>);</td></tr>
<tr><th id="1601">1601</th><td>      }</td></tr>
<tr><th id="1602">1602</th><td></td></tr>
<tr><th id="1603">1603</th><td>      <b>if</b>(!<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Content-Type:"</q>))</td></tr>
<tr><th id="1604">1604</th><td>        <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1605">1605</th><td>                    <q>"Content-Type: application/x-www-form-urlencoded\r\n"</q>);</td></tr>
<tr><th id="1606">1606</th><td></td></tr>
<tr><th id="1607">1607</th><td>      <b>if</b>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfields" title='UserDefined::postfields' data-ref="UserDefined::postfields">postfields</a>) {</td></tr>
<tr><th id="1608">1608</th><td></td></tr>
<tr><th id="1609">1609</th><td>        <b>if</b>(<a class="local col6 ref" href="#126authdone" title='authdone' data-ref="126authdone">authdone</a> &amp;&amp; (<a class="local col6 ref" href="#136postsize" title='postsize' data-ref="136postsize">postsize</a> &lt; (<var>100</var>*<var>1024</var>))) {</td></tr>
<tr><th id="1610">1610</th><td>          <i>/* If we're not done with the authentication phase, we don't expect</i></td></tr>
<tr><th id="1611">1611</th><td><i>             to actually send off any data yet. Hence, we delay the sending of</i></td></tr>
<tr><th id="1612">1612</th><td><i>             the body until we receive that friendly 100-continue response */</i></td></tr>
<tr><th id="1613">1613</th><td>             </td></tr>
<tr><th id="1614">1614</th><td>          <i>/* The post data is less than 100K, then append it to the header.</i></td></tr>
<tr><th id="1615">1615</th><td><i>             This limit is no magic limit but only set to prevent really huge</i></td></tr>
<tr><th id="1616">1616</th><td><i>             POSTs to get the data duplicated with malloc() and family. */</i></td></tr>
<tr><th id="1617">1617</th><td></td></tr>
<tr><th id="1618">1618</th><td>          <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n"</q>, <var>2</var>); <i>/* end of headers! */</i></td></tr>
<tr><th id="1619">1619</th><td></td></tr>
<tr><th id="1620">1620</th><td>          <b>if</b>(!<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::bits" title='connectdata::bits' data-ref="connectdata::bits">bits</a>.<a class="ref" href="urldata.h.html#ConnectBits::upload_chunky" title='ConnectBits::upload_chunky' data-ref="ConnectBits::upload_chunky">upload_chunky</a>)</td></tr>
<tr><th id="1621">1621</th><td>            <i>/* We're not sending it 'chunked', append it to the request</i></td></tr>
<tr><th id="1622">1622</th><td><i>               already now to reduce the number if send() calls */</i></td></tr>
<tr><th id="1623">1623</th><td>            <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfields" title='UserDefined::postfields' data-ref="UserDefined::postfields">postfields</a>, (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span>)<a class="local col6 ref" href="#136postsize" title='postsize' data-ref="136postsize">postsize</a>);</td></tr>
<tr><th id="1624">1624</th><td>          <b>else</b> {</td></tr>
<tr><th id="1625">1625</th><td>            <i>/* Append the POST data chunky-style */</i></td></tr>
<tr><th id="1626">1626</th><td>            <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"%x\r\n"</q>, (<em>int</em>)<a class="local col6 ref" href="#136postsize" title='postsize' data-ref="136postsize">postsize</a>);</td></tr>
<tr><th id="1627">1627</th><td>            <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfields" title='UserDefined::postfields' data-ref="UserDefined::postfields">postfields</a>, (<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span>)<a class="local col6 ref" href="#136postsize" title='postsize' data-ref="136postsize">postsize</a>);</td></tr>
<tr><th id="1628">1628</th><td>            <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n0\r\n\r\n"</q>, <var>7</var>); <i>/* end of a chunked</i></td></tr>
<tr><th id="1629">1629</th><td><i>                                                           transfer stream */</i></td></tr>
<tr><th id="1630">1630</th><td>          }</td></tr>
<tr><th id="1631">1631</th><td>        }</td></tr>
<tr><th id="1632">1632</th><td>        <b>else</b> {</td></tr>
<tr><th id="1633">1633</th><td>          <i>/* A huge POST coming up, do data separate from the request */</i></td></tr>
<tr><th id="1634">1634</th><td>          <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a> = <a class="local col6 ref" href="#136postsize" title='postsize' data-ref="136postsize">postsize</a>;</td></tr>
<tr><th id="1635">1635</th><td>          <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a> = <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::postfields" title='UserDefined::postfields' data-ref="UserDefined::postfields">postfields</a>;</td></tr>
<tr><th id="1636">1636</th><td></td></tr>
<tr><th id="1637">1637</th><td>          <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::sending" title='HTTP::sending' data-ref="HTTP::sending">sending</a> = <a class="enum" href="urldata.h.html#HTTP::HTTPSEND_BODY" title='HTTP::HTTPSEND_BODY' data-ref="HTTP::HTTPSEND_BODY">HTTPSEND_BODY</a>;</td></tr>
<tr><th id="1638">1638</th><td></td></tr>
<tr><th id="1639">1639</th><td>          <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread" title='connectdata::fread' data-ref="connectdata::fread">fread</a> = (<a class="typedef" href="../include/curl/curl.h.html#curl_read_callback" title='curl_read_callback' data-type='size_t (*)(char *, size_t, size_t, void *)' data-ref="curl_read_callback">curl_read_callback</a>)<a class="tu ref" href="#readmoredata" title='readmoredata' data-use='r' data-ref="readmoredata">readmoredata</a>;</td></tr>
<tr><th id="1640">1640</th><td>          <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>-&gt;<a class="ref" href="urldata.h.html#connectdata::fread_in" title='connectdata::fread_in' data-ref="connectdata::fread_in">fread_in</a> = (<em>void</em> *)<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>;</td></tr>
<tr><th id="1641">1641</th><td></td></tr>
<tr><th id="1642">1642</th><td>          <i>/* set the upload size to the progress meter */</i></td></tr>
<tr><th id="1643">1643</th><td>          <a class="ref" href="progress.h.html#Curl_pgrsSetUploadSize" title='Curl_pgrsSetUploadSize' data-ref="Curl_pgrsSetUploadSize">Curl_pgrsSetUploadSize</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postsize" title='HTTP::postsize' data-ref="HTTP::postsize">postsize</a>);</td></tr>
<tr><th id="1644">1644</th><td></td></tr>
<tr><th id="1645">1645</th><td>          <b>if</b>(!<a class="local col6 ref" href="#126authdone" title='authdone' data-ref="126authdone">authdone</a> &amp;&amp; !<a class="tu ref" href="#checkheaders" title='checkheaders' data-use='c' data-ref="checkheaders">checkheaders</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Expect:"</q>)) {</td></tr>
<tr><th id="1646">1646</th><td>            <i>/* if not disabled explicitly we add a Expect: 100-continue to the</i></td></tr>
<tr><th id="1647">1647</th><td><i>               headers which actually speeds up post operations (as there is</i></td></tr>
<tr><th id="1648">1648</th><td><i>               one packet coming back from the web server) */</i></td></tr>
<tr><th id="1649">1649</th><td>            <a class="tu ref" href="#add_bufferf" title='add_bufferf' data-use='c' data-ref="add_bufferf">add_bufferf</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>,</td></tr>
<tr><th id="1650">1650</th><td>                        <q>"Expect: 100-continue\r\n"</q>);</td></tr>
<tr><th id="1651">1651</th><td>            <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::expect100header" title='UserDefined::expect100header' data-ref="UserDefined::expect100header">expect100header</a> = <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>;</td></tr>
<tr><th id="1652">1652</th><td>          }</td></tr>
<tr><th id="1653">1653</th><td></td></tr>
<tr><th id="1654">1654</th><td>          <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n"</q>, <var>2</var>); <i>/* end of headers! */</i></td></tr>
<tr><th id="1655">1655</th><td>        }</td></tr>
<tr><th id="1656">1656</th><td>      }</td></tr>
<tr><th id="1657">1657</th><td>      <b>else</b> {</td></tr>
<tr><th id="1658">1658</th><td>        <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n"</q>, <var>2</var>); <i>/* end of headers! */</i></td></tr>
<tr><th id="1659">1659</th><td></td></tr>
<tr><th id="1660">1660</th><td>        <i>/* set the upload size to the progress meter */</i></td></tr>
<tr><th id="1661">1661</th><td>        <a class="ref" href="progress.h.html#Curl_pgrsSetUploadSize" title='Curl_pgrsSetUploadSize' data-ref="Curl_pgrsSetUploadSize">Curl_pgrsSetUploadSize</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::set" title='SessionHandle::set' data-ref="SessionHandle::set">set</a>.<a class="ref" href="urldata.h.html#UserDefined::infilesize" title='UserDefined::infilesize' data-ref="UserDefined::infilesize">infilesize</a>);</td></tr>
<tr><th id="1662">1662</th><td></td></tr>
<tr><th id="1663">1663</th><td>        <i>/* set the pointer to mark that we will send the post body using</i></td></tr>
<tr><th id="1664">1664</th><td><i>           the read callback */</i></td></tr>
<tr><th id="1665">1665</th><td>        <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a> = (<em>char</em> *)&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>;</td></tr>
<tr><th id="1666">1666</th><td>      }</td></tr>
<tr><th id="1667">1667</th><td>      <i>/* issue the request */</i></td></tr>
<tr><th id="1668">1668</th><td>      <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="tu ref" href="#add_buffer_send" title='add_buffer_send' data-use='c' data-ref="add_buffer_send">add_buffer_send</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>,</td></tr>
<tr><th id="1669">1669</th><td>                               &amp;<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::info" title='SessionHandle::info' data-ref="SessionHandle::info">info</a>.<a class="ref" href="urldata.h.html#PureInfo::request_size" title='PureInfo::request_size' data-ref="PureInfo::request_size">request_size</a>);</td></tr>
<tr><th id="1670">1670</th><td></td></tr>
<tr><th id="1671">1671</th><td>      <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1672">1672</th><td>        <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Failed sending HTTP POST request"</q>);</td></tr>
<tr><th id="1673">1673</th><td>      <b>else</b></td></tr>
<tr><th id="1674">1674</th><td>        <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> =</td></tr>
<tr><th id="1675">1675</th><td>          <a class="ref" href="transfer.h.html#Curl_Transfer" title='Curl_Transfer' data-ref="Curl_Transfer">Curl_Transfer</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>, <a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>, -<var>1</var>, <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>,</td></tr>
<tr><th id="1676">1676</th><td>                        &amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::readbytecount" title='HTTP::readbytecount' data-ref="HTTP::readbytecount">readbytecount</a>,</td></tr>
<tr><th id="1677">1677</th><td>                        <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>?<a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>:-<var>1</var>,</td></tr>
<tr><th id="1678">1678</th><td>                        <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>?&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::writebytecount" title='HTTP::writebytecount' data-ref="HTTP::writebytecount">writebytecount</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1679">1679</th><td>      <b>break</b>;</td></tr>
<tr><th id="1680">1680</th><td></td></tr>
<tr><th id="1681">1681</th><td>    <b>default</b>:</td></tr>
<tr><th id="1682">1682</th><td>      <a class="tu ref" href="#add_buffer" title='add_buffer' data-use='c' data-ref="add_buffer">add_buffer</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <q>"\r\n"</q>, <var>2</var>);</td></tr>
<tr><th id="1683">1683</th><td>      </td></tr>
<tr><th id="1684">1684</th><td>      <i>/* issue the request */</i></td></tr>
<tr><th id="1685">1685</th><td>      <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="tu ref" href="#add_buffer_send" title='add_buffer_send' data-use='c' data-ref="add_buffer_send">add_buffer_send</a>(<a class="local col4 ref" href="#134req_buffer" title='req_buffer' data-ref="134req_buffer">req_buffer</a>, <a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>,</td></tr>
<tr><th id="1686">1686</th><td>                               &amp;<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>-&gt;<a class="ref" href="urldata.h.html#SessionHandle::info" title='SessionHandle::info' data-ref="SessionHandle::info">info</a>.<a class="ref" href="urldata.h.html#PureInfo::request_size" title='PureInfo::request_size' data-ref="PureInfo::request_size">request_size</a>);</td></tr>
<tr><th id="1687">1687</th><td></td></tr>
<tr><th id="1688">1688</th><td>      <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1689">1689</th><td>        <a class="macro" href="sendf.h.html#32" title="Curl_failf" data-ref="_M/failf">failf</a>(<a class="local col6 ref" href="#116data" title='data' data-ref="116data">data</a>, <q>"Failed sending HTTP request"</q>);</td></tr>
<tr><th id="1690">1690</th><td>      <b>else</b></td></tr>
<tr><th id="1691">1691</th><td>        <i>/* HTTP GET/HEAD download: */</i></td></tr>
<tr><th id="1692">1692</th><td>        <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a> = <a class="ref" href="transfer.h.html#Curl_Transfer" title='Curl_Transfer' data-ref="Curl_Transfer">Curl_Transfer</a>(<a class="local col5 ref" href="#115conn" title='conn' data-ref="115conn">conn</a>, <a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>, -<var>1</var>, <a class="macro" href="setup.h.html#67" title="1" data-ref="_M/TRUE">TRUE</a>,</td></tr>
<tr><th id="1693">1693</th><td>                               &amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::readbytecount" title='HTTP::readbytecount' data-ref="HTTP::readbytecount">readbytecount</a>,</td></tr>
<tr><th id="1694">1694</th><td>                               <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>?<a class="macro" href="urldata.h.html#394" title="0" data-ref="_M/FIRSTSOCKET">FIRSTSOCKET</a>:-<var>1</var>,</td></tr>
<tr><th id="1695">1695</th><td>                               <a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::postdata" title='HTTP::postdata' data-ref="HTTP::postdata">postdata</a>?&amp;<a class="local col9 ref" href="#119http" title='http' data-ref="119http">http</a>-&gt;<a class="ref" href="urldata.h.html#HTTP::writebytecount" title='HTTP::writebytecount' data-ref="HTTP::writebytecount">writebytecount</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1696">1696</th><td>    }</td></tr>
<tr><th id="1697">1697</th><td>    <b>if</b>(<a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>)</td></tr>
<tr><th id="1698">1698</th><td>      <b>return</b> <a class="local col8 ref" href="#118result" title='result' data-ref="118result">result</a>;</td></tr>
<tr><th id="1699">1699</th><td>  }</td></tr>
<tr><th id="1700">1700</th><td></td></tr>
<tr><th id="1701">1701</th><td>  <b>return</b> <a class="enum" href="../include/curl/curl.h.html#CURLE_OK" title='CURLE_OK' data-ref="CURLE_OK">CURLE_OK</a>;</td></tr>
<tr><th id="1702">1702</th><td>}</td></tr>
<tr><th id="1703">1703</th><td><u>#<span data-ppcond="26">endif</span></u></td></tr>
<tr><th id="1704">1704</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2017-Aug-29</em> from project codebrowser revision <em>a9c49da</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
